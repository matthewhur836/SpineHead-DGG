(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[   1303779,      30074]
NotebookOptionsPosition[   1280597,      29727]
NotebookOutlinePosition[   1280988,      29743]
CellTagsIndexPosition[   1280945,      29740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Actin Modeling", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.963664841562861*^9, 
  3.9636648431332817`*^9}},ExpressionUUID->"df9d2e5b-91cf-4c95-8f23-\
006826a48b82"],

Cell["\<\
Authors: Matthew Hur and Eric Mjolsness, 2025 July 27
This is a dynamical graph grammar (DGG) model of the morphodynamics of the \
synaptic spine head built for actin network remodeling and biomechanics.\
\>", "Text",ExpressionUUID->"faff42c4-6b76-4cf3-b03a-047b8dc88021"],

Cell[CellGroupData[{

Cell["Loading Plenum", "Section",
 CellChangeTimes->{{3.9720956981598883`*^9, 
  3.9720956997692127`*^9}},ExpressionUUID->"827094a6-9a51-4e2b-8d54-\
19d578713f4b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "Plenum.m"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"2ece16d7-f557-4c7a-8dfc-88a259604591"],

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 CellChangeTimes->{
  3.970164549628603*^9, 3.9701680446761723`*^9, 3.970231162209034*^9, 
   3.9702313094074183`*^9, 3.970232475757902*^9, 3.9702330266058187`*^9, {
   3.970233170014955*^9, 3.970233179002544*^9}, 3.970233234778842*^9, 
   3.970233320439494*^9, 3.970233584372509*^9, 3.970234039701988*^9, 
   3.9702341265921793`*^9, 3.9702343484018507`*^9, 3.97023457780593*^9, 
   3.970236075833372*^9, 3.970236163773368*^9, {3.9702362755277147`*^9, 
   3.970236281392993*^9}, 3.970236394921496*^9, 3.970236530896798*^9, 
   3.970236917213118*^9, 3.97023718267072*^9, 3.9702374552181473`*^9, 
   3.970237856119925*^9, 3.9702385490926743`*^9, 3.970248750736424*^9, 
   3.9703111827901573`*^9, 3.970313064258687*^9, 3.970330030540954*^9, 
   3.970331162751813*^9, 3.970411738582139*^9, 3.970411811080982*^9, 
   3.970411845038896*^9, 3.970761302240973*^9, 3.970845668164734*^9, 
   3.971705493231319*^9, 3.972056238387412*^9, 3.972087523851488*^9, 
   3.9720875799223757`*^9, 3.972087884248259*^9, 3.9720881775353823`*^9, 
   3.9720882497146463`*^9, {3.9720884558627243`*^9, 3.972088462547188*^9}, 
   3.9720892889269333`*^9, {3.97208938209814*^9, 3.972089413041656*^9}, 
   3.972089446314443*^9, 3.9720898337236767`*^9, 3.972089944106255*^9, 
   3.972090263536189*^9, 3.97209062101025*^9, 3.972091018583317*^9, 
   3.972091559503498*^9, 3.9720919145751457`*^9, 3.9720927354515133`*^9, {
   3.972092773315805*^9, 3.972092796505026*^9}, {3.9720928315443172`*^9, 
   3.972092847176972*^9}, 3.972092900489921*^9, 3.972093480880836*^9, 
   3.9720939473891172`*^9, 3.972095261869195*^9, 3.972095769555964*^9, 
   3.97209734978415*^9, 3.972097404137586*^9, 3.972105766788271*^9, 
   3.97210645605029*^9, 3.9722600086342497`*^9, 3.9722916333682737`*^9, 
   3.9722919068946133`*^9, 3.972292200714418*^9, 3.972292612661723*^9, 
   3.972292661631337*^9, 3.972292901029024*^9, 3.972293245082*^9, 
   3.972293985467524*^9, 3.972295061534588*^9, 3.972296750840254*^9, 
   3.9722977110900803`*^9, 3.972340500141407*^9, 3.972370430357856*^9, 
   3.972371063135042*^9, 3.9723714506392517`*^9, 3.972371689661995*^9, 
   3.972372592792342*^9, 3.972375720828874*^9, {3.972375785113842*^9, 
   3.972375804991282*^9}, 3.972375852973816*^9, {3.972375890869972*^9, 
   3.972375959207799*^9}, 3.972376041129081*^9, 3.972378432813085*^9, 
   3.972378854802478*^9, 3.97238006730361*^9, 3.972380447040123*^9, 
   3.9723813707904654`*^9, 3.972381509486897*^9, 3.972383160823997*^9, 
   3.9724011893657503`*^9, 3.972503167817582*^9, 3.972503577875543*^9, 
   3.97250412059518*^9, 3.972504183721816*^9, 3.9725045897457438`*^9, 
   3.97250467694138*^9, 3.972505867405517*^9, 3.972506108977626*^9, 
   3.9725067931500883`*^9, 3.9725083022554693`*^9, 3.972508768395069*^9, 
   3.972509199330634*^9, 3.972509772516898*^9, 3.9725098594816303`*^9, 
   3.9725099336538467`*^9, {3.972510022699576*^9, 3.9725100432404203`*^9}, 
   3.972510302645527*^9, 3.9725108611450987`*^9, 3.9725110308829536`*^9, 
   3.9725113694920473`*^9, 3.972511628919629*^9, 3.972512015939782*^9, 
   3.972513180573246*^9, 3.972513863351528*^9, 3.972517557301791*^9, 
   3.972519338364387*^9, 3.972519381364676*^9, 3.972519633551112*^9, 
   3.9725199337137623`*^9, 3.9725208779068823`*^9, 3.972521282858321*^9, {
   3.972521610523321*^9, 3.972521618039281*^9}, 3.9725217324297953`*^9, 
   3.97252313291145*^9, 3.972526454732991*^9, 3.972542914758397*^9, 
   3.972543383815691*^9, 3.972560009136368*^9, 3.9726566816031303`*^9, 
   3.972657035797595*^9, 3.972657142070457*^9, 3.972657211068178*^9, 
   3.972657464616033*^9, 3.9726575529356833`*^9, 3.972658219342413*^9, 
   3.97265915134534*^9, {3.972659526228011*^9, 3.972659538071073*^9}, 
   3.972662091640628*^9, 3.9726652519620237`*^9, 3.972665464937443*^9, 
   3.972666723953376*^9, 3.972675530216702*^9, 3.972753980587151*^9, 
   3.9727545319282084`*^9, 3.972755773056135*^9, 3.972756048320435*^9, 
   3.972756897259527*^9, 3.972757597176744*^9, 3.972758527723302*^9, 
   3.972759101195269*^9, 3.9727592666945887`*^9, 3.972760214124021*^9, 
   3.972760534474086*^9, 3.972760663446171*^9, 3.9727608746645308`*^9, 
   3.97276119802617*^9, 3.972761817143737*^9, 3.972762646914393*^9, 
   3.972762809460505*^9, 3.972765305713129*^9, 3.9727755097486753`*^9, 
   3.972783310133671*^9, 3.972783413145933*^9, 3.9727835550848293`*^9, 
   3.97278371594417*^9, 3.972783955865199*^9, 3.972784247928772*^9, 
   3.972785315490407*^9, 3.972785820439848*^9, 3.972935401393096*^9, 
   3.9729354974526463`*^9, 3.972935903151743*^9, 3.972935943239833*^9, 
   3.9729359888325653`*^9, 3.972936107826604*^9, 3.972936309920394*^9, 
   3.972936432778925*^9, 3.9729365188504467`*^9, 3.972936797441909*^9, 
   3.97293700322204*^9, 3.972937222636921*^9, 3.9729375141044207`*^9, 
   3.9729376319118977`*^9, 3.97293841104224*^9, 3.972938789273582*^9, 
   3.972940619352889*^9, 3.972940711579871*^9, 3.97294091531548*^9, 
   3.9729411235719843`*^9, 3.972941495769046*^9, 3.972941548226685*^9, 
   3.9729423565830812`*^9, 3.972942447198124*^9, 3.9729426748959217`*^9, 
   3.972942830617152*^9, 3.9729429676456738`*^9, 3.972943097967449*^9, 
   3.972943503061953*^9, 3.972943617774076*^9, 3.972943870448041*^9, 
   3.972943985085503*^9, 3.97294407810574*^9, 3.9729443986869593`*^9, 
   3.972945038619668*^9, 3.972945095921412*^9, 3.9729452640831947`*^9, 
   3.9729453379744787`*^9, 3.9729463428786983`*^9, 3.9729464247289248`*^9, 
   3.9729466541079893`*^9, 3.9729467014452763`*^9, 3.9729469653499603`*^9, 
   3.972947146474506*^9, 3.9729472202259083`*^9, 3.972947302943789*^9, 
   3.972947522816655*^9, 3.972947686792315*^9, 3.972947797967874*^9, 
   3.972947968973926*^9, 3.9729480997139683`*^9, 3.972948276823379*^9, 
   3.972948384525144*^9, 3.972949353063142*^9, 3.9729496785309267`*^9, 
   3.972950435760167*^9, 3.972950486596592*^9, 3.972952497463707*^9, {
   3.9729527355468187`*^9, 3.972952762416301*^9}, 3.9729529184268713`*^9, 
   3.972953162253111*^9, 3.972953702376832*^9, 3.9729540732050953`*^9, 
   3.972954374589952*^9, 3.9729546611277733`*^9, {3.972954952699038*^9, 
   3.972954970685543*^9}, 3.9729551452557793`*^9, 3.9729556000474586`*^9, 
   3.972956070422639*^9, 3.972956290291078*^9, 3.972956541257937*^9, 
   3.972957524618877*^9, 3.972958563024135*^9, 3.972959030590087*^9, 
   3.9729796707845078`*^9, 3.9729801771812468`*^9, 3.9729808347797623`*^9, 
   3.972981228418721*^9, 3.972981386373662*^9, 3.972982434263783*^9, 
   3.972982680595873*^9, 3.972983538750655*^9, 3.972992224601775*^9, 
   3.9729923663781357`*^9, 3.9729924059894342`*^9, 3.9729924886827297`*^9, 
   3.9729925272248573`*^9, 3.972992777467195*^9, {3.972994976744485*^9, 
   3.9729950048931847`*^9}, 3.972996056605733*^9, 3.972996281627966*^9, 
   3.9729964890712547`*^9, 3.9729966701652946`*^9, 3.9729974719666367`*^9, 
   3.9729976399164543`*^9, 3.9729978413934107`*^9, 3.972998919167997*^9, 
   3.972999112915854*^9, 3.972999200462308*^9, 3.9729993777601852`*^9, {
   3.973000842322015*^9, 3.9730008606558723`*^9}, 3.973001942666211*^9, 
   3.9730054814051113`*^9, 3.973006054638527*^9, 3.9730062638612127`*^9, 
   3.973007013598695*^9, 3.973007375055245*^9, 3.973008360712195*^9, 
   3.973008461780397*^9, 3.973008652897077*^9, 3.9730087303057423`*^9, 
   3.973008879762781*^9, 3.97301077009713*^9, 3.973010848909361*^9, 
   3.973011194433648*^9, 3.9730114566067*^9, 3.973011572215678*^9, 
   3.973012142449417*^9, 3.9730123692169533`*^9, 3.973012600016542*^9, 
   3.973012855282649*^9, 3.97301308090648*^9, 3.973013253476791*^9, 
   3.9730134725197163`*^9, 3.973014693650632*^9, 3.9730147799637938`*^9, 
   3.973015459258235*^9, 3.9730156720941772`*^9, 3.9730158538761663`*^9, 
   3.973015990039543*^9, 3.973016108022088*^9, 3.973016214073516*^9, 
   3.973016389983844*^9, 3.973016607784719*^9, 3.973018329584454*^9, 
   3.973019090651256*^9, 3.973019260881781*^9, 3.973019360835511*^9, 
   3.973019544751389*^9, 3.973019631205388*^9, 3.973019781374833*^9, 
   3.973020803867244*^9, 3.973021250222471*^9, 3.9730223659605007`*^9, 
   3.973022514169607*^9, 3.9730237347679043`*^9, 3.9730252271826363`*^9, 
   3.9730406352474194`*^9, 3.9730407596096888`*^9, 3.973040877448986*^9, 
   3.973041139340685*^9, 3.973041175911049*^9, 3.973041329330997*^9, 
   3.973041466928138*^9, {3.9730415879585047`*^9, 3.9730416148893213`*^9}, 
   3.973041822711671*^9, 3.973041952940279*^9, 3.9730420881783*^9, 
   3.973042306775008*^9, 3.9730424410683203`*^9, 3.973042557293236*^9, 
   3.973042697331229*^9, 3.97304274338063*^9, 3.9730428299314137`*^9, 
   3.973042966038526*^9, 3.973043160667119*^9, 3.973055051050034*^9, 
   3.973055312558372*^9, 3.973055459152957*^9, 3.973055804140974*^9, 
   3.973055891638021*^9, 3.973056151020402*^9, 3.973056319867447*^9, 
   3.973056399238399*^9, 3.973056513386609*^9, 3.973056697244735*^9, 
   3.9730586475420628`*^9, 3.9730587557885017`*^9, 3.973058970115748*^9, 
   3.9730616546837187`*^9, 3.973077291931464*^9, 3.973078238025771*^9, 
   3.97307862004076*^9, 3.9730787765237494`*^9, 3.973078897927166*^9, 
   3.9730815054844427`*^9, 3.973081843511833*^9, {3.973100443803019*^9, 
   3.9731004792586308`*^9}, {3.973100530259582*^9, 3.9731005490726*^9}, 
   3.9731007371970453`*^9, 3.973100975719555*^9, 3.973101339268537*^9, {
   3.973102944775992*^9, 3.973102966704431*^9}, 3.973103401327465*^9, 
   3.9731049461070423`*^9, 3.973105483736807*^9, 3.973106182161223*^9, 
   3.97310641554786*^9, 3.9731067565764933`*^9, 3.97310698080921*^9, 
   3.973107557265964*^9, 3.9731080684928913`*^9, 3.973187621695259*^9, 
   3.973187860300124*^9, {3.973187936019288*^9, 3.973187964737125*^9}, 
   3.97318800120369*^9, 3.973188237282751*^9, 3.9731884401576233`*^9, 
   3.97318859802393*^9, {3.973189062548813*^9, 3.973189077179266*^9}, 
   3.97318939153957*^9, 3.9731895967537003`*^9, 3.973189769040738*^9, 
   3.973189954071191*^9, 3.9731900310535917`*^9, 3.973190165098061*^9, 
   3.973190486787608*^9, 3.973190862129991*^9, 3.9731913178821907`*^9, 
   3.9731916807872677`*^9, 3.973191792522843*^9, 3.973192466820483*^9, 
   3.973192958004182*^9, 3.973194463402296*^9, 3.9731946740142403`*^9, 
   3.973194708849081*^9, 3.973194971583831*^9, 3.9731972594241333`*^9, 
   3.97319786118361*^9, 3.973200359877578*^9, 3.973201601875208*^9, 
   3.973202271238244*^9, 3.973202986507448*^9, 3.973205358350574*^9, 
   3.973205516248294*^9, 3.973206094018177*^9, 3.9732071804921494`*^9, 
   3.9732084664112186`*^9, 3.973209736273528*^9, 3.973210085266347*^9, 
   3.973210474339903*^9, 3.9732140177619257`*^9, 3.9732206105455723`*^9, 
   3.973220726036213*^9, 3.973220892262711*^9, 3.973221161149108*^9, 
   3.973221805927957*^9, 3.973222332007676*^9, 3.973222562518886*^9, 
   3.9732228492437153`*^9, 3.973223070833625*^9, 3.97322337260301*^9, 
   3.973223868031354*^9, 3.973224148322175*^9, 3.973224324536291*^9, 
   3.973224542997225*^9, 3.9732249837828712`*^9, 3.973226819338387*^9, 
   3.973238424446712*^9, 3.9732386918329678`*^9, 3.973259720605328*^9, 
   3.973259888204488*^9, 3.973260087088462*^9, 3.9732602886261797`*^9, 
   3.973260562669284*^9, 3.973260723321097*^9, 3.9732611804790487`*^9, 
   3.973261563460438*^9, 3.973261891351014*^9, 3.9732620794886723`*^9, 
   3.973262629459425*^9, 3.973262868268429*^9, 3.9732634369890013`*^9, 
   3.973263635738908*^9, 3.973270380937339*^9, 3.9732706311706448`*^9, 
   3.9732708062873383`*^9, 3.973271210989072*^9, 3.9732713675492983`*^9, 
   3.973271828179564*^9, 3.973272365258668*^9, 3.973272680512232*^9, 
   3.973273057863265*^9, 3.9732736400226192`*^9, 3.973274568663773*^9, 
   3.973274850483212*^9, 3.97327771593606*^9, 3.9732783019387407`*^9, 
   3.973279706971027*^9, 3.973279765073554*^9, 3.973279908828302*^9, 
   3.973280077739708*^9, 3.973280542472919*^9, 3.9732808203880987`*^9, 
   3.9732816967830772`*^9, 3.973285590831821*^9, 3.973370887819395*^9, 
   3.9733710428727627`*^9, 3.97379929027328*^9, 3.9738795351236773`*^9, 
   3.9738796992796183`*^9, 3.973879896692676*^9, 3.973879967358457*^9, 
   3.973880588589304*^9, 3.973882609452599*^9, {3.9738826645082417`*^9, 
   3.9738826718030033`*^9}, 3.9738828052736387`*^9, {3.973882866123724*^9, 
   3.973882885022921*^9}, 3.973882975893291*^9, 3.973884479127944*^9, 
   3.97388464145895*^9, 3.9738847727573223`*^9, 3.9738848208987827`*^9, 
   3.9738848790815067`*^9, 3.9738851498021593`*^9, 3.973888139612588*^9, {
   3.973889560906365*^9, 3.9738895883547*^9}, 3.97388970777488*^9, 
   3.973890466630341*^9, 3.973892035434352*^9, 3.973897077241105*^9, 
   3.973897147277152*^9, 3.973897248754671*^9, 3.97389735390845*^9, 
   3.973898156227693*^9, 3.97394185882001*^9, 3.9739436428623753`*^9, {
   3.974697426216505*^9, 3.974697452144207*^9}, 3.974697521808481*^9, 
   3.9746976024076653`*^9, 3.974697712194764*^9, 3.974698040506236*^9, 
   3.974698111578277*^9, 3.974698383928782*^9, 3.974698483183032*^9, 
   3.974698528840394*^9, 3.974698615509755*^9, 3.974699080893661*^9, 
   3.9746996866187067`*^9, 3.974699969222883*^9, 3.9747014456055107`*^9, {
   3.97472180286625*^9, 3.974721812316573*^9}, 3.974722153720737*^9, 
   3.974727569709444*^9, 3.9747276227912207`*^9, 3.974727738497591*^9, 
   3.9747278917234907`*^9, 3.974728100613109*^9, 3.9747285228996058`*^9, 
   3.9747290221299667`*^9, 3.974730155532618*^9, 3.974738240333475*^9, 
   3.974747879998148*^9, 3.9747487310972633`*^9, 3.974748814106863*^9, 
   3.97474890873447*^9, 3.974749068931871*^9, 3.974749262345703*^9, 
   3.974749389925536*^9, 3.9747496823928223`*^9, 3.974750834127001*^9, 
   3.974751336824553*^9, 3.974751487803691*^9, 3.974752148506933*^9, 
   3.97475238505482*^9, 3.974752521131811*^9, 3.9747533280480947`*^9, 
   3.974783360201935*^9, 3.97478364755853*^9, 3.9747837658367777`*^9, 
   3.974783862751102*^9, 3.9747840989349127`*^9, 3.9747848963348007`*^9, 
   3.974785061542818*^9, 3.974785162240934*^9, 3.974785302003325*^9, 
   3.974785596373163*^9, 3.974788472813212*^9, 3.9747890239282618`*^9, 
   3.974790070890197*^9, 3.974808247224745*^9, 3.974821375018022*^9, 
   3.975300143071588*^9, 3.975516675018861*^9, 3.975517054644005*^9, 
   3.975517126062169*^9, 3.975517156740958*^9, 3.975786819441846*^9, 
   3.9765597459970903`*^9, 3.97684422444132*^9, 3.97684505491425*^9, 
   3.976845167536388*^9, 3.9768454593798018`*^9, 3.976846255087241*^9, 
   3.9769859061285753`*^9, 3.97698614248099*^9, 3.976986320039229*^9, {
   3.976986534026278*^9, 3.976986538706192*^9}, 3.9769868407353363`*^9, 
   3.976987032834427*^9, 3.977254631159049*^9, 3.9772547248703203`*^9, 
   3.977254806254705*^9, 3.977254928069956*^9, 3.977255029152478*^9, 
   3.977255087759054*^9, 3.977255290393477*^9, 3.977255572327992*^9, 
   3.977432670891675*^9, 3.977860641600745*^9, 3.978059650286675*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"bfeac787-c98c-4c1e-90e5-4654418ce647"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining The Problem", "Section",ExpressionUUID->"39f688c3-3980-4383-8dce-b5cafb78176a"],

Cell[CellGroupData[{

Cell["User Defined Variables", "Subsection",ExpressionUUID->"9ecf14fa-26ac-42e1-92e6-38a03808a542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nCG", "=", "12"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"membraneRate", "=", ".35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"biomechanicalRate", "=", ".35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"type", "=", "STUB"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "STUB", " ", "for", " ", "stubby", " ", "or", " ", "MUSH", " ", "for", " ",
     "mushroom"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963666255106505*^9, 3.963666262427415*^9}, {
   3.963667160682699*^9, 3.963667168453864*^9}, {3.963667229123198*^9, 
   3.963667242580052*^9}, {3.963667339466585*^9, 3.963667342281953*^9}, {
   3.963674557652297*^9, 3.9636745591202*^9}, {3.963675001919816*^9, 
   3.963675003610509*^9}, {3.9636764186953573`*^9, 3.963676422309699*^9}, {
   3.963679760473906*^9, 3.963679761110754*^9}, {3.963681303249215*^9, 
   3.9636813033298073`*^9}, {3.963683876181491*^9, 3.9636838823696833`*^9}, {
   3.963686755519059*^9, 3.963686756299461*^9}, {3.963687703697267*^9, 
   3.9636877050138893`*^9}, {3.9637063694244833`*^9, 3.963706370179014*^9}, {
   3.963733313105824*^9, 3.963733314022294*^9}, {3.9637456968254843`*^9, 
   3.963745698806686*^9}, {3.9637457325114107`*^9, 3.963745734208482*^9}, {
   3.963747132605632*^9, 3.963747134009637*^9}, {3.963747305391778*^9, 
   3.963747306745639*^9}, {3.9637542755477448`*^9, 3.963754277432053*^9}, {
   3.963787342687975*^9, 3.963787345287427*^9}, {3.96380842002946*^9, 
   3.963808434881813*^9}, {3.963808557254743*^9, 3.963808559561091*^9}, {
   3.963809704737042*^9, 3.9638097092805557`*^9}, {3.9638098636800547`*^9, 
   3.963809866979941*^9}, {3.963823839164173*^9, 3.963823840433639*^9}, {
   3.963858934203926*^9, 3.963858936235601*^9}, {3.964011840004155*^9, 
   3.964011842344987*^9}, {3.96401581160284*^9, 3.964015815428499*^9}, {
   3.9640158710299788`*^9, 3.964015876192542*^9}, {3.964018226808723*^9, 
   3.964018231708246*^9}, {3.964018567891317*^9, 3.964018576369792*^9}, {
   3.964019228189036*^9, 3.964019228394496*^9}, {3.964022768738236*^9, 
   3.964022800337213*^9}, {3.964023169427558*^9, 3.964023169517579*^9}, {
   3.964023555547311*^9, 3.9640235558552933`*^9}, {3.964024476439968*^9, 
   3.9640244800756702`*^9}, {3.964025133497466*^9, 3.964025136141767*^9}, {
   3.9640350726055717`*^9, 3.964035081472395*^9}, 3.964035720929976*^9, {
   3.964036316774096*^9, 3.964036318729541*^9}, {3.9640365171975*^9, 
   3.9640365218741617`*^9}, {3.964036676493017*^9, 3.964036679045282*^9}, 
   3.964042757802931*^9, {3.964042805379408*^9, 3.964042805841041*^9}, {
   3.964043335440823*^9, 3.964043335526332*^9}, {3.9641368204627438`*^9, 
   3.964136821983514*^9}, {3.964185177387978*^9, 3.964185182533276*^9}, {
   3.964187391859646*^9, 3.964187392329067*^9}, {3.96418757149824*^9, 
   3.964187571582633*^9}, {3.964218425457961*^9, 3.964218427192947*^9}, {
   3.964225916654134*^9, 3.964225936087878*^9}, {3.964237044412431*^9, 
   3.9642370449838467`*^9}, {3.964237437337612*^9, 3.964237437460024*^9}, {
   3.964238177992032*^9, 3.964238193569666*^9}, {3.964238348579711*^9, 
   3.9642383735878897`*^9}, {3.964238640825465*^9, 3.9642386413568277`*^9}, {
   3.964239379146307*^9, 3.964239396685038*^9}, {3.964240181885252*^9, 
   3.964240181946034*^9}, {3.9642403847714148`*^9, 3.964240385126285*^9}, {
   3.9642432817934732`*^9, 3.964243285967531*^9}, {3.964260763856866*^9, 
   3.964260763941675*^9}, {3.964266554065485*^9, 3.96426655618487*^9}, {
   3.9642692503134193`*^9, 3.964269251785994*^9}, {3.9642694536297207`*^9, 
   3.964269456447736*^9}, {3.964294702606814*^9, 3.9642947026548843`*^9}, {
   3.964310749798656*^9, 3.9643107548968163`*^9}, {3.964446499417007*^9, 
   3.9644465037076893`*^9}, {3.964446799034109*^9, 3.964446801053748*^9}, {
   3.964447873870344*^9, 3.9644478766802807`*^9}, {3.964449236729759*^9, 
   3.9644492475158243`*^9}, {3.9644492919657717`*^9, 3.964449292360767*^9}, {
   3.9644493675314827`*^9, 3.9644493691843567`*^9}, {3.964449490514244*^9, 
   3.96444949161798*^9}, {3.964449741307523*^9, 3.964449743519216*^9}, {
   3.9644505441006203`*^9, 3.964450544729113*^9}, {3.964450588068164*^9, 
   3.9644505887475758`*^9}, {3.96445240058246*^9, 3.9644524015295*^9}, {
   3.964456486633697*^9, 3.964456488386341*^9}, {3.964477076843218*^9, 
   3.9644770798965187`*^9}, {3.964477671232635*^9, 3.964477675690097*^9}, {
   3.964480279348477*^9, 3.96448027948133*^9}, {3.964480441805099*^9, 
   3.964480442267193*^9}, {3.96448055729766*^9, 3.964480558408224*^9}, {
   3.964481734793786*^9, 3.9644817349527073`*^9}, {3.964482332705949*^9, 
   3.964482334817659*^9}, {3.964497562212799*^9, 3.964497580064081*^9}, {
   3.9644981611026697`*^9, 3.964498169497815*^9}, {3.964498276529209*^9, 
   3.9644983005743837`*^9}, {3.964498359913082*^9, 3.96449836166608*^9}, {
   3.964500476495747*^9, 3.9645004779406633`*^9}, {3.964500624146405*^9, 
   3.964500629745755*^9}, {3.9645036259587*^9, 3.9645036321636477`*^9}, {
   3.964503835952032*^9, 3.964503836385477*^9}, {3.964514440860804*^9, 
   3.964514446724738*^9}, {3.964515518889257*^9, 3.964515520624483*^9}, {
   3.96453271108436*^9, 3.964532735569705*^9}, {3.964533272827497*^9, 
   3.964533276958026*^9}, {3.964652449537036*^9, 3.9646524507049837`*^9}, {
   3.964652637144459*^9, 3.964652639111187*^9}, {3.964697124863235*^9, 
   3.964697125723802*^9}, {3.96496309185854*^9, 3.9649630945996103`*^9}, {
   3.964977294526861*^9, 3.9649772952841578`*^9}, {3.964977394654841*^9, 
   3.964977397537505*^9}, {3.964992989102992*^9, 3.9649929915345497`*^9}, {
   3.965412397218144*^9, 3.9654123973830757`*^9}, {3.965413148385447*^9, 
   3.9654131487640247`*^9}, {3.9654133351585617`*^9, 
   3.9654133527736464`*^9}, {3.9654325963998003`*^9, 3.965432601567896*^9}, {
   3.965491180675359*^9, 3.96549118164848*^9}, {3.965492526805953*^9, 
   3.965492528417863*^9}, {3.965492818783044*^9, 3.965492832511835*^9}, {
   3.965577184227063*^9, 3.965577186581209*^9}, {3.965577429491454*^9, 
   3.965577429729134*^9}, {3.9658124324998407`*^9, 3.9658124326420307`*^9}, {
   3.965826138996674*^9, 3.965826141808669*^9}, {3.965910131804969*^9, 
   3.965910133968431*^9}, {3.966077673868821*^9, 3.9660776739816093`*^9}, {
   3.966077903576805*^9, 3.966077903786583*^9}, {3.9663183371150513`*^9, 
   3.9663183406935062`*^9}, {3.966334378569448*^9, 3.966334382586535*^9}, 
   3.9675787728056517`*^9, {3.967601492826353*^9, 3.967601494403597*^9}, {
   3.967874196950835*^9, 3.967874209144352*^9}, {3.967876065861*^9, 
   3.9678760702406263`*^9}, {3.9698062352066298`*^9, 
   3.9698062353828773`*^9}, {3.969806312191288*^9, 3.96980631422651*^9}, 
   3.96980635752498*^9, {3.969807045401185*^9, 3.9698070499150257`*^9}, {
   3.9698137324235153`*^9, 3.969813740420713*^9}, {3.969815080115231*^9, 
   3.9698150802124987`*^9}, {3.969820002987389*^9, 3.969820004607395*^9}, {
   3.969823126550173*^9, 3.9698231281330433`*^9}, {3.970147997929229*^9, 
   3.970147997990036*^9}, {3.970148264804635*^9, 3.9701482649059973`*^9}, {
   3.970148655119336*^9, 3.970148660581366*^9}, {3.9701491968357267`*^9, 
   3.9701492007377787`*^9}, {3.970150220556203*^9, 3.9701502228298397`*^9}, {
   3.9701508855359497`*^9, 3.970150887621163*^9}, {3.9701611888584337`*^9, 
   3.970161198158424*^9}, {3.9701615130590754`*^9, 3.970161515541589*^9}, {
   3.9701618463778267`*^9, 3.970161846463369*^9}, {3.970162597728568*^9, 
   3.9701625979864073`*^9}, {3.970163100952445*^9, 3.970163101875465*^9}, {
   3.970231093914051*^9, 3.970231094259119*^9}, {3.970231126919873*^9, 
   3.970231140776244*^9}, {3.9702312972418423`*^9, 3.970231297299899*^9}, {
   3.970231906580801*^9, 3.970231908232006*^9}, {3.970236252129026*^9, 
   3.970236255089909*^9}, {3.970236377671937*^9, 3.9702363879986973`*^9}, {
   3.970237157169862*^9, 3.970237172713499*^9}, {3.970237565402842*^9, 
   3.97023758422777*^9}, {3.970237839401051*^9, 3.970237851959546*^9}, {
   3.970238511953319*^9, 3.970238540491515*^9}, {3.9703552696568613`*^9, 
   3.970355270149509*^9}, {3.970358178691928*^9, 3.9703581792404222`*^9}, {
   3.972087488361269*^9, 3.972087495515943*^9}, {3.972088451463819*^9, 
   3.9720884581072807`*^9}, {3.972089373440189*^9, 3.972089408461377*^9}, {
   3.97208962655931*^9, 3.972089630095212*^9}, {3.9720898176068163`*^9, 
   3.972089820856187*^9}, {3.972089932263636*^9, 3.9720899326796083`*^9}, {
   3.972090254334709*^9, 3.972090257247314*^9}, {3.97209190420728*^9, 
   3.9720919063947277`*^9}, {3.972093470005054*^9, 3.972093475220145*^9}, {
   3.972291566404522*^9, 3.972291585504346*^9}, {3.972291897990242*^9, 
   3.972291899487907*^9}, {3.972292193225422*^9, 3.972292193435295*^9}, {
   3.972292687028852*^9, 3.9722926878259974`*^9}, {3.972370655059022*^9, 
   3.972370656794759*^9}, {3.972375695893759*^9, 3.97237569716184*^9}, {
   3.972375927825096*^9, 3.972375930281928*^9}, {3.972375999922493*^9, 
   3.972376001582213*^9}, {3.972380440338614*^9, 3.972380442016631*^9}, {
   3.9723815013809032`*^9, 3.9723815032237787`*^9}, 3.972382099667571*^9, {
   3.9725016277017603`*^9, 3.972501629374372*^9}, {3.972506081746127*^9, 
   3.972506083362226*^9}, {3.9725067866346483`*^9, 3.972506789430273*^9}, {
   3.972511009355948*^9, 3.9725110131081657`*^9}, {3.972519864501693*^9, 
   3.9725198670211353`*^9}, {3.972520866622817*^9, 3.972520871656266*^9}, {
   3.97252127401925*^9, 3.972521276696761*^9}, {3.972521585037512*^9, 
   3.972521585167097*^9}, {3.9725229235371313`*^9, 3.972522928391073*^9}, {
   3.972657000602605*^9, 3.972657000694104*^9}, {3.972657201978917*^9, 
   3.9726572054718637`*^9}, {3.972657453139021*^9, 3.97265745319895*^9}, {
   3.9726595096011333`*^9, 3.972659513488196*^9}, {3.972665412244008*^9, 
   3.972665413229465*^9}, {3.9727575736998777`*^9, 3.972757575236438*^9}, {
   3.972758517579007*^9, 3.972758522244087*^9}, {3.972783057394205*^9, 
   3.972783060343796*^9}, {3.972785073102438*^9, 3.972785078144388*^9}, {
   3.97293592591325*^9, 3.972935931176854*^9}, {3.972936099506748*^9, 
   3.9729361022889643`*^9}, {3.972936514780567*^9, 3.9729365166635513`*^9}, {
   3.972936592073453*^9, 3.97293659598372*^9}, {3.97294111351116*^9, 
   3.9729411176112423`*^9}, {3.9729428078819647`*^9, 
   3.9729428099941883`*^9}, {3.972943008668234*^9, 3.97294300992558*^9}, {
   3.972943082637169*^9, 3.972943091902536*^9}, {3.972943480166814*^9, 
   3.972943486301208*^9}, 3.972944322406741*^9, {3.972946294922778*^9, 
   3.972946298012265*^9}, {3.972947504174698*^9, 3.972947507686174*^9}, {
   3.972948250488637*^9, 3.9729482523433857`*^9}, {3.972948376421206*^9, 
   3.9729483788676662`*^9}, {3.9729493415244226`*^9, 3.972949346485941*^9}, {
   3.9729524867084217`*^9, 3.972952491039796*^9}, {3.972952707059341*^9, 
   3.972952709863031*^9}, {3.972953084488426*^9, 3.972953086119297*^9}, {
   3.972954059279327*^9, 3.97295406616273*^9}, {3.972954366732396*^9, 
   3.972954367836185*^9}, {3.9729546500333843`*^9, 3.972954653253916*^9}, {
   3.9729549339041843`*^9, 3.972954943780047*^9}, {3.9729555902646513`*^9, 
   3.972955593090949*^9}, {3.972982669606431*^9, 3.972982671588213*^9}, {
   3.972983400646928*^9, 3.9729834200960417`*^9}, {3.972996270671753*^9, 
   3.9729962719419603`*^9}, {3.9729978318724194`*^9, 3.972997839551592*^9}, {
   3.9729989074865713`*^9, 3.9729989113149443`*^9}, {3.97299910071637*^9, 
   3.972999107015458*^9}, {3.972999190714859*^9, 3.9729991929308853`*^9}, {
   3.9730083430329237`*^9, 3.9730083468542223`*^9}, {3.973008721277548*^9, 
   3.973008722133999*^9}, {3.973011182496832*^9, 3.973011183521449*^9}, {
   3.9730125969867687`*^9, 3.973012597877582*^9}, {3.9730190717816067`*^9, 
   3.973019083183034*^9}, {3.973019253498823*^9, 3.973019255173574*^9}, {
   3.9730405556839848`*^9, 3.973040585573874*^9}, {3.973040749918388*^9, 
   3.9730407574102297`*^9}, {3.973041122924108*^9, 3.9730411230453444`*^9}, {
   3.9730415816243258`*^9, 3.9730415817310467`*^9}, {3.973042081646696*^9, 
   3.973042081780352*^9}, {3.973042434977289*^9, 3.9730424350892277`*^9}, {
   3.9730426916698427`*^9, 3.973042691736341*^9}, {3.973042827255773*^9, 
   3.973042827461238*^9}, {3.973055291593264*^9, 3.97305529171705*^9}, {
   3.973055439717607*^9, 3.973055440228651*^9}, {3.973055652589979*^9, 
   3.9730556568969193`*^9}, {3.973077246073792*^9, 3.973077246219512*^9}, 
   3.973100439053523*^9, {3.973100518727088*^9, 3.973100525339612*^9}, {
   3.97310339261169*^9, 3.973103395189974*^9}, {3.973104608553104*^9, 
   3.9731046087647953`*^9}, {3.973104714373859*^9, 3.973104715625922*^9}, {
   3.9731047497206697`*^9, 3.973104750618188*^9}, {3.973104881952824*^9, 
   3.973104882123973*^9}, {3.973187913095233*^9, 3.973187959609621*^9}, {
   3.973194667873643*^9, 3.973194667938262*^9}, {3.973220629777708*^9, 
   3.973220640505968*^9}, {3.973220804323019*^9, 3.973220813683702*^9}, {
   3.973259684691613*^9, 3.9732596884450817`*^9}, {3.97326007554886*^9, 
   3.97326007680262*^9}, {3.9732704126089773`*^9, 3.973270413374819*^9}, 
   3.973270602180787*^9, {3.973271202921463*^9, 3.973271205298073*^9}, {
   3.9738847460395193`*^9, 3.973884754480817*^9}, {3.973897070162611*^9, 
   3.973897070498702*^9}, {3.9738972434076777`*^9, 3.97389724347053*^9}, {
   3.974697584779655*^9, 3.974697584981729*^9}, 3.974697820489111*^9, {
   3.9746980161908484`*^9, 3.974698017634491*^9}, {3.97469809397274*^9, 
   3.974698105474676*^9}, {3.974698228582293*^9, 3.974698228705759*^9}, {
   3.974698451220035*^9, 3.97469845191663*^9}, {3.974727614433895*^9, 
   3.974727615625905*^9}, {3.974751329926149*^9, 3.974751330334826*^9}, {
   3.9747835862048798`*^9, 3.974783586656179*^9}, {3.97551678441676*^9, 
   3.975516785425414*^9}, {3.97551709908255*^9, 3.975517104422768*^9}, {
   3.976559717416106*^9, 3.976559719484202*^9}, {3.976691025581098*^9, 
   3.976691028196566*^9}, {3.9768769237633343`*^9, 3.976876925009585*^9}, {
   3.9769859643345013`*^9, 3.976985965864517*^9}, {3.977254545117715*^9, 
   3.9772545496852627`*^9}, {3.9772549056350107`*^9, 
   3.9772549179134827`*^9}, {3.977255017486516*^9, 3.977255020052417*^9}, {
   3.977255061463842*^9, 3.977255063073419*^9}, {3.9772564219789248`*^9, 
   3.977256424688249*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ccd589dc-6fff-4f2e-a5df-8e7946336d0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scale Constants", "Subsection",ExpressionUUID->"bc5abab2-31ea-4155-89b5-2a66a0569a67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"boundarySpineRate", "=", 
   RowBox[{"10", "^", "24"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eps", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "50"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972940705065802*^9, 3.972940705275634*^9}, {
  3.972957259962461*^9, 3.972957260426115*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"30f89d95-4507-4cfa-8126-b772fc953727"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic Definitions", "Subsection",ExpressionUUID->"0a483fc6-e16a-4d70-9375-f6b558536599"],

Cell["\<\
There are four types of ends which we use to apply specific rules to only \
actins of those types:\
\>", "Text",ExpressionUUID->"a132808a-bf4e-4453-96c4-c95b9430ff50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ATP", "=", "0."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ADPPlusPi", "=", "1."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ADP", "=", "2."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cofilin", "=", "3."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cofilinSingle", "=", "4."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aip1", "=", "5."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camABP", "=", "6."}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.970161254036401*^9, 3.970161259117684*^9}, 
   3.970162565395163*^9, {3.976845082336907*^9, 3.976845086742317*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ec6b5acb-f86a-4eca-980d-1726ddc1674c"],

Cell["\<\
Codes for specific IDs for no connection - basically null pointers\
\>", "Text",ExpressionUUID->"fe03d3a7-52fa-4170-acad-734cb39d9240"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"distFree", "=", "1."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nullPointer", "=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkPointer", "=", 
   RowBox[{"-", "2."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"emptyPointer", "=", 
   RowBox[{"-", "3."}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9644676393818197`*^9, 3.964467645630945*^9}, {
  3.964467733629807*^9, 3.96446773669774*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"5ef4ef4c-e5a5-496d-9782-56ffae3dabaf"],

Cell["\<\
We allow actins to be attached to either ATP or ADP, both when they exist in \
free globular form (G-Actin) and when they are attached to filaments \
(F-Actin). \
\>", "Text",ExpressionUUID->"bbe8257d-4ce9-476b-b657-8edf84ba1949"],

Cell["\<\
Here are IDs representing what type of information is stored at each position \
of an actin object.\
\>", "Text",ExpressionUUID->"434ca94e-74f4-48ca-bd57-20c754b59c0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"potentialElectroFunc", "[", 
   RowBox[{"dIn_", ",", "rules_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Epsilon]Pot", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["R", "2"], "-", "R"}], ")"}]}], "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"rules", ",", 
     RowBox[{"{", 
      RowBox[{"d", "->", "dIn"}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"potentialElectro", "[", 
   RowBox[{"d_", ",", "rules_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "}"}], ",", 
      RowBox[{"4", "\[Epsilon]PotLJ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["R", "2"], "-", "R"}], ")"}]}]}], "]"}], ")"}], "/.", 
   "rules"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clipFunction", "[", 
    RowBox[{"func_", ",", "var_", ",", "\[Epsilon]_"}], "]"}], ":=", "\n", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"func", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"d", ">=", 
         RowBox[{"\[Epsilon]", "*", "d0"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"func", " ", "/.", 
           RowBox[{"var", "->", 
            RowBox[{"\[Epsilon]", "*", "d0"}]}]}], ")"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "-", 
            RowBox[{"\[Epsilon]", "*", "d0"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"func", ",", "var"}], "]"}], "/.", 
            RowBox[{"var", "->", 
             RowBox[{"\[Epsilon]", "*", "d0"}]}]}], ")"}]}]}], ")"}], 
       RowBox[{"Boole", "[", 
        RowBox[{"d", "<", 
         RowBox[{"\[Epsilon]", "*", "d0"}]}], "]"}]}], "-", 
      RowBox[{"(", 
       RowBox[{"func", "/.", 
        RowBox[{"var", "->", "overgrowthL"}]}], ")"}]}], ")"}], 
    RowBox[{"Boole", "[", 
     RowBox[{"d", "<=", "overgrowthL"}], "]"}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"clipped", "=", 
    RowBox[{"clipFunction", "[", 
     RowBox[{
      RowBox[{"potentialElectro", "[", 
       RowBox[{"d", ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "d", ",", "clipFactor"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", 
    RowBox[{"dIn_", ",", "rules_", ",", "clipFactorIn_", ",", 
     RowBox[{"optimal_", ":", "1."}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", "clipped", ")"}], "/.", "rules"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "->", "dIn"}], ",", 
      RowBox[{"clipFactor", "->", "clipFactorIn"}], ",", 
      RowBox[{"d0", "->", "optimal"}]}], "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963665041785531*^9, 3.963665094219193*^9}, {
   3.9636654580253353`*^9, 3.9636654621069202`*^9}, {3.9636661449464827`*^9, 
   3.963666198940413*^9}, 3.963687734813878*^9, {3.964012226593399*^9, 
   3.9640122300286016`*^9}, {3.96401228177001*^9, 3.9640122989831533`*^9}, {
   3.964012498087483*^9, 3.964012498983975*^9}, {3.96401559770057*^9, 
   3.964015611611031*^9}, {3.964015711967483*^9, 3.964015723591593*^9}, {
   3.9640182997027397`*^9, 3.964018302408225*^9}, {3.9641854382520723`*^9, 
   3.964185440751989*^9}, {3.96423735807889*^9, 3.964237372996917*^9}, 
   3.964240114042645*^9, {3.9644465529679728`*^9, 3.964446554545426*^9}, {
   3.964446631574651*^9, 3.964446657424498*^9}, {3.96444683698393*^9, 
   3.964446880096212*^9}, {3.9644478844767*^9, 3.964447885203401*^9}, {
   3.9644479324240723`*^9, 3.964447932891996*^9}, {3.9644479697552757`*^9, 
   3.964447973720544*^9}, {3.96444801410137*^9, 3.964448014723114*^9}, 
   3.964448115184477*^9, {3.964448169065654*^9, 3.964448213611808*^9}, {
   3.9644483916017637`*^9, 3.964448391691865*^9}, {3.9644484266779537`*^9, 
   3.964448456206204*^9}, {3.964448709748747*^9, 3.9644487417294416`*^9}, {
   3.964449172274599*^9, 3.964449184869836*^9}, {3.964449297482861*^9, 
   3.964449316596417*^9}, {3.964449513936542*^9, 3.964449543434222*^9}, {
   3.964449872852128*^9, 3.96444989089287*^9}, {3.9644499704455433`*^9, 
   3.964449999103786*^9}, {3.9644501731340847`*^9, 3.964450235825129*^9}, {
   3.964450271432434*^9, 3.964450345710717*^9}, {3.964450391769064*^9, 
   3.964450397079302*^9}, {3.964452290094611*^9, 3.964452292616673*^9}, {
   3.9644525749935503`*^9, 3.96445261291638*^9}, 3.964497733764977*^9, 
   3.964497771775317*^9, 3.965491333268445*^9, {3.972935051127532*^9, 
   3.972935070305299*^9}, {3.9729351227274227`*^9, 3.972935122940029*^9}, {
   3.9729440557625847`*^9, 3.972944071993018*^9}, {3.972944188998605*^9, 
   3.972944224455167*^9}, {3.9729446321541033`*^9, 3.972944650665509*^9}, {
   3.972944683511615*^9, 3.972944704547903*^9}, {3.972944753416037*^9, 
   3.972944757381587*^9}, {3.972945074905464*^9, 3.9729450751777773`*^9}, {
   3.972946844327467*^9, 3.9729468526391907`*^9}, {3.972946923449319*^9, 
   3.972946929386754*^9}, {3.972947918553789*^9, 3.972947923362247*^9}, {
   3.9729548953950977`*^9, 3.9729549149890127`*^9}, {3.972958399717432*^9, 
   3.972958399862381*^9}, {3.9729584506630373`*^9, 3.972958458044857*^9}, {
   3.9729796425819693`*^9, 3.97297964308149*^9}, {3.973014583126775*^9, 
   3.973014629097879*^9}, {3.973014666687244*^9, 3.973014678742111*^9}, 
   3.973015419697097*^9, {3.973015708810439*^9, 3.973015712501891*^9}, {
   3.973015812344927*^9, 3.973015814404818*^9}, {3.973104524089993*^9, 
   3.973104526086532*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"89a4c3a4-6589-40a4-83c2-6294682ee132"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"potentialElectroFunc", "[", 
        RowBox[{"d", ",", 
         RowBox[{"{", "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "]"}]}], ",", 
      "d"}], "]"}], "==", "0"}], ",", "\[Sigma]LJ"}], "]"}]], "Input",
 CellChangeTimes->{{3.9636650958797703`*^9, 3.963665124594668*^9}, 
   3.963665484606159*^9, {3.964237380099985*^9, 3.964237394384944*^9}, {
   3.9644485489355717`*^9, 3.964448571359662*^9}, 3.964450004939499*^9, {
   3.964450352594412*^9, 3.964450378186192*^9}, {3.964450419161718*^9, 
   3.9644504224204063`*^9}, {3.964452333617106*^9, 3.9644523337728367`*^9}},
 CellLabel->
  "In[10908]:=",ExpressionUUID->"80ed76c5-eb72-4813-a9f1-1979f170e2d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["d", 
       SuperscriptBox["2", 
        RowBox[{"1", "/", "6"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     FractionBox["d", 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "6"}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]], " ", "d"}], 
       SuperscriptBox["2", 
        RowBox[{"1", "/", "6"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "3"}]], " ", "d"}], 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "6"}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "d"}], 
       SuperscriptBox["2", 
        RowBox[{"1", "/", "6"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]LJ", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"2", "/", "3"}]], " ", "d"}], 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "6"}]]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.963665125248074*^9, 3.963665485358533*^9, 3.9636662105876713`*^9, 
   3.963687730513699*^9, 3.9640122312092953`*^9, 3.964012309194317*^9, {
   3.9640156022135572`*^9, 3.964015612647122*^9}, 3.9640183043232327`*^9, 
   3.964064598033143*^9, 3.964185443105042*^9, {3.964237374948304*^9, 
   3.964237394625773*^9}, 3.964446659400717*^9, 3.964447887695538*^9, 
   3.964447940971217*^9, 3.964448218284409*^9, 3.964448392731339*^9, 
   3.964448744500237*^9, 3.964449186516891*^9, {3.964449884262637*^9, 
   3.964449892018749*^9}, 3.964450000398438*^9, {3.964450372162529*^9, 
   3.964450378510644*^9}, 3.9644504226614027`*^9, 3.964452345257779*^9, 
   3.965903418330537*^9, 3.97301468123466*^9, 3.973015717977427*^9, 
   3.973041588045947*^9},
 CellLabel->
  "Out[10908]=",ExpressionUUID->"09b30257-22c2-4b19-b8d1-2b8b7bff577c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"potentialElectro", "[", 
     RowBox[{"d", ",", 
      RowBox[{"actinRule", "[", 
       RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"actinObjectRise", "/", "2"}], ",", 
     RowBox[{"actinObjectRise", "*", "2."}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.964451153613446*^9, 3.96445119478568*^9}, {
  3.965903424155773*^9, 3.965903431506151*^9}, {3.9729382549230347`*^9, 
  3.9729382569451857`*^9}, {3.9729468102294903`*^9, 3.972946811152609*^9}, {
  3.973015682407423*^9, 3.97301568425273*^9}},
 CellLabel->
  "In[10909]:=",ExpressionUUID->"0c06226a-d132-4936-87cb-f0b18fc79e50"],

Cell[BoxData[
 GraphicsBox[
  InterpretationBox[{
    TagBox[{{{}, {}, 
       TagBox[
        {RGBColor[0.24, 0.6, 0.8], AbsoluteThickness[2], Opacity[1.], 
         LineBox[CompressedData["
1:eJwBsQRO+yFib1JlAgAAAEoAAAACAAAA51oua9UEYT5Hn7SKrH7VPKeCbMWL
G2E+VR1s6uDk0zz8tO/3TEthPlkoPH0iAdE8UOdyKg57YT58ZJ8RDQvNPKUZ
9lzPqmE+hRgHOP/FyDz+snN65gNiPuxPKx/bVcI8Vkzxl/1cYj5m8VqOj+26
PFqlvnACYGI+3p0OV5ekujxd/otJB2NiPmSF0A5OXLo8ZLAm+xBpYj42bGuz
wc25PHIUXF4kdWI+NtJbj5S4uDyO3MYkS41iPpku5ZuLrLY8xmycsZi9Yj4s
/7vemwOzPDeNR8szHmM+RZaw2AZQqjx3N4xvk9JjPhxwnjBw/Jc8BoLjsWaD
ZD7XLGowdyaAPMXalexBQ2U+xzgJoFBJVbzinDaYRvZlPlAC1OhsW3e8L20y
PFO4Zj6ffvoUQC6AvMvdQH7Tdmc+WRnUrwibgbzGtz0xfShoPiBNhJYaeoG8
8Z+V3C7paD6C5kQ5+YKAvHrx2/gJnWk+ReL55sN8frwzUX0N7V9qPvfJBn/u
dnu8O1ExwEMfaz4GYT3ecIJ4vKG60+PD0Ws+M9X9lpTmdbw3MtH/S5NsPtBW
mNOCTXO8LBO9jP1HbT5OMOEfzR1xvHCUu7ci+W0+fJJlP/ZkbrzkIxXbT7lu
PqwKOjPStGq8thxdb6Zsbz5Y91Sl/qxnvNwRAH6CF3A+StMtw03LZLyF5VqT
63ZwPigdjV25U2K83e0sYenPcD5XTDyDcE9gvE19LCtrMHE+19VgkCPKXLxs
QaOtgYpxPgPGYUfIqFm8s1Uj/9HicT4t3s8EkvRWvBLx0EymQnI+gpxI0aRg
VLwgwfVSD5xyPtTYiP2MQ1K8RhhIVfz8cj7NUmy/oT9QvBukERB+V3M++zZG
tl0vTbwYgOSZObBzPrQ4dHCUTkq8LePkH3kQdD6HdjKXwItHvPF6XF5NanQ+
TXbRlORDRbzNmQGZpct0PipwkCRCE0O80AiwojcrdT5nwNA9jixBvIOs1WRe
hHU+vkCeBq8wP7xN1ygjCeV1PqW6ZvZcIzy8xzbzmUg/dj4YmavBr5g5vGjm
xt/Bl3Y+ZH0OSupbN7whHcghv/d2Ps35QUzuLjW8iYhAHFFRdz7I5TtWwFwz
vKqHMw/hUnc+T68k1ApVM7zKhiYCcVR3Pu1GquBYTTO8C4UM6JBXdz5GpB+e
/z0zvI2B2LPQXXc+f235dncfM7yRenBLUGp3PsSHGAYP4zK8mWygek+Ddz5J
bHL+0GwyvLprk23fhHc+zLhyy4llMrzaaoZgb4Z3PrQSre1FXjK8G2lsRo+J
dz4w9OcqyE8yvJ1lOBLPj3c+lAlWWPQyMryhXtCpTpx3Pn2/SQHq+TG8wl3D
nN6ddz4vS8VU1/IxvOJcto9un3c+/MlM4sfrMbwjW5x1jqJ3Plz/1aSy3TG8
pVdoQc6odz6VNGOZrsExvMZWWzReqnc+Io3JjrW6MbzmVU4n7qt3PkBHAbG/
szG8J1Q0DQ6vdz6shFl13aUxvEhTJwCesHc+7rA2FPGeMbxoUhrzLbJ3PnmP
XtkHmDG8iFEN5r2zdz7IyDHDIZExvKlQANlNtXc+uvIR0D6KMbw+8DvJ
          "]]},
        Annotation[#, "Charting`Private`Tag#1"]& ]}, {}},
     {"WolframDynamicHighlight", <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
    StyleBox[
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
           Annotation[{
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]], 
             Line[CompressedData["
1:eJwBsQRO+yFib1JlAgAAAEoAAAACAAAA51oua9UEYT5Hn7SKrH7VPKeCbMWL
G2E+VR1s6uDk0zz8tO/3TEthPlkoPH0iAdE8UOdyKg57YT58ZJ8RDQvNPKUZ
9lzPqmE+hRgHOP/FyDz+snN65gNiPuxPKx/bVcI8Vkzxl/1cYj5m8VqOj+26
PFqlvnACYGI+3p0OV5ekujxd/otJB2NiPmSF0A5OXLo8ZLAm+xBpYj42bGuz
wc25PHIUXF4kdWI+NtJbj5S4uDyO3MYkS41iPpku5ZuLrLY8xmycsZi9Yj4s
/7vemwOzPDeNR8szHmM+RZaw2AZQqjx3N4xvk9JjPhxwnjBw/Jc8BoLjsWaD
ZD7XLGowdyaAPMXalexBQ2U+xzgJoFBJVbzinDaYRvZlPlAC1OhsW3e8L20y
PFO4Zj6ffvoUQC6AvMvdQH7Tdmc+WRnUrwibgbzGtz0xfShoPiBNhJYaeoG8
8Z+V3C7paD6C5kQ5+YKAvHrx2/gJnWk+ReL55sN8frwzUX0N7V9qPvfJBn/u
dnu8O1ExwEMfaz4GYT3ecIJ4vKG60+PD0Ws+M9X9lpTmdbw3MtH/S5NsPtBW
mNOCTXO8LBO9jP1HbT5OMOEfzR1xvHCUu7ci+W0+fJJlP/ZkbrzkIxXbT7lu
PqwKOjPStGq8thxdb6Zsbz5Y91Sl/qxnvNwRAH6CF3A+StMtw03LZLyF5VqT
63ZwPigdjV25U2K83e0sYenPcD5XTDyDcE9gvE19LCtrMHE+19VgkCPKXLxs
QaOtgYpxPgPGYUfIqFm8s1Uj/9HicT4t3s8EkvRWvBLx0EymQnI+gpxI0aRg
VLwgwfVSD5xyPtTYiP2MQ1K8RhhIVfz8cj7NUmy/oT9QvBukERB+V3M++zZG
tl0vTbwYgOSZObBzPrQ4dHCUTkq8LePkH3kQdD6HdjKXwItHvPF6XF5NanQ+
TXbRlORDRbzNmQGZpct0PipwkCRCE0O80AiwojcrdT5nwNA9jixBvIOs1WRe
hHU+vkCeBq8wP7xN1ygjCeV1PqW6ZvZcIzy8xzbzmUg/dj4YmavBr5g5vGjm
xt/Bl3Y+ZH0OSupbN7whHcghv/d2Ps35QUzuLjW8iYhAHFFRdz7I5TtWwFwz
vKqHMw/hUnc+T68k1ApVM7zKhiYCcVR3Pu1GquBYTTO8C4UM6JBXdz5GpB+e
/z0zvI2B2LPQXXc+f235dncfM7yRenBLUGp3PsSHGAYP4zK8mWygek+Ddz5J
bHL+0GwyvLprk23fhHc+zLhyy4llMrzaaoZgb4Z3PrQSre1FXjK8G2lsRo+J
dz4w9OcqyE8yvJ1lOBLPj3c+lAlWWPQyMryhXtCpTpx3Pn2/SQHq+TG8wl3D
nN6ddz4vS8VU1/IxvOJcto9un3c+/MlM4sfrMbwjW5x1jqJ3Plz/1aSy3TG8
pVdoQc6odz6VNGOZrsExvMZWWzReqnc+Io3JjrW6MbzmVU4n7qt3PkBHAbG/
szG8J1Q0DQ6vdz6shFl13aUxvEhTJwCesHc+7rA2FPGeMbxoUhrzLbJ3PnmP
XtkHmDG8iFEN5r2zdz7IyDHDIZExvKlQANlNtXc+uvIR0D6KMbw+8DvJ
              "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{2.208*^-8, 8.832*^-8}, {-3.0540849884679876`*^-17,
             1.1932022192081619`*^-15}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {2.208000000000005*^-8, 1.2351802897963827`*^-16}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, 
          "PlotRange" -> {{2.208*^-8, 8.832*^-8}, {-3.0540849884679876`*^-17, 
           1.1932022192081619`*^-15}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {2.208000000000005*^-8, 1.2351802897963827`*^-16}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             RGBColor[0.24, 0.6, 0.8], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              (Identity[#]& )[
               Part[#, 1]], 
              (Identity[#]& )[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}],
     Selectable->False]},
   Annotation[{{{{}, {}, 
       Annotation[{
         Directive[
          Opacity[1.], 
          RGBColor[0.24, 0.6, 0.8], 
          AbsoluteThickness[2]], 
         Line[CompressedData["
1:eJwBsQRO+yFib1JlAgAAAEoAAAACAAAA51oua9UEYT5Hn7SKrH7VPKeCbMWL
G2E+VR1s6uDk0zz8tO/3TEthPlkoPH0iAdE8UOdyKg57YT58ZJ8RDQvNPKUZ
9lzPqmE+hRgHOP/FyDz+snN65gNiPuxPKx/bVcI8Vkzxl/1cYj5m8VqOj+26
PFqlvnACYGI+3p0OV5ekujxd/otJB2NiPmSF0A5OXLo8ZLAm+xBpYj42bGuz
wc25PHIUXF4kdWI+NtJbj5S4uDyO3MYkS41iPpku5ZuLrLY8xmycsZi9Yj4s
/7vemwOzPDeNR8szHmM+RZaw2AZQqjx3N4xvk9JjPhxwnjBw/Jc8BoLjsWaD
ZD7XLGowdyaAPMXalexBQ2U+xzgJoFBJVbzinDaYRvZlPlAC1OhsW3e8L20y
PFO4Zj6ffvoUQC6AvMvdQH7Tdmc+WRnUrwibgbzGtz0xfShoPiBNhJYaeoG8
8Z+V3C7paD6C5kQ5+YKAvHrx2/gJnWk+ReL55sN8frwzUX0N7V9qPvfJBn/u
dnu8O1ExwEMfaz4GYT3ecIJ4vKG60+PD0Ws+M9X9lpTmdbw3MtH/S5NsPtBW
mNOCTXO8LBO9jP1HbT5OMOEfzR1xvHCUu7ci+W0+fJJlP/ZkbrzkIxXbT7lu
PqwKOjPStGq8thxdb6Zsbz5Y91Sl/qxnvNwRAH6CF3A+StMtw03LZLyF5VqT
63ZwPigdjV25U2K83e0sYenPcD5XTDyDcE9gvE19LCtrMHE+19VgkCPKXLxs
QaOtgYpxPgPGYUfIqFm8s1Uj/9HicT4t3s8EkvRWvBLx0EymQnI+gpxI0aRg
VLwgwfVSD5xyPtTYiP2MQ1K8RhhIVfz8cj7NUmy/oT9QvBukERB+V3M++zZG
tl0vTbwYgOSZObBzPrQ4dHCUTkq8LePkH3kQdD6HdjKXwItHvPF6XF5NanQ+
TXbRlORDRbzNmQGZpct0PipwkCRCE0O80AiwojcrdT5nwNA9jixBvIOs1WRe
hHU+vkCeBq8wP7xN1ygjCeV1PqW6ZvZcIzy8xzbzmUg/dj4YmavBr5g5vGjm
xt/Bl3Y+ZH0OSupbN7whHcghv/d2Ps35QUzuLjW8iYhAHFFRdz7I5TtWwFwz
vKqHMw/hUnc+T68k1ApVM7zKhiYCcVR3Pu1GquBYTTO8C4UM6JBXdz5GpB+e
/z0zvI2B2LPQXXc+f235dncfM7yRenBLUGp3PsSHGAYP4zK8mWygek+Ddz5J
bHL+0GwyvLprk23fhHc+zLhyy4llMrzaaoZgb4Z3PrQSre1FXjK8G2lsRo+J
dz4w9OcqyE8yvJ1lOBLPj3c+lAlWWPQyMryhXtCpTpx3Pn2/SQHq+TG8wl3D
nN6ddz4vS8VU1/IxvOJcto9un3c+/MlM4sfrMbwjW5x1jqJ3Plz/1aSy3TG8
pVdoQc6odz6VNGOZrsExvMZWWzReqnc+Io3JjrW6MbzmVU4n7qt3PkBHAbG/
szG8J1Q0DQ6vdz6shFl13aUxvEhTJwCesHc+7rA2FPGeMbxoUhrzLbJ3PnmP
XtkHmDG8iFEN5r2zdz7IyDHDIZExvKlQANlNtXc+uvIR0D6KMbw+8DvJ
          "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
    "HighlightElements" -> <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
     "LayoutOptions" -> <|
      "PanelPlotLayout" -> <||>, 
       "PlotRange" -> {{2.208*^-8, 8.832*^-8}, {-3.0540849884679876`*^-17, 
        1.1932022192081619`*^-15}}, 
       "Frame" -> {{False, False}, {False, False}}, 
       "AxesOrigin" -> {2.208000000000005*^-8, 1.2351802897963827`*^-16}, 
       "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
       "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
         Directive[
          Opacity[1.], 
          RGBColor[0.24, 0.6, 0.8], 
          AbsoluteThickness[2]]}, 
       "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), 
         "ScalingFunctions" -> {{Identity, Identity}, {Identity, Identity}}|>,
        "Primitives" -> {}, "GCFlag" -> False|>, 
     "Meta" -> <|
      "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
       Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{2.208000000000005*^-8, 1.2351802897963827`*^-16},
  DefaultBaseStyle->{"PlotGraphics", "Graphics"},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotInteractivity:>True,
  PlotRange->{{2.208*^-8, 8.832*^-8}, {-3.0540849884679876`*^-17, 
   1.1932022192081619`*^-15}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.96445117572486*^9, 3.9644511951414957`*^9}, {
   3.964497763179854*^9, 3.96449777919871*^9}, 3.964697137312385*^9, {
   3.965903411817569*^9, 3.965903431910194*^9}, 3.9729382583849573`*^9, 
   3.9729446791242447`*^9, 3.9729467761283197`*^9, 3.972946811498034*^9, 
   3.973014682631263*^9, {3.973015661477583*^9, 3.973015684748724*^9}, 
   3.97301571864603*^9, 3.973041588061532*^9},
 CellLabel->
  "Out[10909]=",ExpressionUUID->"2b9ce19e-1358-431d-aa43-11348ad3b226"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EqParams", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sigma]LJ", "\[Rule]", 
      FractionBox["d", 
       SuperscriptBox["2", 
        RowBox[{"1", "/", "6"}]]]}], ",", 
     RowBox[{"\[Sigma]Gauss", "\[Rule]", 
      RowBox[{"d", " ", 
       SqrtBox[
        FractionBox["3", 
         RowBox[{"Log", "[", "2", "]"}]]]}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963665491126638*^9, 3.963665499330139*^9}, 
   3.9636699001620502`*^9, 3.964012236606851*^9, 3.9640123169705057`*^9, 
   3.964015616984312*^9, 3.9640183095593557`*^9, {3.96418544570498*^9, 
   3.964185445910713*^9}, {3.964237401068398*^9, 3.964237403669861*^9}, 
   3.9644466648018637`*^9, 3.964447893404622*^9, 3.96444822703738*^9, 
   3.964448397236059*^9, {3.964448495105033*^9, 3.964448495295632*^9}, 
   3.9644485777018137`*^9, {3.964448634700581*^9, 3.964448656013158*^9}, 
   3.964448753070907*^9, 3.9644491904248466`*^9, 3.964449918553197*^9, {
   3.96445044029979*^9, 3.964450446958231*^9}, {3.966318372897849*^9, 
   3.9663183733199787`*^9}, {3.9729351361574383`*^9, 
   3.9729351413548527`*^9}, {3.972944766121324*^9, 3.9729447848778048`*^9}, 
   3.9729479374608927`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"ac30b482-ecc4-40ae-bad6-705e22de2d02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aipKO", "=", "False"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", "CONSTANTS"}], "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Chen", " ", "Q"}], ",", 
    RowBox[{"Courtemanche", " ", "N"}], ",", 
    RowBox[{
     RowBox[{"Pollard", " ", 
      RowBox[{"TD", ".", "Aip1"}], " ", "promotes", " ", "actin", " ", 
      "filament", " ", "severing", " ", "by", " ", "cofilin", " ", "and", " ",
       "regulates", " ", "constriction", " ", "of", " ", "the", " ", 
      "cytokinetic", " ", "contractile", " ", 
      RowBox[{"ring", ".", "J"}], " ", "Biol", " ", 
      RowBox[{"Chem", ".", "2015"}], " ", "Jan", " ", "23"}], ";", 
     RowBox[{
      RowBox[{"290", 
       RowBox[{"(", "4", ")"}]}], ":", 
      RowBox[{"2289", "-", 
       RowBox[{"300.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1074", "/", 
        RowBox[{"jbc", ".", "M114"}]}], 
       RowBox[{".612978", ".", "Epub"}], " ", "2014", " ", "Dec", " ", "1.", " ", 
       RowBox[{"PMID", ":", "25451933"}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC4303679", "."}]}]}]}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kaip1sever", "=", 
    RowBox[{"1", "/", "0.7"}]}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ArpCof", "=", "3.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"compRate", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Mahaffy", ",", 
    RowBox[{"R", ".", "E", "."}], ",", 
    RowBox[{"and", " ", "Pollard"}], ",", 
    RowBox[{
     RowBox[{"T", ".", "D", ".", 
      RowBox[{"(", "2006", ")"}], ".", "Kinetics"}], " ", "of", " ", "the", " ",
      "formation", " ", "and", "\n", "dissociation", " ", "of", " ", "actin", 
     " ", "filament", " ", "branches", " ", "mediated", " ", "by", " ", 
     RowBox[{"Arp2", "/", "3"}], " ", 
     RowBox[{"complex", ".", "Biophys", ".", "J", ".", "91"}]}], ",", "3519", 
    "\[Dash]", "3528."}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"debranchRate", "=", "0.2"}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Dominguez", " ", "R"}], ",", 
    RowBox[{
     RowBox[{"Holmes", " ", 
      RowBox[{"KC", ".", "Actin"}], " ", "structure", " ", "and", " ", 
      RowBox[{"function", ".", "Annu"}], " ", "Rev", " ", "Biophys", 
      ".2011"}], ";", 
     RowBox[{"40", ":", 
      RowBox[{"169", "-", 
       RowBox[{"86.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1146", "/", "annurev"}], "-", "biophys", "-", "042910", "-", 
       RowBox[{"155359.", " ", 
        RowBox[{"PMID", ":", "21314430"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC3130349", "."}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"actinMonomerRise", "=", 
   RowBox[{"2.76", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], " ", 
  RowBox[{"(*", "m", "*)"}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"actinObjectRise", "=", 
    RowBox[{"actinMonomerRise", " ", "nCG"}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Gittes", " ", "F"}], ",", 
    RowBox[{"Mickey", " ", "B"}], ",", 
    RowBox[{"Nettleton", " ", "J"}], ",", 
    RowBox[{
     RowBox[{"Howard", " ", 
      RowBox[{"J", ".", "Flexural"}], " ", "rigidity", " ", "of", " ", 
      "microtubules", " ", "and", " ", "actin", " ", "filaments", " ", 
      "measured", " ", "from", " ", "thermal", " ", "fluctuations", " ", "in",
       " ", 
      RowBox[{"shape", ".", "J"}], " ", "Cell", " ", "Biol", ".1993", " ", 
      "Feb"}], ";", 
     RowBox[{
      RowBox[{"120", 
       RowBox[{"(", "4", ")"}]}], ":", 
      RowBox[{"923", "-", 
       RowBox[{"34.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1083", "/", "jcb"}], ".120", ".4", 
       RowBox[{".923", ".", 
        RowBox[{"PMID", ":", "8432732"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC2200075", "."}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lp", "=", 
    RowBox[{"17.7", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}]}], 
   RowBox[{"(*", "m", "*)"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "persistence", " ", "length", " ", "of", " ", "actin", " ", "filament"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]p", "=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "actinObjectRise"}], ")"}], "/", "Lp"}], "]"}]}], 
   ";"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"spineHeadRadius", "=", 
   RowBox[{"0.125", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], 
  RowBox[{"(*", "m", "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"overgrowthL", "=", 
    RowBox[{"1.5", "*", "actinObjectRise"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"avogadros", "=", 
   RowBox[{"6.022", "*", 
    RowBox[{"10", "^", "23"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "310"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerRadiusCam", "=", 
   RowBox[{"77", 
    RowBox[{"(*", "Angstroms", "*)"}], "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "10"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"upperRadiusCam", "=", 
   RowBox[{"175", 
    RowBox[{"(*", "Angstroms", "*)"}], "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "10"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"middleRadiusCam", "=", 
    RowBox[{"100", 
     RowBox[{"(*", "Angstroms", "*)"}], "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "10"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"\[Theta]Arp", "=", 
   RowBox[{"70", " ", 
    RowBox[{"(*", "degrees", "*)"}], "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kB", "=", 
   RowBox[{"1.38", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "23"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{"J", "/", "K"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kBT", "=", 
    RowBox[{"kB", "*", "T"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Mogilner", " ", "A"}], ",", 
    RowBox[{
     RowBox[{"Oster", " ", 
      RowBox[{"G", ".", "Cell"}], " ", "motility", " ", "driven", " ", "by", " ",
       "actin", " ", 
      RowBox[{"polymerization", ".", "Biophys"}], " ", 
      RowBox[{"J", ".", "1996"}], " ", "Dec"}], ";", 
     RowBox[{
      RowBox[{"71", 
       RowBox[{"(", "6", ")"}]}], ":", 
      RowBox[{"3030", "-", 
       RowBox[{"45.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1016", "/", "S0006"}], "-", 
       RowBox[{"3495", 
        RowBox[{"(", "96", ")"}], "79496"}], "-", 
       RowBox[{"1.", " ", 
        RowBox[{"PMID", ":", "8968574"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC1233792", "."}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Kappa]S", "=", 
   RowBox[{"44.", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], 
    RowBox[{"(*", 
     RowBox[{"N", "/", "m"}], "*)"}], "*", "1000", "*", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "9"}]], "/", "actinMonomerRise"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Kappa]Smem", "=", 
   RowBox[{"44.", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], 
    RowBox[{"(*", 
     RowBox[{"N", "/", "m"}], "*)"}], "*", "1000", "*", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "9"}]], "/", "actinMonomerRise"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]A", "=", 
    RowBox[{"8.0", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}]}], 
   RowBox[{"(*", "m", "*)"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"diameter", " ", "of", " ", "actin", " ", "molecule"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]B", "=", 
    RowBox[{"0.040", "*", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "24"}]], "/", "actinObjectRise"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]ActinLJ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "/", "actinObjectRise"}], "*", "\[Epsilon]Pot", "*", 
     "nCG"}], "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"4", 
                 RowBox[{"potentialElectroFunc", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", "}"}], ",", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "]"}]}], 
                ",", "d"}], "]"}], ",", "d"}], "]"}], "==", "\[Kappa]S"}], 
           "]"}], "/.", "EqParams"}], ")"}], "/.", 
        RowBox[{"d", "->", "actinMonomerRise"}]}], ",", "\[Epsilon]Pot"}], 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9636652309049597`*^9, 3.963665245338982*^9}, 
   3.963665281297453*^9, {3.963665673889194*^9, 3.9636656976077213`*^9}, {
   3.963669879394846*^9, 3.9636698875475273`*^9}, {3.963681124772924*^9, 
   3.963681133634727*^9}, {3.9636813132002974`*^9, 3.96368132453295*^9}, {
   3.963683894655649*^9, 3.963683897890894*^9}, {3.963686778916059*^9, 
   3.963686790974758*^9}, {3.963686945829967*^9, 3.963686947694908*^9}, {
   3.963733635314168*^9, 3.963733642751939*^9}, {3.963745719270769*^9, 
   3.963745727330338*^9}, {3.963745844506912*^9, 3.9637458478849*^9}, {
   3.9637534833695297`*^9, 3.963753505211808*^9}, 3.9637542844114437`*^9, {
   3.9637873967427483`*^9, 3.963787399606564*^9}, 3.963808489193675*^9, {
   3.963809740526178*^9, 3.963809749209091*^9}, {3.963823793219846*^9, 
   3.963823834112591*^9}, 3.963858931093668*^9, {3.963860059037291*^9, 
   3.963860059979992*^9}, {3.9638602055582247`*^9, 3.963860216776648*^9}, {
   3.963860313120417*^9, 3.96386031704615*^9}, {3.963860409480733*^9, 
   3.963860419313984*^9}, {3.9638627049561768`*^9, 3.963862705971703*^9}, {
   3.9640118942672253`*^9, 3.964011897488597*^9}, 3.964012089646491*^9, {
   3.964013076089136*^9, 3.9640130871818333`*^9}, {3.9640150137869587`*^9, 
   3.964015013871561*^9}, 3.964015537284315*^9, {3.964015748942786*^9, 
   3.9640157490404453`*^9}, {3.964015804371122*^9, 3.964015804459322*^9}, {
   3.964015922569182*^9, 3.964015922591992*^9}, {3.964019636160118*^9, 
   3.964019667792142*^9}, {3.964020089422988*^9, 3.9640200910124683`*^9}, {
   3.964020782083815*^9, 3.964020782130739*^9}, {3.964023029950861*^9, 
   3.964023030011503*^9}, {3.964023598820228*^9, 3.9640235997045593`*^9}, {
   3.964024525189938*^9, 3.964024533736911*^9}, {3.964024785547668*^9, 
   3.964024794352811*^9}, {3.964024880707213*^9, 3.964024883738742*^9}, {
   3.9640251278863297`*^9, 3.9640251291468678`*^9}, {3.964036411702859*^9, 
   3.9640364124566603`*^9}, 3.9640365131783657`*^9, {3.964036571644923*^9, 
   3.964036577184725*^9}, {3.96403662889223*^9, 3.9640366294086657`*^9}, 
   3.9640366701951017`*^9, {3.964185203233225*^9, 3.964185208816904*^9}, {
   3.964185363927149*^9, 3.96418536590453*^9}, 3.96418557815524*^9, 
   3.964185759242655*^9, {3.9642267214205112`*^9, 3.964226722012442*^9}, {
   3.964237741891255*^9, 3.964237742662819*^9}, {3.964237807186998*^9, 
   3.964237829669764*^9}, {3.964238094913167*^9, 3.964238108322432*^9}, {
   3.964238197710338*^9, 3.964238198005618*^9}, 3.964238488886485*^9, {
   3.9642402044870367`*^9, 3.9642402046122704`*^9}, {3.964240363262553*^9, 
   3.964240365623928*^9}, {3.964259896558906*^9, 3.9642599111407413`*^9}, {
   3.9642599503409243`*^9, 3.964259961123727*^9}, {3.964260136347763*^9, 
   3.964260178130694*^9}, {3.964266686537347*^9, 3.964266688329068*^9}, {
   3.964269445805534*^9, 3.96426944663027*^9}, {3.964294723113236*^9, 
   3.964294729703053*^9}, {3.964310742535521*^9, 3.964310758738277*^9}, {
   3.9644130916691027`*^9, 3.964413094850699*^9}, {3.9644465412003183`*^9, 
   3.964446542894876*^9}, {3.9644467332851*^9, 3.964446749991558*^9}, {
   3.9644469969991693`*^9, 3.964447005995153*^9}, {3.964447055855363*^9, 
   3.964447056030777*^9}, {3.964447136874277*^9, 3.964447139896497*^9}, {
   3.964447186363842*^9, 3.964447255990181*^9}, {3.964447297633114*^9, 
   3.964447374744669*^9}, {3.9644486612773933`*^9, 3.964448671617577*^9}, {
   3.96444881199692*^9, 3.964448812163889*^9}, 3.964449045341804*^9, {
   3.964449127057601*^9, 3.9644491274457397`*^9}, {3.964449265106909*^9, 
   3.964449289063526*^9}, {3.9644494485756083`*^9, 3.964449448791812*^9}, {
   3.964450014475608*^9, 3.964450064223675*^9}, {3.9644504544254103`*^9, 
   3.964450457676057*^9}, {3.964450592413555*^9, 3.964450650870914*^9}, {
   3.9644509888718452`*^9, 3.96445101038734*^9}, {3.9644510527643557`*^9, 
   3.96445105289461*^9}, 3.9644523045435*^9, {3.964497508579895*^9, 
   3.9644975131523867`*^9}, {3.964497696709153*^9, 3.964497700773694*^9}, {
   3.964497979507759*^9, 3.964498000074972*^9}, {3.964498064727216*^9, 
   3.9644980707654657`*^9}, {3.9644986780886097`*^9, 3.964498762245728*^9}, {
   3.964498819828511*^9, 3.964498828103841*^9}, {3.964498892359523*^9, 
   3.96449891350653*^9}, {3.964499556769617*^9, 3.964499642470167*^9}, {
   3.96449981333246*^9, 3.964499815062023*^9}, {3.9645000052071867`*^9, 
   3.964500005864768*^9}, {3.964500051055851*^9, 3.964500063927844*^9}, {
   3.964500365743683*^9, 3.964500374088306*^9}, {3.9645005996762943`*^9, 
   3.9645006000886993`*^9}, {3.964501255802174*^9, 3.964501258058167*^9}, {
   3.964501956168725*^9, 3.964501964052761*^9}, {3.964503277627507*^9, 
   3.964503278597818*^9}, {3.964514150408976*^9, 3.964514158026853*^9}, 
   3.9645143074883413`*^9, {3.964514376105466*^9, 3.964514377901512*^9}, {
   3.964514413556654*^9, 3.964514413917803*^9}, {3.964514462030175*^9, 
   3.964514462407192*^9}, {3.9645145861273317`*^9, 3.964514588165185*^9}, {
   3.964514622274206*^9, 3.964514622686754*^9}, {3.964514676782913*^9, 
   3.964514677441207*^9}, 3.964514714308915*^9, 3.964531823405182*^9, {
   3.96453275462995*^9, 3.964532755077716*^9}, {3.964652440759901*^9, 
   3.964652441491817*^9}, {3.964652482782915*^9, 3.964652482999549*^9}, {
   3.964963116873543*^9, 3.964963133239317*^9}, {3.964963300407969*^9, 
   3.964963310441884*^9}, {3.965334276676238*^9, 3.965334341562728*^9}, {
   3.965334763071556*^9, 3.9653347852517643`*^9}, {3.965412404323379*^9, 
   3.965412436579214*^9}, {3.965450214670265*^9, 3.965450215214469*^9}, {
   3.965492230420745*^9, 3.965492231280712*^9}, {3.9655772921139603`*^9, 
   3.965577295922163*^9}, {3.965577455152094*^9, 3.9655774563305483`*^9}, {
   3.965577572233055*^9, 3.965577574703299*^9}, {3.965825434552146*^9, 
   3.965825440298965*^9}, {3.965825572997538*^9, 3.965825573035819*^9}, {
   3.96631816685725*^9, 3.966318168271947*^9}, {3.966318279458097*^9, 
   3.966318279781044*^9}, {3.9663183208654003`*^9, 3.966318321383305*^9}, {
   3.968957817790506*^9, 3.9689578198782988`*^9}, {3.96972990226816*^9, 
   3.969729903420918*^9}, 3.969806395369563*^9, {3.9698066303476877`*^9, 
   3.969806637773815*^9}, {3.969806707691927*^9, 3.969806713729632*^9}, {
   3.969806891871694*^9, 3.969806905206801*^9}, 3.96980696143948*^9, {
   3.969807040387616*^9, 3.969807042078848*^9}, {3.970148018447215*^9, 
   3.970148031621505*^9}, {3.970148280037623*^9, 3.970148280492717*^9}, {
   3.970160505248004*^9, 3.970160510668187*^9}, {3.970161122439204*^9, 
   3.970161123919532*^9}, {3.9701625908577337`*^9, 3.97016259260751*^9}, {
   3.970163031439856*^9, 3.9701630317996798`*^9}, {3.970231135586618*^9, 
   3.970231135918058*^9}, 3.970233018244396*^9, 3.970233134843102*^9, 
   3.970233229372623*^9, 3.9702340302431993`*^9, 3.972088246448935*^9, {
   3.972089578212399*^9, 3.972089602073483*^9}, {3.972089635433278*^9, 
   3.972089636810651*^9}, {3.9720897254131527`*^9, 3.972089726499605*^9}, {
   3.9720897926086493`*^9, 3.9720897997861633`*^9}, 3.972091009582286*^9, {
   3.972092705488744*^9, 3.972092708761856*^9}, {3.972092780833025*^9, 
   3.9720927900415277`*^9}, {3.972092838845675*^9, 3.97209283985844*^9}, 
   3.9720934667248487`*^9, {3.972291545237049*^9, 3.972291553156204*^9}, {
   3.9722925887893133`*^9, 3.9722925909531918`*^9}, {3.972370423491507*^9, 
   3.9723704251784*^9}, {3.9723705957921352`*^9, 3.972370596492063*^9}, {
   3.9723706630958652`*^9, 3.972370695826661*^9}, 3.972372586437937*^9, {
   3.97237507923094*^9, 3.972375088636198*^9}, {3.9723757809328136`*^9, 
   3.9723757825311327`*^9}, {3.972375848422168*^9, 3.9723758496669827`*^9}, {
   3.972375918300531*^9, 3.972375919719028*^9}, {3.972375953825404*^9, 
   3.972375955876012*^9}, {3.972380037835925*^9, 3.972380047065043*^9}, {
   3.972380429060425*^9, 3.972380430909012*^9}, {3.9725060733412724`*^9, 
   3.972506075067832*^9}, {3.972511022673959*^9, 3.972511025012353*^9}, {
   3.9725128978380117`*^9, 3.972513049269701*^9}, {3.972521602367528*^9, 
   3.972521608583362*^9}, {3.972521723974083*^9, 3.972521730279655*^9}, {
   3.972522945571912*^9, 3.972522945678823*^9}, 3.972643679388197*^9, {
   3.9726570245597687`*^9, 3.9726570246822643`*^9}, {3.972657459026465*^9, 
   3.972657459253812*^9}, {3.972659488008882*^9, 3.9726594954381847`*^9}, {
   3.9726652449047213`*^9, 3.972665245324305*^9}, {3.972665418389769*^9, 
   3.972665419676609*^9}, {3.972666692771578*^9, 3.972666693684991*^9}, {
   3.9726754998724823`*^9, 3.972675500582807*^9}, {3.97275688665306*^9, 
   3.972756888326314*^9}, {3.972757581918469*^9, 3.972757592339448*^9}, {
   3.9727606543738327`*^9, 3.9727606564180527`*^9}, {3.972783067952372*^9, 
   3.9727830715432663`*^9}, {3.9729359787040653`*^9, 3.972935981621848*^9}, {
   3.972936037257107*^9, 3.972936041654558*^9}, {3.972938225140917*^9, 
   3.9729382462377996`*^9}, {3.9729382852249002`*^9, 
   3.9729382894843817`*^9}, {3.9729383662610493`*^9, 3.972938366429039*^9}, {
   3.972938774887652*^9, 3.972938776006155*^9}, {3.972942668820847*^9, 
   3.9729426689088182`*^9}, {3.972942921523967*^9, 3.9729429227584553`*^9}, {
   3.972943495864818*^9, 3.9729434962010393`*^9}, {3.9729454422934437`*^9, 
   3.972945459069055*^9}, {3.972946323368312*^9, 3.9729463298973017`*^9}, {
   3.972947095458438*^9, 3.9729470980409184`*^9}, {3.972947465552683*^9, 
   3.972947488340147*^9}, {3.9729477724935923`*^9, 3.972947782002266*^9}, {
   3.972948658996154*^9, 3.9729486609659243`*^9}, {3.9729504326603117`*^9, 
   3.9729504330402184`*^9}, {3.972950483364068*^9, 3.972950483578566*^9}, {
   3.972958465749425*^9, 3.972958465879644*^9}, {3.9729807809652157`*^9, 
   3.972980781550721*^9}, 3.9729808278123417`*^9, {3.97299603487661*^9, 
   3.9729960414504967`*^9}, {3.9729966565286913`*^9, 3.972996658383898*^9}, {
   3.973008354363505*^9, 3.973008354554236*^9}, {3.973008452538101*^9, 
   3.973008453833012*^9}, {3.973011189124785*^9, 3.973011189181695*^9}, {
   3.973012051755196*^9, 3.973012053581175*^9}, {3.9730194410410023`*^9, 
   3.9730194422250643`*^9}, 3.973040429930756*^9, {3.973100335363838*^9, 
   3.973100339884982*^9}, {3.9732206868191557`*^9, 3.973220687766594*^9}, {
   3.9738776821563997`*^9, 3.973877682881337*^9}, {3.974752142517502*^9, 
   3.9747521426142397`*^9}, 3.974783620565226*^9, {3.97478393250408*^9, 
   3.9747839340948553`*^9}, {3.975516898924346*^9, 3.975516899000463*^9}, 
   3.975516964251375*^9, {3.97684511297678*^9, 3.976845150542034*^9}, {
   3.976876805808949*^9, 3.976876825022873*^9}, {3.9769865146441936`*^9, 
   3.9769865219255447`*^9}, {3.978012125838045*^9, 3.978012126270982*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"f0a4503a-d864-4dad-9f4e-14dc7069d338"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]ActinMemLJ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "/", "actinObjectRise"}], "*", "\[Epsilon]Pot", "*", 
     "nCG"}], "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"4", " ", 
                 RowBox[{"potentialElectroFunc", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", "}"}], ",", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "]"}]}], 
                ",", "d"}], "]"}], ",", "d"}], "]"}], "==", "\[Kappa]Smem"}], 
           "]"}], "/.", "EqParams"}], ")"}], "/.", 
        RowBox[{"d", "->", "actinMonomerRise"}]}], ",", "\[Epsilon]Pot"}], 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"actinRule", "[", 
     RowBox[{"dist_", ",", "endQ_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Epsilon]PotLJ", "->", 
       RowBox[{"If", "[", 
        RowBox[{"endQ", ",", 
         RowBox[{"\[Epsilon]ActinMemLJ", "/.", 
          RowBox[{"d", "->", "dist"}]}], ",", 
         RowBox[{"\[Epsilon]ActinLJ", "/.", 
          RowBox[{"d", "->", "dist"}]}]}], "]"}]}], ",", " ", 
      RowBox[{"\[Epsilon]PotGauss", "->", "0."}], ",", 
      RowBox[{"d0", "->", "dist"}], ",", 
      RowBox[{"prot", "->", "ACT"}], ",", 
      RowBox[{"\[Epsilon]", "->", "0.75"}], ",", 
      RowBox[{"updateFunction", "->", "step"}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]LJ", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]LJ", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "dist"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]Gauss", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]Gauss", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "dist"}], "}"}]}]}], "}"}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Cam", "=", "20."}], 
   RowBox[{"(*", 
    RowBox[{"N", "/", "m"}], "*)"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]CamLJ", "=", 
    RowBox[{"\[Epsilon]Pot", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"4", " ", 
                 RowBox[{"potentialElectroFunc", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", "}"}], ",", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "]"}]}], 
                ",", "d"}], "]"}], ",", "d"}], "]"}], "==", "\[Kappa]Cam"}], 
           "]"}], "/.", "EqParams"}], ")"}], ",", "\[Epsilon]Pot"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"\[Kappa]BCam", "=", "\[Kappa]B"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"camRule", "[", 
     RowBox[{"dist_", ",", "ABP_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]CamLJ"}], "/.", 
       RowBox[{"d", "->", "dist"}]}], ",", 
      RowBox[{"\[Epsilon]PotGauss", "->", "0."}], ",", 
      RowBox[{"d0", "->", "dist"}], ",", 
      RowBox[{"prot", "->", "CAM"}], ",", 
      RowBox[{"\[Epsilon]", "->", "0.75"}], ",", 
      RowBox[{"updateFunction", "->", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ABP", "===", "CAM"}], ",", "stepCam", ",", "step"}], 
        "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]LJ", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]LJ", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "dist"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]Gauss", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]Gauss", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "dist"}], "}"}]}]}], "}"}]}], ";"}], "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Arp", "=", "20."}], 
   RowBox[{"(*", 
    RowBox[{"N", "/", "m"}], "*)"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]ArpLJ", "=", 
    RowBox[{"\[Epsilon]Pot", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"4", " ", 
                 RowBox[{"potentialElectroFunc", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", "}"}], ",", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Sigma]LJ", "/", "d"}], ")"}], "6"]}], "]"}]}], 
                ",", "d"}], "]"}], ",", "d"}], "]"}], "==", "\[Kappa]Arp"}], 
           "]"}], "/.", "EqParams"}], ")"}], ",", "\[Epsilon]Pot"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arp23Height", "=", 
    RowBox[{
     RowBox[{"(", "0.012", ")"}], 
     RowBox[{"(*", "\[Mu]m", "*)"}], "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arpRule", "[", "ABP_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]ArpLJ"}], "/.", 
       RowBox[{"d", "->", "arp23Height"}]}], ",", 
      RowBox[{"\[Epsilon]PotGauss", "->", "0."}], ",", 
      RowBox[{"d0", "->", "arp23Height"}], ",", 
      RowBox[{"prot", "->", "ARP"}], ",", 
      RowBox[{"\[Epsilon]", "->", "0.75"}], ",", 
      RowBox[{"updateFunction", "->", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ABP", "===", "ARP"}], ",", "stepArp", ",", "step"}], 
        "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]LJ", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]LJ", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "arp23Height"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"\[Sigma]Gauss", "->", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]Gauss", "/.", "EqParams"}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"d", "->", "arp23Height"}], "}"}]}]}], "}"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]BArp", "=", "\[Kappa]B"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     RowBox[{"19.9", "/", "2"}], "\[Pi]"}]}], 
   RowBox[{"(*", 
    RowBox[{"Pa", " ", "s"}], "*)"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Newtonian", " ", "viscosity", " ", "of", " ", "medium"}], "*)"}], 
  "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Bonilla", "-", 
     RowBox[{"Quintana", " ", "M"}]}], ",", " ", 
    RowBox[{"W\[ODoubleDot]rg\[ODoubleDot]tter", " ", "F"}], ",", " ", 
    RowBox[{"Tetzlaff", " ", "C"}], ",", " ", 
    RowBox[{
     RowBox[{"Fauth", " ", 
      RowBox[{"M", ".", " ", "Modeling"}], " ", "the", " ", "Shape", " ", 
      "of", " ", "Synaptic", " ", "Spines", " ", "by", " ", "Their", " ", 
      "Actin", " ", 
      RowBox[{"Dynamics", ".", " ", "Front"}], " ", "Synaptic", " ", 
      RowBox[{"Neurosci", ".", " ", "2020"}], " ", "Mar", " ", "10"}], ";", 
     RowBox[{"12", ":", 
      RowBox[{"9.", " ", "doi"}], ":", " ", 
      RowBox[{
       RowBox[{"10.3389", "/", "fnsyn"}], ".2020", 
       RowBox[{".00009", ".", " ", 
        RowBox[{"PMID", ":", " ", "32218728"}]}]}]}], ";", " ", 
     RowBox[{"PMCID", ":", " ", 
      RowBox[{"PMC7078677", "."}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Zeta]Act", "=", ".002"}], 
  RowBox[{"(*", 
   RowBox[{"m", "/", 
    RowBox[{"(", 
     RowBox[{"s", " ", "N"}], ")"}]}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Zeta]Cam", "=", ".002"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"friction", " ", "coefficient", " ", "for", " ", "cam"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Zeta]Arp", "=", ".002"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"friction", " ", "coefficient", " ", "for", " ", "arp"}], "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"step", "[", "L_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[Zeta]Act", ")"}], "/", "biomechanicalRate"}]}], "\n", 
 RowBox[{
  RowBox[{"stepCam", "[", "L_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[Zeta]Cam", ")"}], "/", "biomechanicalRate"}]}], "\n", 
 RowBox[{
  RowBox[{"stepArp", "[", "L_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[Zeta]Arp", ")"}], "/", 
   "biomechanicalRate"}]}], "\n"}], "Code",
 CellChangeTimes->{{3.9636657553797503`*^9, 3.963665777600051*^9}, {
   3.963665831275732*^9, 3.963665863625944*^9}, {3.9636659054334373`*^9, 
   3.963665983292473*^9}, {3.96366601608064*^9, 3.963666135822854*^9}, 
   3.963666682176839*^9, 3.963666993518272*^9, {3.963667218407881*^9, 
   3.963667226248499*^9}, {3.963667269832972*^9, 3.96366727467181*^9}, {
   3.963668316447494*^9, 3.9636683304124393`*^9}, {3.963668547132946*^9, 
   3.963668560642363*^9}, {3.9636761002775307`*^9, 3.963676102162801*^9}, {
   3.963687679693576*^9, 3.963687694938986*^9}, {3.96369054798127*^9, 
   3.963690571883073*^9}, {3.96401293085471*^9, 3.964012936406624*^9}, {
   3.964014637209696*^9, 3.9640146387136602`*^9}, {3.964015294348139*^9, 
   3.9640153028961897`*^9}, {3.9640154790639133`*^9, 3.964015481608531*^9}, {
   3.96401554225247*^9, 3.9640155479087753`*^9}, {3.964015737034123*^9, 
   3.964015740332139*^9}, {3.964015807218772*^9, 3.9640158085576477`*^9}, {
   3.9640159272102003`*^9, 3.964015932602613*^9}, {3.964018109611549*^9, 
   3.96401811454655*^9}, {3.964018190132484*^9, 3.964018211949581*^9}, {
   3.9640184276754436`*^9, 3.964018432262065*^9}, {3.9640208134176197`*^9, 
   3.9640208395990458`*^9}, {3.9640244968485727`*^9, 3.964024518522304*^9}, {
   3.964185606683086*^9, 3.96418561594243*^9}, {3.964226678015963*^9, 
   3.96422668277562*^9}, {3.964237180990385*^9, 3.9642371868705273`*^9}, {
   3.964237304709387*^9, 3.964237306626236*^9}, {3.964237694728106*^9, 
   3.964237713534287*^9}, {3.964237871214506*^9, 3.9642378763273773`*^9}, 
   3.964237925036415*^9, {3.964238019280856*^9, 3.964238062765502*^9}, {
   3.96423822795008*^9, 3.9642382405889387`*^9}, {3.964238329672933*^9, 
   3.964238333481813*^9}, {3.964242342852146*^9, 3.964242346015336*^9}, 
   3.964259238354857*^9, {3.9642947372401543`*^9, 3.964294747091913*^9}, {
   3.964412100659408*^9, 3.964412138164276*^9}, {3.964446771335868*^9, 
   3.96444677667187*^9}, {3.96444737938922*^9, 3.9644474091368437`*^9}, {
   3.964447526013234*^9, 3.96444752918626*^9}, {3.964447564076948*^9, 
   3.964447565827921*^9}, {3.9644476004907722`*^9, 3.964447605047662*^9}, {
   3.96444867594163*^9, 3.964448685853332*^9}, {3.964448814081977*^9, 
   3.9644488152710333`*^9}, {3.9644491099644737`*^9, 3.964449114062106*^9}, {
   3.9644496453551397`*^9, 3.96444964708322*^9}, {3.964450080631096*^9, 
   3.964450141640746*^9}, {3.9644504611971617`*^9, 3.9644504943968287`*^9}, {
   3.96445067567415*^9, 3.964450712284531*^9}, {3.964450828568425*^9, 
   3.9644509401838713`*^9}, {3.964451063166354*^9, 3.964451073429906*^9}, {
   3.964451105170989*^9, 3.964451131995902*^9}, {3.964451240034359*^9, 
   3.964451241792872*^9}, {3.964452310014785*^9, 3.964452325005728*^9}, {
   3.964456276889143*^9, 3.9644562795496893`*^9}, {3.964456796664708*^9, 
   3.964456804145144*^9}, {3.964462228412376*^9, 3.964462235130234*^9}, {
   3.9644968237218733`*^9, 3.964496827542737*^9}, {3.964496902806881*^9, 
   3.964496908451273*^9}, {3.964498379661661*^9, 3.9644983847346277`*^9}, {
   3.964499155429977*^9, 3.964499160480462*^9}, {3.9644991968266497`*^9, 
   3.964499224261179*^9}, {3.964499299746252*^9, 3.96449934129213*^9}, {
   3.964499437823728*^9, 3.9644994584071903`*^9}, {3.964499535195388*^9, 
   3.9644995454811087`*^9}, {3.964499728204747*^9, 3.9644997302723293`*^9}, {
   3.9644998455332108`*^9, 3.964499853124959*^9}, {3.964500284006853*^9, 
   3.964500286793127*^9}, {3.964500338457635*^9, 3.964500349655387*^9}, {
   3.964500511370973*^9, 3.9645005168029213`*^9}, {3.964500564779045*^9, 
   3.964500565310902*^9}, {3.964501307302487*^9, 3.964501313830871*^9}, {
   3.964514165136796*^9, 3.964514186021349*^9}, {3.964514403958602*^9, 
   3.964514411190674*^9}, {3.964514737464159*^9, 3.9645147495888033`*^9}, {
   3.9645318353529987`*^9, 3.964531853617004*^9}, {3.9645318886398*^9, 
   3.964531889945009*^9}, {3.964532485809725*^9, 3.964532508623393*^9}, {
   3.964533102815769*^9, 3.964533111029852*^9}, {3.96453317602256*^9, 
   3.964533179526936*^9}, {3.9645332324374037`*^9, 3.9645332379318333`*^9}, {
   3.9646524456066628`*^9, 3.964652445926415*^9}, {3.96465248780477*^9, 
   3.964652489463985*^9}, {3.964963103271624*^9, 3.964963105859888*^9}, {
   3.964963369725924*^9, 3.964963372901965*^9}, 3.965335270295312*^9, {
   3.965491759410293*^9, 3.965491772838285*^9}, {3.965491850453561*^9, 
   3.965491851148025*^9}, {3.965577258493206*^9, 3.965577275987411*^9}, {
   3.9658253157457447`*^9, 3.965825346716207*^9}, {3.965825449023411*^9, 
   3.965825464168418*^9}, {3.966077686583313*^9, 3.966077705537951*^9}, {
   3.966077782469638*^9, 3.966077788698989*^9}, {3.9663181706357517`*^9, 
   3.9663182109603567`*^9}, {3.96631826789404*^9, 3.966318284426504*^9}, 
   3.967651507203554*^9, 3.9676522722453413`*^9, {3.969184461823839*^9, 
   3.969184462352737*^9}, {3.9701483449667892`*^9, 3.970148356115315*^9}, {
   3.970148519848871*^9, 3.970148540441946*^9}, {3.970148639651925*^9, 
   3.970148644095442*^9}, {3.970149344055855*^9, 3.970149349908636*^9}, {
   3.970149393052997*^9, 3.970149397160995*^9}, {3.970152239651829*^9, 
   3.9701522442033367`*^9}, {3.970159153638845*^9, 3.970159155895212*^9}, {
   3.9701592003394203`*^9, 3.970159204802586*^9}, {3.9701592480102863`*^9, 
   3.97015925074972*^9}, {3.9701593513083963`*^9, 3.9701593958824663`*^9}, {
   3.970159628760396*^9, 3.970159648294471*^9}, {3.9701603145426083`*^9, 
   3.970160358107291*^9}, {3.970160424386982*^9, 3.9701604463018103`*^9}, 
   3.9701604867771*^9, {3.970160759847068*^9, 3.970160764038784*^9}, {
   3.9720892244341183`*^9, 3.972089282240103*^9}, {3.972089318398139*^9, 
   3.972089321891388*^9}, {3.9720894380670137`*^9, 3.972089442170621*^9}, {
   3.972089506057089*^9, 3.972089508811322*^9}, {3.972090599319601*^9, 
   3.972090599408798*^9}, {3.972091481554048*^9, 3.9720914869717407`*^9}, {
   3.972291794309732*^9, 3.972291811711772*^9}, {3.972291841935615*^9, 
   3.972291895106628*^9}, {3.972292640247398*^9, 3.972292643861898*^9}, {
   3.972292878846952*^9, 3.972292888746222*^9}, {3.972370372455674*^9, 
   3.972370400019305*^9}, {3.9723704943553343`*^9, 3.9723704967686377`*^9}, {
   3.972370699494873*^9, 3.972370704810548*^9}, {3.9723800297668753`*^9, 
   3.972380032077915*^9}, {3.972506066085249*^9, 3.972506067539853*^9}, {
   3.972506484356216*^9, 3.972506561790457*^9}, {3.972519553753744*^9, 
   3.972519555223913*^9}, {3.972519598388465*^9, 3.972519600502137*^9}, {
   3.972665426171673*^9, 3.972665427907065*^9}, {3.972675523167458*^9, 
   3.972675524192705*^9}, {3.972760522516036*^9, 3.972760524117476*^9}, {
   3.972783173407248*^9, 3.972783175671144*^9}, {3.972935160591886*^9, 
   3.9729352028075314`*^9}, {3.972935307426365*^9, 3.972935311474003*^9}, {
   3.972936295326489*^9, 3.972936296844792*^9}, {3.972936375832028*^9, 
   3.972936380097212*^9}, {3.972938186229711*^9, 3.9729382198786907`*^9}, {
   3.972938345406126*^9, 3.972938346569573*^9}, {3.972942819752334*^9, 
   3.97294282267488*^9}, {3.972943865431532*^9, 3.972943868477446*^9}, {
   3.9729439239381866`*^9, 3.972943942281239*^9}, {3.972943994407703*^9, 
   3.972943994484366*^9}, {3.972944235006521*^9, 3.972944239209962*^9}, {
   3.9729442799975157`*^9, 3.972944296628724*^9}, {3.972944357813265*^9, 
   3.972944388898925*^9}, {3.972944800863914*^9, 3.972944977449238*^9}, {
   3.972945082221237*^9, 3.97294508299461*^9}, {3.9729451805187073`*^9, 
   3.972945243580616*^9}, {3.972945390983436*^9, 3.972945394809111*^9}, {
   3.9729463177132587`*^9, 3.972946320086231*^9}, {3.972946364912797*^9, 
   3.972946395553055*^9}, {3.97294668514406*^9, 3.97294669020331*^9}, {
   3.97294712632452*^9, 3.9729471286920233`*^9}, {3.972947189937882*^9, 
   3.972947202062325*^9}, {3.97294728252407*^9, 3.972947294366248*^9}, {
   3.972947330055525*^9, 3.9729473437947083`*^9}, {3.9729474350522623`*^9, 
   3.972947436875454*^9}, {3.9729474814371853`*^9, 3.972947497341461*^9}, {
   3.9729476659524517`*^9, 3.972947670178751*^9}, {3.972950848266389*^9, 
   3.972950852007042*^9}, {3.972952905889934*^9, 3.972952910395352*^9}, {
   3.9729536853242807`*^9, 3.972953696140235*^9}, {3.9729538766908817`*^9, 
   3.9729538816161547`*^9}, {3.972954808568824*^9, 3.972954885744866*^9}, {
   3.9729551288843737`*^9, 3.9729551351874037`*^9}, {3.972956049151308*^9, 
   3.972956062187278*^9}, {3.9729568794436407`*^9, 3.972956880805006*^9}, {
   3.972979654857987*^9, 3.972979663841825*^9}, {3.9729801665874367`*^9, 
   3.9729801708344088`*^9}, {3.9730008012059298`*^9, 3.97300080323645*^9}, {
   3.973005304557994*^9, 3.973005327402816*^9}, {3.973012093006196*^9, 
   3.9730121013994083`*^9}, {3.973055041527899*^9, 3.9730550417179327`*^9}, {
   3.973055701071165*^9, 3.9730557039088306`*^9}, {3.973055750751553*^9, 
   3.97305579487658*^9}, {3.973077254922665*^9, 3.973077256664606*^9}, {
   3.973100379386105*^9, 3.973100385487*^9}, {3.973100723927658*^9, 
   3.9731007273017282`*^9}, {3.973102937378313*^9, 3.973102964628124*^9}, {
   3.973104578796981*^9, 3.973104587533286*^9}, {3.9731049066036882`*^9, 
   3.973104911240649*^9}, {3.973187709458282*^9, 3.973187711634946*^9}, {
   3.973187905226901*^9, 3.973187906936401*^9}, {3.973187952824136*^9, 
   3.973187956680318*^9}, {3.973194703185903*^9, 3.973194706410404*^9}, {
   3.9732595486505833`*^9, 3.973259550279809*^9}, {3.974697828707842*^9, 
   3.974697856249354*^9}, {3.974727515885756*^9, 3.9747275223747807`*^9}, {
   3.9755166469582253`*^9, 3.9755166507159023`*^9}, {3.9755170423056307`*^9, 
   3.975517045715323*^9}, {3.976559727104382*^9, 3.9765597329563723`*^9}, {
   3.9766910340185003`*^9, 3.9766910408328733`*^9}, {3.97725452390003*^9, 
   3.977254531496543*^9}, {3.977254793889146*^9, 3.977254798799572*^9}, {
   3.9772549954728823`*^9, 3.977254996877245*^9}, {3.9772550567898417`*^9, 
   3.977255057952732*^9}, {3.977256332825808*^9, 3.977256338950219*^9}, {
   3.9772563878597937`*^9, 3.977256394090845*^9}, {3.97763420875415*^9, 
   3.97763421161754*^9}, {3.978059801514248*^9, 
   3.978059803126828*^9}},ExpressionUUID->"2f6988a2-23a6-43b6-a0a1-\
b724894b1d10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"speciesToMol", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "avogadros"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1000.", "*", 
       RowBox[{"4", "/", "3"}], "*", "Pi", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"area", "/", "Pi"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"*", "KINETICS", " ", "OF", " ", "POLYMERIZATION"}], "**)"}], "\n",
   "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Selden", " ", "LA"}], ",", 
    RowBox[{"Kinosian", " ", "HJ"}], ",", 
    RowBox[{"Estes", " ", "JE"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Gershman", " ", 
       RowBox[{"LC", ".", "Impact"}], " ", "of", " ", "profilin", " ", "on", " ",
        "actin"}], "-", 
      RowBox[{
      "bound", " ", "nucleotide", " ", "exchange", " ", "and", " ", "actin", " ",
        "polymerization", " ", 
       RowBox[{"dynamics", ".", "Biochemistry"}], ".1999", " ", "Mar", " ", 
       "2"}]}], ";", 
     RowBox[{
      RowBox[{"38", 
       RowBox[{"(", "9", ")"}]}], ":", 
      RowBox[{"2769", "-", 
       RowBox[{"78.", " ", "doi"}]}], ":", 
      RowBox[{"10.1021", "/", 
       RowBox[{"bi981543c", ".", 
        RowBox[{"PMID", ":", "10052948."}]}]}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"actinATPDissociation", "=", "0.08"}], 
  RowBox[{"(*", 
   RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"actinNucPhos", "=", "1.4"}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Pollard", " ", 
      RowBox[{"TD", ".", "Rate"}], " ", "constants", " ", "for", " ", "the", " ",
       "reactions", " ", "of", " ", "ATP"}], "-", 
     RowBox[{"and", " ", "ADP"}], "-", 
     RowBox[{
     "actin", " ", "with", " ", "the", " ", "ends", " ", "of", " ", "actin", " ", 
      RowBox[{"filaments", ".", "J"}], " ", "Cell", " ", "Biol", ".1986", " ",
       "Dec"}]}], ";", 
    RowBox[{
     RowBox[{"103", 
      RowBox[{"(", 
       RowBox[{"6", " ", "Pt", " ", "2"}], ")"}]}], ":", 
     RowBox[{"2747", "-", 
      RowBox[{"54.", " ", "doi"}]}], ":", 
     RowBox[{
      RowBox[{"10.1083", "/", "jcb"}], ".103", ".6", 
      RowBox[{".2747", ".", 
       RowBox[{"PMID", ":", "3793756"}]}]}]}], ";", 
    RowBox[{"PMCID", ":", 
     RowBox[{"PMC2114620", "."}]}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"kPlusBarbedT", "=", 
   RowBox[{"11.6", " ", 
    RowBox[{"10", "^", "6"}], " ", 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"kMinusBarbedT", "=", "1.4"}], 
  RowBox[{"(*", 
   RowBox[{"1", "/", 
    RowBox[{"(", "s", ")"}]}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kPlusPointedT", "=", 
   RowBox[{"1.3", " ", 
    RowBox[{"10", "^", "6"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"kMinusPointedT", "=", "0.8"}], 
  RowBox[{"(*", 
   RowBox[{"1", "/", 
    RowBox[{"(", "s", ")"}]}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kPlusBarbedD", "=", 
   RowBox[{"3.8", " ", 
    RowBox[{"10", "^", "6"}], " ", 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"kMinusBarbedD", "=", "7.2"}], 
  RowBox[{"(*", 
   RowBox[{"1", "/", 
    RowBox[{"(", "s", ")"}]}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kPlusPointedD", "=", 
   RowBox[{"0.16", " ", 
    RowBox[{"10", "^", "6"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kMinusPointedD", "=", "0.27"}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", 
     RowBox[{"(", "s", ")"}]}], "*)"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"*", "KINETICS", " ", "OF", " ", "ACTIN", " ", "NETWORKS"}], 
   "**)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Smith", " ", "BA"}], ",", 
    RowBox[{"Daugherty", "-", 
     RowBox[{"Clarke", " ", "K"}]}], ",", 
    RowBox[{"Goode", " ", "BL"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Gelles", " ", 
       RowBox[{"J", ".", "Pathway"}], " ", "of", " ", "actin", " ", 
       "filament", " ", "branch", " ", "formation", " ", "by", " ", 
       RowBox[{"Arp2", "/", "3"}], " ", "complex", " ", "revealed", " ", "by",
        " ", "single"}], "-", 
      RowBox[{"molecule", " ", 
       RowBox[{"imaging", ".", "Proc"}], " ", "Natl", " ", "Acad", " ", "Sci",
        " ", "U", " ", "S", " ", "A", ".2013", " ", "Jan", " ", "22"}]}], ";", 
     RowBox[{
      RowBox[{"110", 
       RowBox[{"(", "4", ")"}]}], ":", 
      RowBox[{"1285", "-", 
       RowBox[{"90.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1073", "/", "pnas"}], 
       RowBox[{".1211164110", ".", "Epub"}], " ", "2013", " ", "Jan", " ", 
       "4.", " ", 
       RowBox[{"PMID", ":", "23292935"}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC3557048", "."}]}]}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"kbranch", "=", 
   RowBox[{"3000.", 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"kminus2", "=", "0.47"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fractionArpUnbound", "=", "0.176"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Hayakawa", " ", "K"}], ",", 
    RowBox[{"Sekiguchi", " ", "C"}], ",", 
    RowBox[{"Sokabe", " ", "M"}], ",", 
    RowBox[{"Ono", " ", "S"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Tatsumi", " ", 
       RowBox[{"H", ".", "Real"}]}], "-", 
      RowBox[{"Time", " ", "Single"}], "-", 
      RowBox[{
      "Molecule", " ", "Kinetic", " ", "Analyses", " ", "of", " ", "AIP1"}], "-", 
      RowBox[{
      "Enhanced", " ", "Actin", " ", "Filament", " ", "Severing", " ", "in", " ",
        "the", " ", "Presence", " ", "of", " ", 
       RowBox[{"Cofilin", ".", "J"}], " ", "Mol", " ", "Biol", ".2019", " ", 
       "Jan", " ", "18"}]}], ";", 
     RowBox[{
      RowBox[{"431", 
       RowBox[{"(", "2", ")"}]}], ":", 
      RowBox[{"308", "-", 
       RowBox[{"322.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1016", "/", 
        RowBox[{"j", ".", "jmb"}]}], ".2018", ".11", 
       RowBox[{".010", ".", "Epub"}], " ", "2018", " ", "Nov", " ", "12.", " ", 
       RowBox[{"PMID", ":", "30439520"}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC6507414", "."}]}]}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"kaip1on", "=", 
   RowBox[{"112", "*", 
    RowBox[{"10", "^", "6"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"KdCap", "=", 
   RowBox[{"23.4", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], 
  RowBox[{"(*", "M", "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kaip1off", "=", 
   RowBox[{"KdCap", "*", 
    RowBox[{"kaip1on", 
     RowBox[{"(*", 
      RowBox[{"1", "/", "s"}], "*)"}], "/", "speciesToMol"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cappingFreeFraction", "=", "0.96"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Wear", " ", "MA"}], ",", " ", 
    RowBox[{"Yamashita", " ", "A"}], ",", " ", 
    RowBox[{"Kim", " ", "K"}], ",", " ", 
    RowBox[{"Ma\[EAcute]da", " ", "Y"}], ",", " ", 
    RowBox[{
     RowBox[{"Cooper", " ", 
      RowBox[{"JA", ".", " ", "How"}], " ", "capping", " ", "protein", " ", 
      "binds", " ", "the", " ", "barbed", " ", "end", " ", "of", " ", "the", " ",
       "actin", " ", 
      RowBox[{"filament", ".", " ", "Curr"}], " ", 
      RowBox[{"Biol", ".", " ", "2003"}], " ", "Sep", " ", "2"}], ";", 
     RowBox[{
      RowBox[{"13", 
       RowBox[{"(", "17", ")"}]}], ":", 
      RowBox[{"1531", "-", 
       RowBox[{"7.", " ", "doi"}]}], ":", " ", 
      RowBox[{
       RowBox[{"10.1016", "/", "s0960"}], "-", 
       RowBox[{"9822", 
        RowBox[{"(", "03", ")"}], "00559"}], "-", 
       RowBox[{"1.", " ", 
        RowBox[{"PMID", ":", " ", "12956956."}]}]}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kcapon", "=", 
    RowBox[{"6.3", "*", 
     SuperscriptBox["10", "6"]}]}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Wioland", " ", "H"}], ",", 
    RowBox[{"Guichard", " ", "B"}], ",", 
    RowBox[{"Senju", " ", "Y"}], ",", 
    RowBox[{"Myram", " ", "S"}], ",", 
    RowBox[{"Lappalainen", " ", "P"}], ",", 
    RowBox[{"J\[EAcute]gou", " ", "A"}], ",", 
    RowBox[{
     RowBox[{"Romet", "-", 
      RowBox[{"Lemonne", " ", 
       RowBox[{
        RowBox[{"G", ".", "ADF"}], "/", "Cofilin"}], " ", "Accelerates", " ", 
       "Actin", " ", "Dynamics", " ", "by", " ", "Severing", " ", "Filaments",
        " ", "and", " ", "Promoting", " ", "Their", " ", "Depolymerization", " ",
        "at", " ", "Both", " ", 
       RowBox[{"Ends", ".", "Curr"}], " ", "Biol", ".2017", " ", "Jul", " ", 
       "10"}]}], ";", 
     RowBox[{
      RowBox[{"27", 
       RowBox[{"(", "13", ")"}]}], ":", 
      RowBox[{"1956", "-", 
       RowBox[{"1967.", 
        RowBox[{"e7", ".", "doi"}]}]}], ":", 
      RowBox[{
       RowBox[{"10.1016", "/", 
        RowBox[{"j", ".", "cub"}]}], ".2017", ".05", 
       RowBox[{".048", ".", "Epub"}], " ", "2017", " ", "Jun", " ", "15.", " ", 
       RowBox[{"PMID", ":", "28625781"}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC5505867", "."}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"kcofcapoff", "=", 
   RowBox[{"3", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kcofcapon", "=", 
    RowBox[{"0.3", "*", 
     RowBox[{"10", "^", "6"}], 
     RowBox[{"(*", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Khan", " ", "S"}], ",", 
    RowBox[{"Conte", " ", "I"}], ",", 
    RowBox[{"Carter", " ", "T"}], ",", 
    RowBox[{"Bayer", " ", "KU"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Molloy", " ", 
       RowBox[{"JE", ".", "Multiple"}], " ", "CaMKII", " ", "Binding", " ", 
       "Modes", " ", "to", " ", "the", " ", "Actin", " ", "Cytoskeleton", " ",
        "Revealed", " ", "by", " ", "Single"}], "-", 
      RowBox[{"Molecule", " ", 
       RowBox[{"Imaging", ".", "Biophys"}], " ", "J", ".2016", " ", "Jul", " ",
        "26"}]}], ";", 
     RowBox[{
      RowBox[{"111", 
       RowBox[{"(", "2", ")"}]}], ":", 
      RowBox[{"395", "-", 
       RowBox[{"408.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1016", "/", 
        RowBox[{"j", ".", "bpj"}]}], ".2016", ".06", 
       RowBox[{".007", ".", 
        RowBox[{"PMID", ":", "27463141"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC4968397", "."}]}]}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"koffcamKII\[Beta]", "=", "0.23"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"koncamKII\[Beta]", "=", 
    RowBox[{"0.5", "*", 
     RowBox[{"10", "^", "6"}], " ", 
     RowBox[{"(*", 
      RowBox[{"1", " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Koskinen", " ", "M"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Hotulainen", " ", 
       RowBox[{"P", ".", "Measuring"}], " ", "F"}], "-", 
      RowBox[{"actin", " ", "properties", " ", "in", " ", "dendritic", " ", 
       RowBox[{"spines", ".", "Front"}], " ", "Neuroanat", ".2014"}]}], ";", 
     RowBox[{"8", ":", 
      RowBox[{
      "74.", " ", "Published", " ", "2014", " ", "Aug", " ", "5.", " ", 
       "doi"}], ":", 
      RowBox[{
       RowBox[{"10.3389", "/", "fnana"}], ".2014", ".00074"}]}]}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monomericFraction", "=", "0.12"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Bamburg", " ", "JR"}], ",", 
    RowBox[{"Minamide", " ", "LS"}], ",", 
    RowBox[{"Wiggan", " ", "O"}], ",", 
    RowBox[{"Tahtamouni", " ", "LH"}], ",", 
    RowBox[{
     RowBox[{"Kuhn", " ", 
      RowBox[{"TB", ".", "Cofilin"}], " ", "and", " ", "Actin", " ", 
      RowBox[{"Dynamics", ":", 
       RowBox[{
       "Multiple", " ", "Modes", " ", "of", " ", "Regulation", " ", "and", " ",
         "Their", " ", "Impacts", " ", "in", " ", "Neuronal", " ", 
        "Development", " ", "and", " ", 
        RowBox[{"Degeneration", ".", "Cells"}], ".2021", " ", "Oct", " ", 
        "12"}]}]}], ";", 
     RowBox[{
      RowBox[{"10", 
       RowBox[{"(", "10", ")"}]}], ":", 
      RowBox[{"2726.", " ", "doi"}], ":", 
      RowBox[{"10.3390", "/", 
       RowBox[{"cells10102726", ".", 
        RowBox[{"PMID", ":", "34685706"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC8534876", "."}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cofilinFreeFraction", "=", "0.175"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", "SYNTHESIS", " ", "AND", " ", "DEGRADATION", " ", "OF", " ", 
    "MOLECULES"}], "**)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Biesemann", " ", "C"}], ",", 
    RowBox[{"Gr\[OSlash]nborg", " ", "M"}], ",", 
    RowBox[{"Luquet", " ", "E"}], ",", 
    RowBox[{"Wichert", " ", "SP"}], ",", 
    RowBox[{"Bernard", " ", "V"}], ",", 
    RowBox[{"Bungers", " ", "SR"}], ",", 
    RowBox[{"Cooper", " ", "B"}], ",", 
    RowBox[{"Varoqueaux", " ", "F"}], ",", 
    RowBox[{"Li", " ", "L"}], ",", 
    RowBox[{"Byrne", " ", "JA"}], ",", 
    RowBox[{"Urlaub", " ", "H"}], ",", 
    RowBox[{"Jahn", " ", "O"}], ",", 
    RowBox[{"Brose", " ", "N"}], ",", 
    RowBox[{
     RowBox[{"Herzog", " ", 
      RowBox[{"E", ".", "Proteomic"}], " ", "screening", " ", "of", " ", 
      "glutamatergic", " ", "mouse", " ", "brain", " ", "synaptosomes", " ", 
      "isolated", " ", "by", " ", "fluorescence", " ", "activated", " ", 
      RowBox[{"sorting", ".", "EMBO"}], " ", "J", ".2014", " ", "Jan", " ", 
      "13"}], ";", 
     RowBox[{
      RowBox[{"33", 
       RowBox[{"(", "2", ")"}]}], ":", 
      RowBox[{"157", "-", 
       RowBox[{"70.", " ", "doi"}]}], ":", 
      RowBox[{
       RowBox[{"10.1002", "/", "embj"}], 
       RowBox[{".201386120", ".", "Epub"}], " ", "2014", " ", "Jan", " ", 
       "10.", " ", 
       RowBox[{"PMID", ":", "24413018"}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC3989609", "."}]}]}]}], "*)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Sialana", " ", "FJ"}], ",", 
    RowBox[{"Wang", " ", "AL"}], ",", 
    RowBox[{"Fazari", " ", "B"}], ",", 
    RowBox[{"Kristofova", " ", "M"}], ",", 
    RowBox[{"Smidak", " ", "R"}], ",", 
    RowBox[{"Trossbach", " ", "SV"}], ",", 
    RowBox[{"Korth", " ", "C"}], ",", 
    RowBox[{"Huston", " ", "JP"}], ",", 
    RowBox[{"de", " ", "Souza", " ", "Silva", " ", "MA"}], ",", 
    RowBox[{
     RowBox[{"Lubec", " ", 
      RowBox[{"G", ".", "Quantitative"}], " ", "Proteomics", " ", "of", " ", 
      "Synaptosomal", " ", "Fractions", " ", "in", " ", "a", " ", "Rat", " ", 
      "Overexpressing", " ", "Human", " ", "DISC1", " ", "Gene", " ", 
      "Indicates", " ", "Profound", " ", "Synaptic", " ", "Dysregulation", " ",
       "in", " ", "the", " ", "Dorsal", " ", 
      RowBox[{"Striatum", ".", "Front"}], " ", "Mol", " ", "Neurosci", 
      ".2018", " ", "Feb", " ", "6"}], ";", 
     RowBox[{"11", ":", 
      RowBox[{"26.", " ", "doi"}], ":", 
      RowBox[{
       RowBox[{"10.3389", "/", "fnmol"}], ".2018", 
       RowBox[{".00026", ".", 
        RowBox[{"PMID", ":", "29467617"}]}]}]}], ";", 
     RowBox[{"PMCID", ":", 
      RowBox[{"PMC5808171", "."}]}]}], ",", " ", 
    RowBox[{"Bonilla", "-", 
     RowBox[{"Quintana", " ", "M"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Rangamani", " ", 
      RowBox[{"P", ".", " ", "Biophysical"}], " ", "modeling", " ", "of", " ",
       "actin"}], "-", 
     RowBox[{
     "mediated", " ", "structural", " ", "plasticity", " ", "reveals", " ", 
      "mechanical", " ", "adaptation", " ", "in", " ", "dendritic", " ", 
      RowBox[{"spines", ".", " ", "2022"}], " ", "Nov", " ", "15.", " ", 
      RowBox[{"doi", ":", " ", 
       RowBox[{
        RowBox[{"10.1101", "/", "2022.11"}], ".06", 
        RowBox[{".515372", "."}]}]}]}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"actinDegRate", "=", 
    RowBox[{"15.26284774697534`", "/", "60."}]}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"type", "===", "STUB"}], ",", "\n", 
     RowBox[{"(*", "STUBBY", "*)"}], "\n", 
     RowBox[{
      RowBox[{"actinInfluxRate", "=", 
       RowBox[{
        RowBox[{"0.0011703842034711713`", "/", "60."}], "/", 
        "speciesToMol"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinBasalRate", "=", 
       RowBox[{
        RowBox[{"0.0011285162891759275`", "/", "60."}], "/", 
        "speciesToMol"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinSynthRate", "=", 
       RowBox[{"(", 
        RowBox[{"actinBasalRate", "+", "actinInfluxRate"}], ")"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinDegRate", "=", 
       RowBox[{"5.732133029296448`", "/", "60."}]}], 
      RowBox[{"(*", 
       RowBox[{"1", "/", "s"}], "*)"}], ";"}], ",", "\n", "\n", 
     RowBox[{"(*", "MUSHROOM", "*)"}], "\n", 
     RowBox[{
      RowBox[{"actinBasalRate", "=", 
       RowBox[{
        RowBox[{"0.0019283704258071265`", "/", "60."}], "/", 
        "speciesToMol"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinInfluxRate", "=", 
       RowBox[{
        RowBox[{"0.0019996479973183085`", "/", "60."}], "/", 
        "speciesToMol"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinSynthRate", "=", 
       RowBox[{"(", 
        RowBox[{"actinBasalRate", "+", "actinInfluxRate"}], ")"}]}], 
      RowBox[{"(*", 
       RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
      RowBox[{"actinDegRate", "=", 
       RowBox[{"5.733176798118083`", "/", "60."}]}], 
      RowBox[{"(*", 
       RowBox[{"1", "/", "s"}], "*)"}], ";"}]}], "\n", "]"}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"arpBasalRate", "=", 
   RowBox[{
    RowBox[{"0.00015589619003090606`", "/", "60."}], "/", "speciesToMol"}]}], 
  
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"arpInfluxRate", "=", 
   RowBox[{
    RowBox[{"0.000024424544184661355`", "/", "60."}], "/", "speciesToMol"}]}], 
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"arpSynthRate", "=", 
   RowBox[{"(", 
    RowBox[{"arpBasalRate", "+", "arpInfluxRate"}], ")"}]}], 
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arpDegRate", "=", 
    RowBox[{"3.18424`", "/", "60"}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"cofilinBasalRate", "=", 
   RowBox[{
    RowBox[{"0.00002830668121874591`", "/", "60."}], "/", "speciesToMol"}]}], 
  
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cofilinInfluxRate", "=", 
   RowBox[{
    RowBox[{"0.000046645851434562996`", "/", "60"}], "/", "speciesToMol"}]}], 
  
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cofilinSynthRate", "=", 
   RowBox[{"(", 
    RowBox[{"cofilinBasalRate", "+", "cofilinInfluxRate"}], ")"}]}], 
  RowBox[{"(*", 
   RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cofilinDegRate", "=", 
    RowBox[{"3.3940933558614113`", "/", "60"}]}], 
   RowBox[{"(*", 
    RowBox[{"1", "/", "s"}], "*)"}], ";"}], " "}]}], "Code",
 CellChangeTimes->{{3.9636869836082687`*^9, 3.9636869929534883`*^9}, {
   3.963687179277186*^9, 3.963687198223472*^9}, {3.964023755059618*^9, 
   3.96402375682413*^9}, {3.9640364747561893`*^9, 3.9640364749027843`*^9}, 
   3.9654128996260843`*^9, {3.966238272758634*^9, 3.9662382762540894`*^9}, 
   3.966318111619172*^9, {3.966318146820994*^9, 3.966318147452073*^9}, {
   3.967873982889173*^9, 3.967873987076833*^9}, {3.967874032916152*^9, 
   3.96787403575203*^9}, {3.9678740875402927`*^9, 3.967874091088235*^9}, 
   3.96822191896601*^9, {3.968222007509015*^9, 3.968222008045857*^9}, {
   3.968222038981028*^9, 3.968222065475088*^9}, 3.9682401552187157`*^9, {
   3.968240193821838*^9, 3.968240199210116*^9}, 3.968255244249721*^9, 
   3.968255275754525*^9, {3.968255392298162*^9, 3.968255435048951*^9}, {
   3.96895672692247*^9, 3.968956730028027*^9}, {3.969729982220476*^9, 
   3.969729987325335*^9}, {3.969730040421473*^9, 3.969730055668646*^9}, {
   3.9697301632154827`*^9, 3.9697302156248493`*^9}, 3.9698119650665092`*^9, {
   3.969812434488926*^9, 3.9698124351021633`*^9}, {3.969813061113957*^9, 
   3.969813077709515*^9}, {3.970147274479382*^9, 3.970147429179442*^9}, {
   3.970147493694878*^9, 3.9701474986173143`*^9}, {3.970147568410583*^9, 
   3.970147574368823*^9}, {3.970147775392663*^9, 3.970147831174361*^9}, {
   3.9701478759405212`*^9, 3.970147993531212*^9}, {3.9701543566828337`*^9, 
   3.9701543637585583`*^9}, {3.970154917446186*^9, 3.9701549182260923`*^9}, {
   3.970156479048071*^9, 3.970156481088129*^9}, {3.970162805166946*^9, 
   3.970162806252481*^9}, {3.97016288644101*^9, 3.970162887691287*^9}, {
   3.9701637408896646`*^9, 3.970163743018005*^9}, {3.970164099484147*^9, 
   3.9701641008725224`*^9}, {3.970231933837826*^9, 3.970231935654626*^9}, {
   3.9702335276518908`*^9, 3.970233529103507*^9}, {3.970234447748992*^9, 
   3.970234450066187*^9}, {3.970234565150812*^9, 3.97023457521723*^9}, {
   3.970236261088336*^9, 3.970236271166278*^9}, {3.970291630710657*^9, 
   3.9702916370426683`*^9}, {3.970382368341761*^9, 3.970382428687212*^9}, 
   3.972088019662331*^9, {3.972370342823147*^9, 3.9723703433066597`*^9}, {
   3.97293816786028*^9, 3.972938174732255*^9}, {3.973885132391453*^9, 
   3.9738851326680737`*^9}, {3.9769857983749847`*^9, 3.976985820991219*^9}, {
   3.977188574921379*^9, 3.977188576026702*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c813d8f2-37d3-4038-a767-7e0ba959282c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"McCullough", " ", "BR"}], ",", " ", 
    RowBox[{"Grintsevich", " ", "EE"}], ",", " ", 
    RowBox[{"Chen", " ", "CK"}], ",", " ", 
    RowBox[{"Kang", " ", "H"}], ",", " ", 
    RowBox[{"Hutchison", " ", "AL"}], ",", " ", 
    RowBox[{"Henn", " ", "A"}], ",", " ", 
    RowBox[{"Cao", " ", "W"}], ",", " ", 
    RowBox[{"Suarez", " ", "C"}], ",", " ", 
    RowBox[{"Martiel", " ", "JL"}], ",", " ", 
    RowBox[{"Blanchoin", " ", "L"}], ",", " ", 
    RowBox[{"Reisler", " ", "E"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"De", " ", "La", " ", "Cruz", " ", 
       RowBox[{"EM", ".", " ", "Cofilin"}]}], "-", 
      RowBox[{
      "linked", " ", "changes", " ", "in", " ", "actin", " ", "filament", " ",
        "flexibility", " ", "promote", " ", 
       RowBox[{"severing", ".", " ", "Biophys"}], " ", 
       RowBox[{"J", ".", " ", "2011"}], " ", "Jul", " ", "6"}]}], ";", 
     RowBox[{
      RowBox[{"101", 
       RowBox[{"(", "1", ")"}]}], ":", 
      RowBox[{"151", "-", 
       RowBox[{"9.", " ", "doi"}]}], ":", " ", 
      RowBox[{
       RowBox[{"10.1016", "/", 
        RowBox[{"j", ".", "bpj"}]}], ".2011", ".05", 
       RowBox[{".049", ".", " ", 
        RowBox[{"PMID", ":", " ", "21723825"}]}]}]}], ";", " ", 
     RowBox[{"PMCID", ":", " ", 
      RowBox[{"PMC3127193", "."}]}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"bareAngle", "=", 
     RowBox[{"57", "Degree"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cofAngle", "=", 
     RowBox[{"73", "Degree"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"boundaryAngle", "=", 
     RowBox[{"31", "Degree"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Okamoto", " ", "K"}], ",", 
     RowBox[{"Narayanan", " ", "R"}], ",", 
     RowBox[{"Lee", " ", "SH"}], ",", 
     RowBox[{"Murata", " ", "K"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Hayashi", " ", 
        RowBox[{"Y", ".", "The"}], " ", "role", " ", "of", " ", "CaMKII", " ",
         "as", " ", "an", " ", "F"}], "-", "actin", "-", 
       RowBox[{
       "bundling", " ", "protein", " ", "crucial", " ", "for", " ", 
        "maintenance", " ", "of", " ", "dendritic", " ", "spine", " ", 
        RowBox[{"structure", ".", "Proc"}], " ", "Natl", " ", "Acad", " ", 
        "Sci", " ", "U", " ", "S", " ", "A", ".2007", " ", "Apr", " ", 
        "10"}]}], ";", 
      RowBox[{
       RowBox[{"104", 
        RowBox[{"(", "15", ")"}]}], ":", 
       RowBox[{"6418", "-", 
        RowBox[{"23.", " ", "doi"}]}], ":", 
       RowBox[{
        RowBox[{"10.1073", "/", "pnas"}], 
        RowBox[{".0701656104", ".", "Epub"}], " ", "2007", " ", "Apr", " ", 
        "2.", " ", 
        RowBox[{"PMID", ":", "17404223"}]}]}], ";", 
      RowBox[{"PMCID", ":", 
       RowBox[{"PMC1851051", "."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"type", "===", "STUB"}], ",", "\n", 
      RowBox[{"(*", "STUBBY", "*)"}], "\n", 
      RowBox[{
       RowBox[{"camBasalRate", "=", 
        RowBox[{
         RowBox[{"0.0002571539361020251`", "/", "60."}], "/", 
         "speciesToMol"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camInfluxRate", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.00011758888249729743`"}], "/", "60."}], "/", 
         "speciesToMol"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camSynthRate", "=", 
        RowBox[{"(", 
         RowBox[{"camBasalRate", "+", "camInfluxRate"}], ")"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camDegRate", "=", 
        RowBox[{"3.135", "/", "60."}]}], 
       RowBox[{"(*", 
        RowBox[{"1", "/", "s"}], "*)"}], ";"}], ",", "\n", 
      RowBox[{"(*", "MUSHROOM", "*)"}], "\n", 
      RowBox[{
       RowBox[{"camBasalRate", "=", 
        RowBox[{
         RowBox[{"0.00020959506396347924`", "/", "60."}], "/", 
         "speciesToMol"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camInfluxRate", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.0000936814091196312`"}], "/", "60."}], "/", 
         "speciesToMol"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camSynthRate", "=", 
        RowBox[{"(", 
         RowBox[{"camBasalRate", "+", "camInfluxRate"}], ")"}]}], 
       RowBox[{"(*", 
        RowBox[{"species", "/", "s"}], "*)"}], ";", "\n", 
       RowBox[{"camDegRate", "=", 
        RowBox[{"3.108", "/", "60."}]}], 
       RowBox[{"(*", 
        RowBox[{"1", "/", "s"}], "*)"}], ";"}]}], " ", "\n", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"freeCamFraction", "=", "0.34"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"aip1BasalRate", "=", 
     RowBox[{
      RowBox[{"1.6550783633022047`*^-7", "/", "60."}], "/", 
      "speciesToMol"}]}], 
    RowBox[{"(*", 
     RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aip1InfluxRate", "=", 
     RowBox[{
      RowBox[{"3.250619866587586`*^-6", "/", "60."}], "/", "speciesToMol"}]}], 
    RowBox[{"(*", 
     RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aip1SynthRate", "=", 
     RowBox[{"(", 
      RowBox[{"aip1BasalRate", "+", "aip1InfluxRate"}], ")"}]}], 
    RowBox[{"(*", 
     RowBox[{"species", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aip1DegRate", "=", 
     RowBox[{"0.5511683011308086`", "/", "60."}]}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Roland", " ", "J"}], ",", 
     RowBox[{"Berro", " ", "J"}], ",", 
     RowBox[{"Michelot", " ", "A"}], ",", 
     RowBox[{"Blanchoin", " ", "L"}], ",", 
     RowBox[{
      RowBox[{"Martiel", " ", 
       RowBox[{"JL", ".", "Stochastic"}], " ", "severing", " ", "of", " ", 
       "actin", " ", "filaments", " ", "by", " ", "actin", " ", 
       "depolymerizing", " ", 
       RowBox[{"factor", "/", "cofilin"}], " ", "controls", " ", "the", " ", 
       "emergence", " ", "of", " ", "a", " ", "steady", " ", "dynamical", " ", 
       RowBox[{"regime", ".", "Biophys"}], " ", "J", ".2008", " ", "Mar", " ",
        "15"}], ";", 
      RowBox[{
       RowBox[{"94", 
        RowBox[{"(", "6", ")"}]}], ":", 
       RowBox[{"2082", "-", 
        RowBox[{"94.", " ", "doi"}]}], ":", 
       RowBox[{
        RowBox[{"10.1529", "/", "biophysj"}], ".107", 
        RowBox[{".121988", ".", "Epub"}], " ", "2007", " ", "Dec", " ", "7.", 
        " ", 
        RowBox[{"PMID", ":", "18065447"}]}]}], ";", 
      RowBox[{"PMCID", ":", 
       RowBox[{"PMC2257902", "."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"kATPHydrolysis", "=", "0.35"}], " ", 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ksev", "=", "0.012"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cofHilln", "=", "4.25"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cofKn", "=", 
     RowBox[{"0.6", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], ")"}], "^", "cofHilln"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"M", "^", "n"}], "*)"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Carlier", " ", 
      RowBox[{"MF", ".", "Measurement"}], " ", "of", " ", "Pi", " ", 
      "dissociation", " ", "from", " ", "actin", " ", "filaments", " ", 
      "following", " ", "ATP", " ", "hydrolysis", " ", "using", " ", "a", " ",
       "linked", " ", "enzyme", " ", 
      RowBox[{"assay", ".", "Biochem"}], " ", "Biophys", " ", "Res", " ", 
      "Commun", ".1987", " ", "Mar", " ", "30", " ", "143", 
      RowBox[{"(", "3", ")"}]}], ":", 
     RowBox[{"1069", "-", 
      RowBox[{"75.", " ", "doi"}]}], ":", 
     RowBox[{
      RowBox[{"10.1016", "/", "0006"}], "-", 
      RowBox[{"291", "x", 
       RowBox[{"(", "87", ")"}], "90361"}], "-", 
      RowBox[{"5.", " ", 
       RowBox[{"PMID", ":", "3566755."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"kPiRelease", "=", "0.006"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"kCofPiRelease", "=", "0.035"}], " ", 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    TemplateBox[{
      RowBox[{
        RowBox[{"Wioland", " ", "H"}], ",", 
        RowBox[{"Guichard", " ", "B"}], ",", 
        RowBox[{"Senju", " ", "Y"}], ",", 
        RowBox[{"Myram", " ", "S"}], ",", 
        RowBox[{"Lappalainen", " ", "P"}], ",", 
        RowBox[{"J\[EAcute]gou", " ", "A"}], ",", 
        RowBox[{
          RowBox[{"Romet", "-", 
            RowBox[{"Lemonne", " ", 
              RowBox[{
                RowBox[{"G", ".", "ADF"}], "/", "Cofilin"}], " ", 
              "Accelerates", " ", "Actin", " ", "Dynamics", " ", "by", " ", 
              "Severing", " ", "Filaments", " ", "and", " ", "Promoting", " ",
               "Their", " ", "Depolymerization", " ", "at", " ", "Both", " ", 
              
              RowBox[{"Ends", ".", "Curr"}], " ", 
              RowBox[{"Biol", ".", "2017"}], " ", "Jul", " ", "10"}]}], ";", 
          RowBox[{
            RowBox[{"27", 
              RowBox[{"(", "13", ")"}]}], ":", 
            RowBox[{"1956", "-", 
              RowBox[{"1967.", 
                RowBox[{"e7", ".", "doi"}]}]}], ":", 
            RowBox[{
              RowBox[{"10.1016", "/", 
                RowBox[{"j", ".", "cub"}]}], ".2017", ".05", 
              RowBox[{".048", ".", "Epub"}], " ", "2017", " ", "Jun", " ", 
              "15.", " ", 
              RowBox[{"PMID", ":", "28625781"}]}]}], ";", 
          RowBox[{"PMCID", ":", 
            RowBox[{"PMC5505867", "."}]}]}]}], {
       URL["https://pubmed.ncbi.nlm.nih.gov/28625781/"], None}, 
      "https://pubmed.ncbi.nlm.nih.gov/28625781/", 
      "HyperlinkActionRecycled", {"HyperlinkActive"}, 
      BaseStyle -> {"Hyperlink"}, HyperlinkAction -> "Recycled"},
     "HyperlinkTemplate"], "*)"}], "\n", 
   RowBox[{
    RowBox[{"kOnCofEdge", "=", 
     RowBox[{"17", "*", 
      SuperscriptBox["10", "6"], 
      RowBox[{"(*", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"M", " ", "s"}], ")"}]}], "*)"}], "*", "speciesToMol"}]}], 
    " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kOffCof", "=", "0.7"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kMinusBarbedCof", "=", "4.0"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kMinusPointedCof", "=", "3.3"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    TemplateBox[{
      RowBox[{
        RowBox[{"De", " ", "La", " ", "Cruz", " ", 
          RowBox[{"EM", ".", "How"}], " ", "cofilin", " ", "severs", " ", 
          "an", " ", "actin", " ", 
          RowBox[{"filament", ".", "Biophys"}], " ", 
          RowBox[{"Rev", ".", "2009"}], " ", "May", " ", "15"}], ";", 
        RowBox[{
          RowBox[{"1", 
            RowBox[{"(", "2", ")"}]}], ":", 
          RowBox[{"51", "-", 
            RowBox[{"59.", " ", "doi"}]}], ":", 
          RowBox[{
            RowBox[{"10.1007", "/", "s12551"}], "-", "009", "-", "0008", "-", 
            
            RowBox[{"5.", " ", 
              RowBox[{"PMID", ":", "20700473"}]}]}]}], ";", 
        RowBox[{"PMCID", ":", 
          RowBox[{"PMC2917815", "."}]}]}], {
       URL["https://pubmed.ncbi.nlm.nih.gov/20700473/"], None}, 
      "https://pubmed.ncbi.nlm.nih.gov/20700473/", 
      "HyperlinkActionRecycled", {"HyperlinkActive"}, 
      BaseStyle -> {"Hyperlink"}, HyperlinkAction -> "Recycled"},
     "HyperlinkTemplate"], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kOnSingleCof", "=", 
     RowBox[{
      SuperscriptBox["10", "4"], 
      RowBox[{"(*", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"M", " ", "s"}]}]}], "*)"}], "*", "speciesToMol"}]}], " ", 
    ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"pmc", ".", "ncbi", ".", "nlm", ".", "nih", ".", "gov"}], "/",
         "articles"}], "/", "PMC10152144"}], "/"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"kArpNuc", "=", "3.23"}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"kNucOff", "=", 
     RowBox[{"7.9", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], 
    RowBox[{"(*", 
     RowBox[{"1", "/", "s"}], "*)"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"*", "FACTORS"}], "**)"}], "\n", 
   RowBox[{
    RowBox[{"initActinADPNum", "=", "0."}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"meshSpacing", "=", 
     RowBox[{"0.04", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"upperBound", "=", 
     RowBox[{"meshSpacing", "*", 
      RowBox[{"5.", "/", "4."}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lowerBound", "=", 
     RowBox[{"meshSpacing", "*", 
      RowBox[{"4.", "/", "5."}]}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9636673570291986`*^9, 3.963667357730158*^9}, {
   3.963823743460877*^9, 3.963823755846628*^9}, {3.9638589492683067`*^9, 
   3.963858956248608*^9}, {3.964023156752699*^9, 3.964023157438375*^9}, {
   3.964310659048174*^9, 3.9643106593339977`*^9}, 3.9643637176152*^9, {
   3.964468899360343*^9, 3.964468908122785*^9}, {3.9644689869974337`*^9, 
   3.9644689875350513`*^9}, {3.964470436970647*^9, 3.9644704380422487`*^9}, {
   3.9644724573110867`*^9, 3.964472460413741*^9}, {3.964472492677745*^9, 
   3.964472500145125*^9}, {3.964473141485997*^9, 3.964473155344352*^9}, {
   3.96447327118574*^9, 3.964473281516272*^9}, {3.964473838287483*^9, 
   3.964473852857469*^9}, {3.964474226935701*^9, 3.964474265233289*^9}, {
   3.964474587992304*^9, 3.964474588192575*^9}, {3.9644748571644077`*^9, 
   3.9644748759341183`*^9}, {3.964474935328849*^9, 3.964474971931994*^9}, {
   3.9644750451659327`*^9, 3.964475045773645*^9}, {3.964475130955227*^9, 
   3.96447519094951*^9}, 3.964475342215693*^9, {3.964475488619001*^9, 
   3.964475498505507*^9}, {3.9644755743846807`*^9, 3.9644755859040527`*^9}, {
   3.964475964761853*^9, 3.964475978424461*^9}, {3.9644772826505623`*^9, 
   3.964477297613583*^9}, {3.964477482698245*^9, 3.964477486640541*^9}, {
   3.96447844352654*^9, 3.9644784436680727`*^9}, {3.9644797774568443`*^9, 
   3.964479792782673*^9}, {3.9644802992323093`*^9, 3.9644803175897827`*^9}, {
   3.964480750038056*^9, 3.964480752208918*^9}, {3.9644823102177687`*^9, 
   3.964482318716449*^9}, 3.964482549752226*^9, {3.964482590784319*^9, 
   3.964482615836494*^9}, {3.9644827904381247`*^9, 3.9644827904903307`*^9}, {
   3.9645319602355967`*^9, 3.964531962414742*^9}, 3.965051131163068*^9, {
   3.965053282999596*^9, 3.965053284658648*^9}, {3.9653341742829313`*^9, 
   3.965334183441894*^9}, {3.9654910661356897`*^9, 3.965491083131782*^9}, {
   3.966318407401661*^9, 3.966318423240048*^9}, {3.966334489656384*^9, 
   3.9663344915474873`*^9}, 3.967601471192733*^9, {3.96787303543788*^9, 
   3.96787303573309*^9}, {3.967874057877409*^9, 3.9678740611413517`*^9}, {
   3.967874117390486*^9, 3.9678741664046707`*^9}, 3.968221940810108*^9, 
   3.968221973146491*^9, {3.968222113472537*^9, 3.968222160513073*^9}, {
   3.9682221958320723`*^9, 3.9682222023364267`*^9}, {3.9682222384164*^9, 
   3.968222244750773*^9}, {3.9682402678495407`*^9, 3.968240300912101*^9}, 
   3.9682554032213097`*^9, 3.969184444687488*^9, 3.969729973211248*^9, {
   3.969813005632444*^9, 3.969813008048367*^9}, 3.9698130449357643`*^9, 
   3.969813426873786*^9, 3.969813630439247*^9, {3.970147447188066*^9, 
   3.970147549694524*^9}, {3.9701489037950907`*^9, 3.970148927054912*^9}, {
   3.970150252118988*^9, 3.970150261575822*^9}, {3.970150406918079*^9, 
   3.970150414857182*^9}, {3.970150449048603*^9, 3.970150452155455*^9}, {
   3.970154954902334*^9, 3.9701549566912317`*^9}, 3.970156185935225*^9, {
   3.970156230883861*^9, 3.970156234402157*^9}, {3.970156312993256*^9, 
   3.970156362015848*^9}, 3.970156395770319*^9, {3.970156436169842*^9, 
   3.9701564456657333`*^9}, {3.970161467302541*^9, 3.970161485767736*^9}, {
   3.9702330006585503`*^9, 3.9702330007872877`*^9}, {3.970233162493363*^9, 
   3.970233165849126*^9}, {3.970233214577071*^9, 3.9702332186760693`*^9}, {
   3.970236909998559*^9, 3.970236910366596*^9}, {3.970355254935521*^9, 
   3.970355261096053*^9}, {3.9703823946142807`*^9, 3.970382403109353*^9}, {
   3.970845710134737*^9, 3.97084571040168*^9}, 3.9720875528722563`*^9, {
   3.972090750073421*^9, 3.9720908044605713`*^9}, {3.972091534877058*^9, 
   3.972091553955781*^9}, {3.972370750780254*^9, 3.9723707806479607`*^9}, {
   3.9725019788912153`*^9, 3.972502000879449*^9}, {3.972502123496875*^9, 
   3.972502188396996*^9}, 3.972502507142783*^9, {3.97251270386406*^9, 
   3.9725127128805723`*^9}, {3.9725127794547443`*^9, 
   3.9725127846186047`*^9}, {3.9729383276446657`*^9, 3.972938329383041*^9}, {
   3.97304084359761*^9, 3.9730408699851418`*^9}, {3.973259711756441*^9, 
   3.973259713074465*^9}, {3.973270354561182*^9, 3.9732703561221437`*^9}, {
   3.973271814972581*^9, 3.973271821745192*^9}, {3.973884414441896*^9, 
   3.97388442098438*^9}, {3.973884764371538*^9, 3.97388477022989*^9}, {
   3.9738848076566153`*^9, 3.9738848083290997`*^9}, {3.976844247342588*^9, 
   3.976844297103266*^9}, {3.976844329086667*^9, 3.97684436622187*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"46831002-015e-40d0-9450-98f8001e2306"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve-Fitting CamKII\[Beta] and Aip1 (capping) Degradation Rates", \
"Subsection",ExpressionUUID->"67670957-1bc7-48c0-a998-3624763610a2"],

Cell["\<\
Hyperlink[(*Bosch M,Castro J,Saneyoshi T,Matsuno H,Sur M,Hayashi Y.Structural \
and molecular remodeling of dendritic spine substructures during long-term \
potentiation.Neuron.2014 Apr 16;82(2):444-59. \
doi:10.1016/j.neuron.2014.03.021.PMID:24742465;PMCID:PMC4281348.*),{URL[\"\
https://pubmed.ncbi.nlm.nih.gov/24742465/\"], None},Apply[Sequence, \
{ActiveStyle -> {\"HyperlinkActive\"}, BaseStyle -> {\"Hyperlink\"}, \
HyperlinkAction -> \"Recycled\"}]]\
\>", "Text",ExpressionUUID->"69fecaa9-d58b-45fd-bbd2-5e2f2055c04c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"ParametricNDSolveValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "influx", ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"HeavisideTheta", "[", 
              RowBox[{"t", "-", "1."}], "]"}]}], ")"}]}], "+", "ks", "-", 
          RowBox[{"km", " ", 
           RowBox[{"m", "[", "t", "]"}], "*", "monomericFraction"}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"m", "[", "4.", "]"}], "==", 
        RowBox[{"3000.", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}]}]}], "}"}], ",", "m", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.0", ",", "10."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ks", ",", "km", ",", "influx"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.963687165812995*^9, {3.968255090049491*^9, 3.968255090424151*^9}, {
   3.968255334696961*^9, 3.968255334957942*^9}, {3.969729911005191*^9, 
   3.969729928003731*^9}, {3.969730002493228*^9, 3.96973002143363*^9}, {
   3.970147234565241*^9, 3.970147252726845*^9}, {3.970147651181416*^9, 
   3.97014767168367*^9}, {3.9701477574086027`*^9, 3.970147757460167*^9}, {
   3.970147838762537*^9, 3.9701478393867283`*^9}, {3.97014795930939*^9, 
   3.970147959771697*^9}},
 CellLabel->
  "In[11014]:=",ExpressionUUID->"3c7e35b1-0cf2-4691-bf44-544aca683d8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"actinData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", 
       RowBox[{"1.5", "/", "1.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "/", "5"}], ",", 
       RowBox[{"2.55", "/", "1.85"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.15", ",", 
       RowBox[{"3.5", "/", "2.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.501", ",", 
       RowBox[{"3.75", "/", "2.85"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.75", ",", 
       RowBox[{"3.6", "/", "2.85"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"3.15", "/", "2.7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.3", ",", 
       RowBox[{"2.75", "/", "2.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.75", ",", 
       RowBox[{"2.6", "/", "2.4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"2.5", "/", "2.3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.25", ",", 
       RowBox[{"2.4", "/", "2.2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.75", ",", 
       RowBox[{"2.3", "/", "2.1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.", ",", 
       RowBox[{"2.1", "/", "2."}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"actinData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
   RowBox[{"3000.", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"actinData", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"eq", "[", 
        RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"influx", ",", "km", ",", "ks"}], "}"}], ",", "t"}], "]"}]}], 
  ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.9636871486050158`*^9, 3.963687152408536*^9}, {
   3.9682550669256287`*^9, 3.968255106142015*^9}, {3.968255137694069*^9, 
   3.968255173963297*^9}, {3.968549804968425*^9, 3.968549858766371*^9}, {
   3.968549899110587*^9, 3.968549920290111*^9}, {3.968549952740532*^9, 
   3.9685499530421677`*^9}, 3.970147721677835*^9, {3.970147841072576*^9, 
   3.970147841622685*^9}, {3.970147961285481*^9, 3.970147961753377*^9}},
 CellLabel->
  "In[11015]:=",ExpressionUUID->"b169a13a-aece-4e4e-b156-e31c93dde0c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"actinPlot", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"actinData", ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", "Full"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eq", "[", 
              RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", 
             "]"}], ")"}], "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0.0", ",", "10"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", "Full"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotLabel", "->", "\"\<Actin Molecular Rate Estimation\>\""}], 
      ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Time (s)\>\"", ",", "\"\<Concentration (M)\>\""}], 
        "}"}]}]}], "]"}], ",", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Experimental\>\"", ",", "\"\<Fit\>\""}], "}"}]}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.968549974739387*^9, 3.968550006896162*^9}, {
  3.968550060629346*^9, 3.968550172241096*^9}, {3.970147855825719*^9, 
  3.9701478658465*^9}, {3.970291401717949*^9, 3.9702914121034613`*^9}},
 CellLabel->
  "In[11018]:=",ExpressionUUID->"881ed65f-8578-44de-b185-caec33a17935"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[0, 0, 1], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            AbsoluteThickness[2], 
            
            LineBox[{{0., 0.003}, {0.3333333333333333, 
             0.0036000000000000008`}, {0.8, 0.004135135135135135}, {1.15, 
             0.004200000000000001}, {1.501, 0.003947368421052632}, {1.75, 
             0.003789473684210526}, {2., 0.0034999999999999996`}, {2.3, 
             0.0033000000000000004`}, {2.75, 0.0032500000000000007`}, {3., 
             0.003260869565217392}, {3.25, 0.0032727272727272726`}, {3.75, 
             0.0032857142857142855`}, {4., 0.00315}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        StyleBox[
         DynamicBox[
          (Charting`HighlightActionBox["DynamicHighlight", {}, 
           Slot["HighlightElements"], 
           Slot["LayoutOptions"], 
           Slot["Meta"], 
           Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
              Annotation[{
                Hue[0.67, 0.6, 0.6], 
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]], 
                
                Line[{{0., 0.003}, {0.3333333333333333, 
                 0.0036000000000000008`}, {0.8, 0.004135135135135135}, {1.15, 
                 0.004200000000000001}, {1.501, 0.003947368421052632}, {1.75, 
                 0.003789473684210526}, {2., 0.0034999999999999996`}, {2.3, 
                 0.0033000000000000004`}, {2.75, 0.0032500000000000007`}, {3.,
                  0.003260869565217392}, {3.25, 0.0032727272727272726`}, {
                 3.75, 0.0032857142857142855`}, {4., 0.00315}}]}, 
               "Charting`Private`Tag#1"]}}, <|
            "HighlightElements" -> <|
              "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
             "LayoutOptions" -> <|
              "PanelPlotLayout" -> <||>, 
               "PlotRange" -> {{0., 4.}, {0.002933333333333562, 
                0.004200000000000001}}, 
               "Frame" -> {{False, False}, {False, False}}, 
               "AxesOrigin" -> {0, 0.002933333333333562}, 
               "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
               "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
               "DefaultStyle" -> {
                 Directive[
                  PointSize[
                   Rational[7, 360]], 
                  AbsoluteThickness[2], 
                  RGBColor[0, 0, 1]]}, 
               "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                   (Identity[#]& )[
                    Part[#, 1]], 
                   (Identity[#]& )[
                    Part[#, 2]]}& ), 
                 "ScalingFunctions" -> {{Identity, Identity}, {
                   Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
               False|>, 
             "Meta" -> <|
              "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
               "Function" -> ListLinePlot, "GroupHighlight" -> 
               False|>|>]]& )[<|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.002933333333333562, 
               0.004200000000000001}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.002933333333333562}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
          ImageSizeCache -> {{
           4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
         False]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[0, 0, 1]], 
            
            Line[{{0., 0.003}, {0.3333333333333333, 0.0036000000000000008`}, {
             0.8, 0.004135135135135135}, {1.15, 0.004200000000000001}, {1.501,
              0.003947368421052632}, {1.75, 0.003789473684210526}, {2., 
             0.0034999999999999996`}, {2.3, 0.0033000000000000004`}, {2.75, 
             0.0032500000000000007`}, {3., 0.003260869565217392}, {3.25, 
             0.0032727272727272726`}, {3.75, 0.0032857142857142855`}, {4., 
             0.00315}}]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0., 4.}, {0.002933333333333562, 
            0.004200000000000001}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.002933333333333562}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[0, 0, 1]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}, 
     InterpretationBox[{
       TagBox[{{{}, {}, 
          TagBox[{
            RGBColor[1, 0, 0], 
            AbsoluteThickness[2], 
            Opacity[1.], 
            LineBox[CompressedData["
1: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
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {}}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
       StyleBox[
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
              Annotation[{
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]], 
                Line[CompressedData["
1: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
                 "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.0028061045011140763`, 
               0.004354996369789081}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.0028061045011140823`}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> Plot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0., 4.}, {0.0028061045011140763`, 
              0.004354996369789081}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.0028061045011140823`}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                Opacity[1.], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> Plot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
        False]}, 
      Annotation[{{{{}, {}, 
          Annotation[{
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]], 
            Line[CompressedData["
1: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
             "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, 
          "PlotRange" -> {{0., 4.}, {0.0028061045011140763`, 
           0.004354996369789081}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {0, 0.0028061045011140823`}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              (Identity[#]& )[
               Part[#, 1]], 
              (Identity[#]& )[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]}, 
    AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
    Axes -> {True, True}, AxesLabel -> {
      FormBox["\"Time (s)\"", TraditionalForm], 
      FormBox["\"Concentration (M)\"", TraditionalForm]}, 
    AxesOrigin -> {0, 0.002933333333333562}, 
    DefaultBaseStyle -> {"PlotGraphics", "Graphics"}, DisplayFunction -> 
    Identity, Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.24, 0.6, 0.8], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.95, 0.627, 0.1425], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.455, 0.7, 0.21], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.578, 0.51, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.4, 0.64, 1.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1., 0.75, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.8, 0.4, 0.76], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.637, 0.65, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
      "IncludeHighlighting" -> Automatic, "HighlightStyle" -> Automatic, 
      "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentSet", 
      "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& )}}, PlotInteractivity :> True, PlotLabel -> 
    FormBox["\"Actin Molecular Rate Estimation\"", TraditionalForm], 
    PlotRange -> {{0., 4.}, {0.002933333333333562, 0.004200000000000001}}, 
    PlotRangeClipping -> True, PlotRangePadding -> {{None, None}, {
       Scaled[0.05], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Experimental\"", "\"Fit\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>, 
                "RGBColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>, 
                "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& ), Editable -> True], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.9685499724697*^9, 3.968550007436583*^9}, 
   3.968550078401616*^9, 3.968550109335672*^9, 3.968550142688702*^9, 
   3.968550173153379*^9, {3.968550292206068*^9, 3.968550297366301*^9}, {
   3.9697299172808743`*^9, 3.96972993021327*^9}, 3.969730171839712*^9, 
   3.970147598926898*^9, 3.970147697475046*^9, 3.970147759776484*^9, {
   3.970147845137785*^9, 3.970147866238619*^9}, 3.970147965426516*^9, {
   3.970291402615616*^9, 3.970291412569059*^9}, 3.97304158836554*^9},
 CellLabel->
  "Out[11018]=",ExpressionUUID->"0cc19f5c-f70c-42a4-b318-62ae1054c0e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", "0.0019996479973183085`"}], ",", 
   RowBox[{"km", "\[Rule]", "5.733176798118083`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.0019283704258071265`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.96854997249435*^9, 3.9685500074657927`*^9}, 
   3.968550078430893*^9, 3.968550109361451*^9, 3.96855014271286*^9, 
   3.9685501731794443`*^9, {3.968550292224368*^9, 3.9685502973947763`*^9}, {
   3.969729917303851*^9, 3.9697299302369204`*^9}, 3.9697301718653793`*^9, 
   3.9701475989778633`*^9, 3.9701476975159807`*^9, 3.970147759788205*^9, {
   3.970147845142953*^9, 3.970147866250945*^9}, 3.970147965439818*^9, {
   3.970291402643548*^9, 3.9702914125984507`*^9}, 3.973041588382083*^9},
 CellLabel->
  "During evaluation of \
In[11018]:=",ExpressionUUID->"8d9cbe8b-d441-4c3b-8607-70dc25191634"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", "0.0019996479973183085`", "0.00022779564954248367`", 
      "8.778253673125466`", "5.175638847101344`*^-6"},
     {"km", "5.733176798118083`", "1.2387582606990153`", "4.628164331984293`",
       "0.0009388028950428319`"},
     {"ks", "0.0019283704258071265`", "0.00048080490410282726`", 
      "4.010712888641244`", "0.0024752081572205647`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{{3.96854997249435*^9, 3.9685500074657927`*^9}, 
   3.968550078430893*^9, 3.968550109361451*^9, 3.96855014271286*^9, 
   3.9685501731794443`*^9, {3.968550292224368*^9, 3.9685502973947763`*^9}, {
   3.969729917303851*^9, 3.9697299302369204`*^9}, 3.9697301718653793`*^9, 
   3.9701475989778633`*^9, 3.9701476975159807`*^9, 3.970147759788205*^9, {
   3.970147845142953*^9, 3.970147866250945*^9}, 3.970147965439818*^9, {
   3.970291402643548*^9, 3.9702914125984507`*^9}, 3.9730415883829947`*^9},
 CellLabel->
  "During evaluation of \
In[11018]:=",ExpressionUUID->"c38af81f-388d-4d91-9ef3-1d70ebb8af94"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xbase", "=", "804."}], ";", 
  RowBox[{"ybase", "=", "1082."}], ";", 
  RowBox[{"xunit", "=", 
   RowBox[{"836.", "-", "800."}]}], ";", 
  RowBox[{"yunit", "=", 
   RowBox[{"1218", "-", "1182"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.968239879387072*^9, 3.9682399017373953`*^9}},
 CellLabel->
  "In[11021]:=",ExpressionUUID->"74d6121e-efc8-4678-bb68-edc284e96472"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"arpDataVol", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", "\"\<~/ResultsArpVol.csv\>\"", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], ";;"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{";;", 
        RowBox[{"-", "3"}]}], "]"}], "]"}], ",", "First"}], "]"}]}], ";", 
  RowBox[{"arpDataProt", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", "\"\<~/ResultsArp.csv\>\"", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], ";;"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{";;", 
        RowBox[{"-", "3"}]}], "]"}], "]"}], ",", "First"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[11022]:=",ExpressionUUID->"cf7d0b37-db69-493f-8d9a-cb59e756aeca"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.973041589365265*^9},
 CellLabel->
  "Out[11022]=",ExpressionUUID->"02a5fa1a-6b12-45c2-8998-9b273ba6de97"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"arpDataVol", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"arpDataVol", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"arpDataVol", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
      "arpDataVol"}], ")"}], "//", "Abs"}]}], ";", 
  RowBox[{"arpDataProt", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"arpDataProt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"arpDataProt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
      "arpDataProt"}], ")"}], "//", "Abs"}]}], ";"}]], "Input",
 CellLabel->
  "In[8759]:=",ExpressionUUID->"0906d191-d901-40eb-8929-dd7b9db1dc69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"arpData", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"arpDataProt", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "/", "xunit"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"arpDataProt", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", "yunit"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"arpDataVol", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", "yunit"}], ")"}]}]}], 
     "}"}], "//", "Transpose"}]}], ";", 
  RowBox[{"arpData", "=", 
   RowBox[{"arpData", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.968239923728854*^9, 3.968239926370716*^9}, {
   3.968239966251697*^9, 3.9682399821899223`*^9}, {3.968240026162393*^9, 
   3.968240032708659*^9}, 3.970763362813491*^9},
 CellLabel->
  "In[8760]:=",ExpressionUUID->"6263a5de-f633-48bc-a0e1-682ca6da531e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"arpData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
   RowBox[{"256.", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9707633681820183`*^9, 3.9707633771884737`*^9}},
 CellLabel->
  "In[8761]:=",ExpressionUUID->"ec81395d-06af-492f-ae66-193d65284711"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{"ParametricNDSolveValue", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "influx", ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"HeavisideTheta", "[", 
               RowBox[{"t", "-", "1."}], "]"}]}], ")"}]}], "+", "ks", "-", 
           RowBox[{"km", " ", 
            RowBox[{"m", "[", "t", "]"}], "*", "fractionArpUnbound"}]}], 
          ")"}]}], ",", 
        RowBox[{
         RowBox[{"m", "[", "0", "]"}], "==", 
         RowBox[{"256.", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}]}]}], "}"}], ",", "m", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0.0", ",", "10."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ks", ",", "km", ",", "influx"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"arpData", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"0", "<", "km", "<", "10."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"influx", ",", "km", ",", "ks"}], "}"}], ",", "t"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", "arpData", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.968240118192724*^9, 3.968240132770718*^9}},
 CellLabel->
  "In[8762]:=",ExpressionUUID->"a4234906-6205-4742-bf53-7d069dfb321a"],

Cell[BoxData[
 GraphicsBox[{{{}, 
    InterpretationBox[{
      TagBox[{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
          LineBox[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
           0.00027417751479289935`}, {0.9305555555555555, 
           0.0002859707317073171}, {1.1527777777777777`, 
           0.0002833066666666667}, {1.5416666666666665`, 
           0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
           2.263888888888889, 0.0002828296943231441}, {2.597222222222222, 
           0.00027959447004608293`}, {2.9305555555555554`, 
           0.000281989847715736}, {3.208333333333333, 
           0.00027862983425414365`}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]},
       {"WolframDynamicHighlight", <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
      StyleBox[
       DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
            Annotation[{
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              
              Line[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
               0.00027417751479289935`}, {0.9305555555555555, 
               0.0002859707317073171}, {1.1527777777777777`, 
               0.0002833066666666667}, {1.5416666666666665`, 
               0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
               2.263888888888889, 0.0002828296943231441}, {2.597222222222222, 
               0.00027959447004608293`}, {2.9305555555555554`, 
               0.000281989847715736}, {3.208333333333333, 
               0.00027862983425414365`}}]}, "Charting`Private`Tag#1"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0, 3.208333333333333}, {0.0002543349593498161, 
               0.0002859707317073171}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.0002543349593498161}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.24, 0.6, 0.8], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 3.208333333333333}, {0.0002543349593498161, 
              0.0002859707317073171}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.0002543349593498161}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>],
        ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}],
       Selectable->False]},
     Annotation[{{{}, {}, 
        Annotation[{
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          
          Line[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
           0.00027417751479289935`}, {0.9305555555555555, 
           0.0002859707317073171}, {1.1527777777777777`, 
           0.0002833066666666667}, {1.5416666666666665`, 
           0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
           2.263888888888889, 0.0002828296943231441}, {2.597222222222222, 
           0.00027959447004608293`}, {2.9305555555555554`, 
           0.000281989847715736}, {3.208333333333333, 
           0.00027862983425414365`}}]}, "Charting`Private`Tag#1"]}}, <|
      "HighlightElements" -> <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
       "LayoutOptions" -> <|
        "PanelPlotLayout" -> <||>, 
         "PlotRange" -> {{0, 3.208333333333333}, {0.0002543349593498161, 
           0.0002859707317073171}}, 
         "Frame" -> {{False, False}, {False, False}}, 
         "AxesOrigin" -> {0, 0.0002543349593498161}, 
         "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
         "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
         "DefaultStyle" -> {
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.24, 0.6, 0.8], 
            AbsoluteThickness[2]]}, 
         "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), 
           "ScalingFunctions" -> {{Identity, Identity}, {
             Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
       "Meta" -> <|
        "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
         ListLinePlot, "GroupHighlight" -> False|>|>, 
      "DynamicHighlight"]], {{}, {}}}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], AbsoluteThickness[2], Opacity[1.], 
          LineBox[CompressedData["
1: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
pvVxYYHCEkGjTRfx/wHEgP4B
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, {}},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
            Annotation[{
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              Line[CompressedData["
1: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
pvVxYYHCEkGjTRfx/wHEgP4B
               "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4}, {0.00027131382047895303`, 
              0.0002842261191201676}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.0002713138204789536}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            Plot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0, 4}, {0.00027131382047895303`, 
             0.0002842261191201676}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.0002713138204789536}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          Line[CompressedData["
1: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
pvVxYYHCEkGjTRfx/wHEgP4B
           "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0, 4}, {0.00027131382047895303`, 
          0.0002842261191201676}}, 
        "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0, 0.0002713138204789536}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.0002543349593498161},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 3.208333333333333}, {0.0002543349593498161, 
    0.0002859707317073171}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9678740026368113`*^9, 3.9682399878151627`*^9, 
  3.968240048155847*^9, 3.968240133857966*^9, 3.970845915899551*^9},
 CellLabel->
  "Out[8764]=",ExpressionUUID->"02569956-fd06-4be0-8b85-983aab13904d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", "0.000024424544184661355`"}], ",", 
   RowBox[{"km", "\[Rule]", "3.184243674073855`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.00015589619003090606`"}]}], "}"}]], "Print",
 CellChangeTimes->{3.967874002662818*^9, 3.96823998789399*^9, 
  3.968240048234106*^9, 3.9682401339341383`*^9, 3.970845915923802*^9},
 CellLabel->
  "During evaluation of \
In[8762]:=",ExpressionUUID->"4ad72b0e-9133-4d8b-8e94-1081428450a0"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   8766, 1689, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9682401339348307`*^9, 3.970845915924761*^9},
 CellLabel->
  "During evaluation of \
In[8762]:=",ExpressionUUID->"04fbc391-3e64-4ac7-a4fb-8ff8081bc201"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", "0.000024424544184661355`", "0.000010398166925975657`", 
      "2.348927879167472`", "0.051168151920373196`"},
     {"km", "3.184243674073855`", "4.86981070240259`", "0.6538742198958295`", 
      "0.534075998286073`"},
     {"ks", "0.00015589619003090606`", "0.00024196422494732572`", 
      "0.6442943789101212`", "0.5399145936097367`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.967874002662818*^9, 3.96823998789399*^9, 
  3.968240048234106*^9, 3.9682401339341383`*^9, 3.970845915928323*^9},
 CellLabel->
  "During evaluation of \
In[8762]:=",ExpressionUUID->"5b251ae6-fd34-4dcc-9375-703e2742334d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"arpPlot", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"arpData", ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.000255", ",", "0.00029"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eq", "[", 
              RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", 
             "]"}], ")"}], "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0.0", ",", "10"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.000255", ",", "0.00029"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotLabel", "->", "\"\<Arp2/3 Molecular Rate Estimation\>\""}],
       ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Time (s)\>\"", ",", "\"\<Concentration (M)\>\""}], 
        "}"}]}]}], "]"}], ",", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Experimental\>\"", ",", "\"\<Fit\>\""}], "}"}]}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.970845888362811*^9, 3.970845942630772*^9}},
 CellLabel->
  "In[8773]:=",ExpressionUUID->"b48aae83-d258-47af-a068-553b80b772ef"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[0, 0, 1], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            AbsoluteThickness[2], 
            
            LineBox[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
             0.00027417751479289935`}, {0.9305555555555555, 
             0.0002859707317073171}, {1.1527777777777777`, 
             0.0002833066666666667}, {1.5416666666666665`, 
             0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
             2.263888888888889, 0.0002828296943231441}, {2.597222222222222, 
             0.00027959447004608293`}, {2.9305555555555554`, 
             0.000281989847715736}, {3.208333333333333, 
             0.00027862983425414365`}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        StyleBox[
         DynamicBox[
          (Charting`HighlightActionBox["DynamicHighlight", {}, 
           Slot["HighlightElements"], 
           Slot["LayoutOptions"], 
           Slot["Meta"], 
           Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
              Annotation[{
                Hue[0.67, 0.6, 0.6], 
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]], 
                
                Line[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
                 0.00027417751479289935`}, {0.9305555555555555, 
                 0.0002859707317073171}, {1.1527777777777777`, 
                 0.0002833066666666667}, {1.5416666666666665`, 
                 0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
                 2.263888888888889, 0.0002828296943231441}, {
                 2.597222222222222, 0.00027959447004608293`}, {
                 2.9305555555555554`, 0.000281989847715736}, {
                 3.208333333333333, 0.00027862983425414365`}}]}, 
               "Charting`Private`Tag#1"]}}, <|
            "HighlightElements" -> <|
              "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
             "LayoutOptions" -> <|
              "PanelPlotLayout" -> <||>, 
               "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
               "Frame" -> {{False, False}, {False, False}}, 
               "AxesOrigin" -> {0, 0.00025500000000000056`}, 
               "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
               "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
               "DefaultStyle" -> {
                 Directive[
                  PointSize[
                   Rational[7, 360]], 
                  AbsoluteThickness[2], 
                  RGBColor[0, 0, 1]]}, 
               "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                   (Identity[#]& )[
                    Part[#, 1]], 
                   (Identity[#]& )[
                    Part[#, 2]]}& ), 
                 "ScalingFunctions" -> {{Identity, Identity}, {
                   Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
               False|>, 
             "Meta" -> <|
              "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
               "Function" -> ListLinePlot, "GroupHighlight" -> 
               False|>|>]]& )[<|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.00025500000000000056`}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
          ImageSizeCache -> {{
           4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
         False]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[0, 0, 1]], 
            
            Line[{{0.2638888888888889, 0.000256}, {0.5416666666666666, 
             0.00027417751479289935`}, {0.9305555555555555, 
             0.0002859707317073171}, {1.1527777777777777`, 
             0.0002833066666666667}, {1.5416666666666665`, 
             0.00028192405063291135`}, {1.875, 0.00028149377593360996`}, {
             2.263888888888889, 0.0002828296943231441}, {2.597222222222222, 
             0.00027959447004608293`}, {2.9305555555555554`, 
             0.000281989847715736}, {3.208333333333333, 
             0.00027862983425414365`}}]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.00025500000000000056`}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[0, 0, 1]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}, 
     InterpretationBox[{
       TagBox[{{{}, {}, 
          TagBox[{
            RGBColor[1, 0, 0], 
            AbsoluteThickness[2], 
            Opacity[1.], 
            LineBox[CompressedData["
1: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
SuHiIoW9ql4Yi/wfMyNRnQ==
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {}}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
       StyleBox[
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
              Annotation[{
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]], 
                Line[CompressedData["
1:eJwV03k41dkfB3A7jzBkaSjc60u3kOU0/WSpzwmhopKtkWpc2UU1bpZUWkwk
kS1u3RQhU6hGixZbJcJNGC1EP5exXFyS5cpkzv3jPOd5Pd9zzvN+3t9z6MyI
Xf4SYmJiUWSIZs4Jpoz5geSNW97N35qtN4OX7TRnL1ow2Lc3lHc1mMFifdUZ
Gi0Gbir6JD5/YwacmhRdaVoSuHzZ4H2SawZhG1gHZ3VzwdV35dOFv82g/XtQ
5oRuCZi3CFOa+s1AtquPMaZbCdeHbON44uZw403eYb5uI8ya28/UW5pDWXlS
V5jJJ/iuNlogU2IOgfAud/QID3zcFkMypBGI5c886UrmAV/wKXpEBkGO1Iru
Nzd5sE/BcRrLIWhoDNAp6eSBFd/QclQewSr3hXx/q36QcckZslZGMBTEuNMj
PgAXJOpqq7UQhKQfr2pN+wdcbNWsd5siCB9YzasoGwY3ULva4Yngy76PcrWN
w5B0Db+j70bg9iHRpKV/GB7s7A0J/xXB+qbBmAGtEUj2u9Mk7YNA8l6hssa5
EfC1Wrp5jS/JF0ffGLWfDxsDIqn9oQjkZ1r9zsTy4ZNNaFF+GILjEfFJqVl8
aLN5dHHgIAIms7ejuIkPh8LPpQYfQmDsxAn9YDEK2alZbiEsBLWqmrmWymOg
caZ1cvtJBL+kNFRtNhqDCIvq1sR4BEUy0f2uDmOQxB9QrzuF4IKw0zQkbgyu
yqm1o7MIPHsz69lDY2B+9p6WYhLpa7f9aJHkOFikeyLb8wis26ZU/tIZh+2V
5o+PJiOgvdq1t8l9HBzamT/1pCAY+VP52/eacYh9cmWyMB2Bj36Nplz3OKxS
/xzfmYHgLScC1GbHQf28dLxMFoKKNO554zUCsLPr5x64jIAhf+LueicBtL6W
0c3IQcA+s6bT3k8AaweHemtyEZw8eoG+N1cA6lEvK7SuIvgqsHYMrhBAL8Ow
0YGD4EAwP4z1VgAa3xg7jlxD8L6PnX5qRAD//z7lwMlDYGBi0F0vMQH2T8Iu
x19H0DOyMO6sPAF7DFwe7iTOKe4Qb9eeACszmh6dWJ5+ltG7fgJ6DbIf1ZH9
DTaXTE9sJt/lZcayif/Yfc1Ce9cEKAk8bUOJJdIeO+4JnQCp6E1GasTzP0YD
33PI+se1CgEkD7/b49ZbiUlYJr8sSJ7kbc5hrK5pnoTSu0GngtkILio3Gd74
bQrqVas9fUk/zC73asnmGZh1iCpZR/o+/OosM4IxD1Vf/3fe+TSCe4cU3H7e
8i/UruwZ7YhFcONY6IiZlxjuUXKPy/sdwem8Bddvo+K4XFgmn0fuj1j7F/ws
VhKrR/sI3YMQrIwMiHY3lMb/NBtUgx+C/unLnkuey2ApSoh/7EOwdSDkePph
Oby4I+k53xvB9v40Ix0defz0jfrH/V7kf79gxjeULsFu84dvH3RHYKLSqW23
XxGbysn2X3Yl/cG0b/eUEjaUlGFb70DgOOY9q+ehjBN6Kh5/c0bwoe6AuLex
Cp7sm3km3IrgQeLLfbRpFQz7jdNdtyAIkGZ94XKXYqH1pYBKRwR+R449UGCr
4nap4N1+DghMA424zr5qOGLT797rN5P7tdR4CctSHV8oWuusbo/gadnpK8aS
Gli3LjCGskNwTNxwZ/NnDTwuy/SytCX5umOdwiuWYale2YWwTQgGiuiZeXE/
Y9ZP9xfqMILMVZpSlR6a+CNHh6dNnMYOeO1L08K5/3aGZgEC78y9XIVBLdwZ
blKmTTxnXyjMq1qOZ+eiim9tRMAbsI2uO7cCf5Z2sHckzt9gvrzFVxu/ikz4
a3gDgtIElkrgGh387Idi6RXicx5+2ySndfB1/6xfPYnXdd8oOdeii2VjGFqq
xDmrr5S2bKPhukI5sy4b8h5qUnK2VdKwIFDfqJDYZblH4Rt9Or4aF5vCIt4U
/nqPShIdi+vvsXAhzlvB1G+epmPe8oYJA2L9F8XZ2/fo4Ta2IEaaOG1NnWFb
lR7Wux/NHrYm/U9JvWs0pLBOefYHLjHz3ldaUiqF2SvsXB4Th512W9h6icLr
ltiOPyJmuVW8V8igMNMkMlXkxGnWxbRsCtv5Hml7SFxmKfx+mUPh3usfvB8Q
C2sXO4tuU/jQq72s+8RpbQopL19TOCij490dYnbBwaA/Giks2PRbjMgFkVw7
pyYK51yh00V+qJE238SlMC1v8+HbxN3eqkHtf1O4UUld7U9iBk/Tro9HzuP2
+RUTm1XE6twcoHBBaJuSyFYJXUL/QQo7CeYqi4idGZy7wyMUzpsbURb5SChN
Z3KS5Lf2r71JHGdzSnh/isKJa5XCRU5Q7OuInKbwx/JxLZFzyguS5+YofPSM
J6uAOD9eKvDJPIWNJHr0RL7t6m8bt0DhajdOaz5xhV699sYfFB5MzjwhctXU
SuHiIoW9ql4Yi/wfMyNRnQ==
                 "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.00025500000000000056`}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> Plot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.00025500000000000056`}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                Opacity[1.], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> Plot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
        False]}, 
      Annotation[{{{{}, {}, 
          Annotation[{
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]], 
            Line[CompressedData["
1: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
SuHiIoW9ql4Yi/wfMyNRnQ==
             "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, 
          "PlotRange" -> {{0., 4.}, {0.000255, 0.00029}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {0, 0.00025500000000000056`}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              (Identity[#]& )[
               Part[#, 1]], 
              (Identity[#]& )[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]}, 
    AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
    Axes -> {True, True}, AxesLabel -> {
      FormBox["\"Time (s)\"", TraditionalForm], 
      FormBox["\"Concentration (M)\"", TraditionalForm]}, 
    AxesOrigin -> {0, 0.00025500000000000056`}, DisplayFunction -> Identity, 
    Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.24, 0.6, 0.8], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.95, 0.627, 0.1425], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.455, 0.7, 0.21], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.578, 0.51, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.4, 0.64, 1.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1., 0.75, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.8, 0.4, 0.76], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.637, 0.65, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
      "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
      "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& )}}, PlotLabel -> 
    FormBox["\"Arp2/3 Molecular Rate Estimation\"", TraditionalForm], 
    PlotRange -> {{0., 4.}, {0.000255, 0.00029}}, PlotRangeClipping -> True, 
    PlotRangePadding -> {{0, 0}, {0, 0}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Experimental\"", "\"Fit\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>, 
                "RGBColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>, 
                "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& ), Editable -> True], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.970845916746223*^9, 3.9708459431182737`*^9}},
 CellLabel->
  "Out[8773]=",ExpressionUUID->"532b01ce-566c-48ea-92d5-934f6eaf7dc1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", "0.000024424544184661355`"}], ",", 
   RowBox[{"km", "\[Rule]", "3.184243674073855`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.00015589619003090606`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.970845916770788*^9, 3.970845943141488*^9}},
 CellLabel->
  "During evaluation of \
In[8773]:=",ExpressionUUID->"e34f3b59-280c-4b22-bc0e-a4e44ee7938c"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   8775, 1692, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{{3.9708459167714663`*^9, 3.970845943142309*^9}},
 CellLabel->
  "During evaluation of \
In[8773]:=",ExpressionUUID->"440bf0ec-7c08-4f5e-abf6-d34051f695e5"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", "0.000024424544184661355`", "0.000010398166925975657`", 
      "2.348927879167472`", "0.051168151920373196`"},
     {"km", "3.184243674073855`", "4.86981070240259`", "0.6538742198958295`", 
      "0.534075998286073`"},
     {"ks", "0.00015589619003090606`", "0.00024196422494732572`", 
      "0.6442943789101212`", "0.5399145936097367`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{{3.970845916770788*^9, 3.970845943145114*^9}},
 CellLabel->
  "During evaluation of \
In[8773]:=",ExpressionUUID->"17fcf79b-a161-44bb-9fbf-c0bc981f0969"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"camData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", 
       RowBox[{"1.15", "/", "1.4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "/", "3"}], ",", 
       RowBox[{"1.35", "/", "1.7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.001", ",", 
       RowBox[{"1.45", "/", "2.7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "/", "3"}], ",", 
       RowBox[{"1.475", "/", "2.85"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", "/", "3"}], ",", 
       RowBox[{"1.5", "/", "2.8"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"1.46", "/", "2.75"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7", "/", "3"}], ",", 
       RowBox[{"1.46", "/", "2.7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "/", "3"}], ",", 
       RowBox[{"1.462", "/", "2.7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"1.46", "/", "2.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"10", "/", "3"}], ",", 
       RowBox[{"1.4", "/", "2.2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"11", "/", "3"}], ",", 
       RowBox[{"1.35", "/", "2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       RowBox[{"1.35", "/", "2."}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"camData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
   RowBox[{"400.", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}]}], ";"}]], "Input",
 CellLabel->
  "In[8750]:=",ExpressionUUID->"a01f252c-b893-4d45-be7d-ff22382f8f57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"ParametricNDSolveValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "influx", ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"HeavisideTheta", "[", 
              RowBox[{"t", "-", "1."}], "]"}]}], ")"}]}], "+", "ks", "-", 
          RowBox[{"km", " ", 
           RowBox[{"m", "[", "t", "]"}], "*", "freeCamFraction"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"m", "[", "0", "]"}], "==", 
        RowBox[{"400.", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}]}]}], "}"}], ",", "m", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.0", ",", "10."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ks", ",", "km", ",", "influx"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[8751]:=",ExpressionUUID->"814fca9d-1621-4343-8733-9127aaa8f213"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"camData", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"0", "<", "km", "<", "10."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"influx", ",", "km", ",", "ks"}], "}"}], ",", "t"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", "camData", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], "/.", 
       RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[8752]:=",ExpressionUUID->"5cc6f013-b246-4df5-ba46-14ba29dc2540"],

Cell[BoxData[
 TemplateBox[{
  "ParametricNDSolveValue", "mdata", 
   "\"An invalid \\!\\(\\*RowBox[{\\\"NDSolve`SensitivityMethod\\\"}]\\) \
method data object was encountered at the point \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\).\"", 2, 
   8752, 1684, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9678740444132566`*^9, 3.968550239509149*^9, 
  3.970291357755184*^9, 3.970845671922669*^9, 3.970845716064365*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"6050a6b6-66f7-406d-a1c9-40d6612848f4"],

Cell[BoxData[
 TemplateBox[{
  "ParametricNDSolveValue", "mdata", 
   "\"An invalid \\!\\(\\*RowBox[{\\\"NDSolve`SensitivityMethod\\\"}]\\) \
method data object was encountered at the point \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\).\"", 2, 
   8752, 1685, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9678740444132566`*^9, 3.968550239509149*^9, 
  3.970291357755184*^9, 3.970845671922669*^9, 3.970845716068336*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"8d4c20d5-5163-4dd7-a034-aebe17160c03"],

Cell[BoxData[
 TemplateBox[{
  "ParametricNDSolveValue", "mdata", 
   "\"An invalid \\!\\(\\*RowBox[{\\\"NDSolve`SensitivityMethod\\\"}]\\) \
method data object was encountered at the point \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\).\"", 2, 
   8752, 1686, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9678740444132566`*^9, 3.968550239509149*^9, 
  3.970291357755184*^9, 3.970845671922669*^9, 3.970845716070657*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"edeacc50-af27-4e0f-9c91-a7d8315b3d58"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \
\\!\\(\\*StyleBox[RowBox[{\\\"ParametricNDSolveValue\\\", \\\"::\\\", \
\\\"mdata\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 8752, 1687, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9678740444132566`*^9, 3.968550239509149*^9, 
  3.970291357755184*^9, 3.970845671922669*^9, 3.97084571607274*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"de68c543-3627-40e8-a3fc-65614a32cb9d"],

Cell[BoxData[
 GraphicsBox[{{{}, 
    InterpretationBox[{
      TagBox[{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
          LineBox[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
           0.0003285714285714285}, {0.6666666666666666, 
           0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
           1.3333333333333333`, 0.00020701754385964912`}, {
           1.6666666666666667`, 0.00021428571428571425`}, {2., 
           0.00021236363636363635`}, {2.3333333333333335`, 
           0.00021629629629629627`}, {2.6666666666666665`, 
           0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
           3.3333333333333335`, 0.0002545454545454545}, {3.6666666666666665`, 
           0.00027}, {4., 0.00027}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]},
       {"WolframDynamicHighlight", <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
      StyleBox[
       DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
            Annotation[{
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              
              Line[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
               0.0003285714285714285}, {0.6666666666666666, 
               0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
               1.3333333333333333`, 0.00020701754385964912`}, {
               1.6666666666666667`, 0.00021428571428571425`}, {2., 
               0.00021236363636363635`}, {2.3333333333333335`, 
               0.00021629629629629627`}, {2.6666666666666665`, 
               0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
               3.3333333333333335`, 0.0002545454545454545}, {
               3.6666666666666665`, 0.00027}, {4., 0.00027}}]}, 
             "Charting`Private`Tag#1"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0, 4.}, {0.00019629629629651878`, 
               0.00039999999999999996`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.00019629629629651878`}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.24, 0.6, 0.8], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4.}, {0.00019629629629651878`, 
              0.00039999999999999996`}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.00019629629629651878`}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>],
        ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}],
       Selectable->False]},
     Annotation[{{{}, {}, 
        Annotation[{
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          
          Line[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
           0.0003285714285714285}, {0.6666666666666666, 
           0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
           1.3333333333333333`, 0.00020701754385964912`}, {
           1.6666666666666667`, 0.00021428571428571425`}, {2., 
           0.00021236363636363635`}, {2.3333333333333335`, 
           0.00021629629629629627`}, {2.6666666666666665`, 
           0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
           3.3333333333333335`, 0.0002545454545454545}, {3.6666666666666665`, 
           0.00027}, {4., 0.00027}}]}, "Charting`Private`Tag#1"]}}, <|
      "HighlightElements" -> <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
       "LayoutOptions" -> <|
        "PanelPlotLayout" -> <||>, 
         "PlotRange" -> {{0, 4.}, {0.00019629629629651878`, 
           0.00039999999999999996`}}, 
         "Frame" -> {{False, False}, {False, False}}, 
         "AxesOrigin" -> {0, 0.00019629629629651878`}, 
         "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
         "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
         "DefaultStyle" -> {
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.24, 0.6, 0.8], 
            AbsoluteThickness[2]]}, 
         "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), 
           "ScalingFunctions" -> {{Identity, Identity}, {
             Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
       "Meta" -> <|
        "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
         ListLinePlot, "GroupHighlight" -> False|>|>, 
      "DynamicHighlight"]], {{}, {}}}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], AbsoluteThickness[2], Opacity[1.], 
          LineBox[CompressedData["
1:eJwV0Xs4VGkcB/DB0FDmoFjKJbaL2znHalCi30tJhcp9pSa5JWrltqm15DKt
UpnaQumO1qhQTHlcNitqd9KVStuQtUg15pzJnbBn//g97/N5nu/3fX7v85qG
xvpEKLNYrChm/j+naHuzk5v7oK5/ll/r8h2MLHPGbu37AC1L8td4i2xAeeKG
1qKln0BGCqJaZSTYz4bc9S2XQXWjhcm9WgI8vRoz3GpkkPaySLzqLgFhhSZb
HJpkMHt1uKXhNgFCh64PC1/LYOuucG9JKQEfY4MNeqZlkFCVzhrJI+BCt3/K
fq9B6HboWi5MIECpaZPrCdkg5LCD9f7GCdDXKuOmjQ6CBbF45JgFAQRf/d1+
lhzOno5d57yUgG2TjxL8FsghbHqF7XVDAqpt3UoWOcnh1ojKqqNzCYgsAk5Z
jhxE7m57fv2IQ2sW7+lDSwouLktkVV/HwRF7rHzKjoJto1UdDtdwKD23yyEY
UXCnKcmj4SIOmeUnr1D+FISKA6ZbzzD5joF4/XQKFjfGpcxmMPnQtN96cijQ
sC3REabioDeoK72ZRwEdpe5sdggHhdJaN5ebFPQfXe3hEcfkrS5+E/2Ggj/9
LR0qdzL5uys8eT0UKG4++t4rGIcsJDk8I6Mg+dQ6jiwAhy+SEPGfYxTESF+v
O+6DQ2XZVOJGJRqCzvKCY7bg8IFan1uuRkNItqU9bMXB2O60aP48Gn4pVtXX
8cYh5755V6ceDRtbNhSLmX4TO3Hc1ZCGHw5fLj3ii8P4xvs6paY0PHpRszvQ
D4fIdn/3eGsalhdrScb9cXD9mFGp5kqDWVm5vXMQDgeJp5IYdxr0quUxmtuY
fRIM+p570vBgrdSkk7HxTIVBYSANBk/vLPxpOw4TOp0Z5D4atmQqvt5m3lvp
5OD/fQEN1IJXyVqROJgIP0+I5DQkpqq+FMXj8PuuNNGdIRoWrTX6IywBB/6K
+UF14zS4tI7tNUrE4cJrx5pWZQUESvNYwiQc9I2O/UjpKeB9y8Ca+GQcdMrM
h3iggL4tjr7WzH+oNkfI7ucqgIe1mR84isPnsfddr2y+ANuRY7rjMg7Fn+ok
3JNDoF0iTep8jAPX6Deqt3cYulN0Re+GcDi+Rxx5ZckoWIsNOWZ6BIyiG71R
aWMQtlfhbb6SgETb5mq9B+Og0Y+td/En4H15c84L00nQ7O6QfBtPwFR0e6HF
oSn4dGm5dDSHACuXOTORdV/hoXfbAfVrBLhfM919+5sZGDv7+h/6HgEHjHaa
/bN9FkTnrcdLJARYy/znvvFiocKg7GVZ7wiYj9Gc5kkW2vFZP8hRRgD7fmHF
txeU0FRVeEHmJAExvLq36h7KaKLV0auZQ8KNjaFXfh9VRhz7gelDuiSMfF6o
1Z+ngqpWPTgfsJgEsa+7ypl1bORSE0GutCIhbYPgcnU/GyVza81TeSSYdm7q
KBKoohUCg2XtTiQ4OmSdMbBVQ+dO98XbuJGw3fjZhFKbGkrSVPUI9GTul5zo
2Z8+B8m0tLOjfUkoYPMTfZZw0PmckR8PB5Ewv0t8TbmZgwZ+hgDWThJUf073
WxWnjuKEZE9cOAksEb+iR0cDBTwpZxvvISH+fMUJnSYNFNbpUvVwHwkNVtkc
7R/mokyzqX/lcSRob4q3zuDOQy1TC46mJZEgxZ+3Hayfh4TDfDvsIAmVl2BJ
L18T8b8s6tFLIWFHhb220Ywmeuf9lduWSsJhwdV0aRkXSev8jIXpJNwaMCrk
emJo9ebCv3szSci+KAjp2oyhY32CZ3LG4T6DS8u9MaRyr6pxnLFhfX2lVyCG
Gv7qzZ+XRcKx3OCHx0MxtGZMbsBjHGV/TqFxEEMmtXaxGYzNshZsmHMdQ6mG
JgmGAhJmVqZovinFUF2+2ehSxm8H/315/QaG+IGPkkjGwsCqHetvY8g4ghXj
ynjW0idBUM/0VTLxKMbSF7mXVNowFPLrdt0qxjVHxsLaXmEofKo9rJ7xmdU7
LYo6MCS7aVTRwtijhKh27cLQi1tWTh2Ma5Of/JX+EUO9scdtphnn4Xa53jIM
sfa9jVA7QkJczwU/UwpDpD23AGNs7rn3feMwhrTkjkOmjNlK7cXCMQxFNKw0
tGLcLV4dHTKJId2Flq48xvXRRaTNNIbihrUjnBnnm8wdmZ3F0BOnoaz1jP8D
v7ni1g==
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, {}},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
            Annotation[{
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              Line[CompressedData["
1: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
v7ni1g==
               "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4}, {0.0002236193227897292, 
              0.000263317108874266}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.0002236193227897297}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            Plot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0, 4}, {0.0002236193227897292, 
             0.000263317108874266}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.0002236193227897297}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          Line[CompressedData["
1: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
v7ni1g==
           "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0, 4}, {0.0002236193227897292, 
          0.000263317108874266}}, "Frame" -> {{False, False}, {False, False}},
         "AxesOrigin" -> {0, 0.0002236193227897297}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.00019629629629651878`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 4.}, {0.00019629629629651878`, 0.00039999999999999996`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.967874044359467*^9, 3.968550239466658*^9, 
  3.9702913581218576`*^9, 3.970845672313424*^9, 3.970845716367671*^9},
 CellLabel->
  "Out[8753]=",ExpressionUUID->"c45d9cc5-159a-49ca-91ed-5f92c71f59f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", 
    RowBox[{"-", "0.00011758888249729743`"}]}], ",", 
   RowBox[{"km", "\[Rule]", "3.135163410852413`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.0002571539361020251`"}]}], "}"}]], "Print",
 CellChangeTimes->{3.96787404438938*^9, 3.9685502394927187`*^9, 
  3.970291358158546*^9, 3.9708456724815187`*^9, 3.97084571638804*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"a878770a-e408-4dc4-b986-6651d605e733"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   8755, 1688, 22504012383303320814, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9678740444132566`*^9, 3.968550239509149*^9, 
  3.970291357755184*^9, 3.970845671922669*^9, 3.9708457164128036`*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"3ca688ec-e93a-4d26-91b8-26158c6c1b5a"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", 
      RowBox[{"-", "0.00011758888249729743`"}], "0.00007375681347625057`", 
      RowBox[{"-", "1.5942782362087895`"}], "0.14195798580788865`"},
     {"km", "3.135163410852413`", "3.2398815219265473`", "0.967678413434123`",
       "0.3560255483707123`"},
     {"ks", "0.0002571539361020251`", "0.00025809873818847173`", 
      "0.9963393773519469`", "0.34258275649736614`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.96787404438938*^9, 3.9685502394927187`*^9, 
  3.970291358158546*^9, 3.9708456724815187`*^9, 3.970845716422637*^9},
 CellLabel->
  "During evaluation of \
In[8752]:=",ExpressionUUID->"ab046562-7890-4fc5-b4b0-9f16dcf08f17"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.970845960166709*^9, 
  3.970845996207267*^9}},ExpressionUUID->"d09efced-26fd-4345-aeeb-\
3bb606cf0f1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"camPlot", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"camData", ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.0002", ",", "0.0004"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eq", "[", 
              RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", 
             "]"}], ")"}], "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0.0", ",", "10"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.0002", ",", "0.0004"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}]}], "]"}]}], "}"}], ",", 
      RowBox[{
      "PlotLabel", "->", "\"\<CaMKII\[Beta] Molecular Rate Estimation\>\""}], 
      ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Time (s)\>\"", ",", "\"\<Concentration (M)\>\""}], 
        "}"}]}]}], "]"}], ",", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Experimental\>\"", ",", "\"\<Fit\>\""}], "}"}]}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9685502024074163`*^9, 3.968550262109845*^9}, {
  3.9702913452313433`*^9, 3.970291375590527*^9}},
 CellLabel->
  "In[9563]:=",ExpressionUUID->"a0c53df5-3489-4f41-8cf7-ad5e8707306c"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[0, 0, 1], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            AbsoluteThickness[2], 
            
            LineBox[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
             0.0003285714285714285}, {0.6666666666666666, 
             0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
             1.3333333333333333`, 0.00020701754385964912`}, {
             1.6666666666666667`, 0.00021428571428571425`}, {2., 
             0.00021236363636363635`}, {2.3333333333333335`, 
             0.00021629629629629627`}, {2.6666666666666665`, 
             0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
             3.3333333333333335`, 0.0002545454545454545}, {
             3.6666666666666665`, 0.00027}, {4., 0.00027}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        StyleBox[
         DynamicBox[
          (Charting`HighlightActionBox["DynamicHighlight", {}, 
           Slot["HighlightElements"], 
           Slot["LayoutOptions"], 
           Slot["Meta"], 
           Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
              Annotation[{
                Hue[0.67, 0.6, 0.6], 
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]], 
                
                Line[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
                 0.0003285714285714285}, {0.6666666666666666, 
                 0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
                 1.3333333333333333`, 0.00020701754385964912`}, {
                 1.6666666666666667`, 0.00021428571428571425`}, {2., 
                 0.00021236363636363635`}, {2.3333333333333335`, 
                 0.00021629629629629627`}, {2.6666666666666665`, 
                 0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
                 3.3333333333333335`, 0.0002545454545454545}, {
                 3.6666666666666665`, 0.00027}, {4., 0.00027}}]}, 
               "Charting`Private`Tag#1"]}}, <|
            "HighlightElements" -> <|
              "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
             "LayoutOptions" -> <|
              "PanelPlotLayout" -> <||>, 
               "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
               "Frame" -> {{False, False}, {False, False}}, 
               "AxesOrigin" -> {0, 0.00020000000000000044`}, 
               "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
               "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
               "DefaultStyle" -> {
                 Directive[
                  PointSize[
                   Rational[7, 360]], 
                  AbsoluteThickness[2], 
                  RGBColor[0, 0, 1]]}, 
               "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                   (Identity[#]& )[
                    Part[#, 1]], 
                   (Identity[#]& )[
                    Part[#, 2]]}& ), 
                 "ScalingFunctions" -> {{Identity, Identity}, {
                   Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
               False|>, 
             "Meta" -> <|
              "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
               "Function" -> ListLinePlot, "GroupHighlight" -> 
               False|>|>]]& )[<|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.00020000000000000044`}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
          ImageSizeCache -> {{
           4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
         False]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[0, 0, 1]], 
            
            Line[{{0., 0.00039999999999999996`}, {0.3333333333333333, 
             0.0003285714285714285}, {0.6666666666666666, 
             0.0003176470588235294}, {1.001, 0.00021481481481481476`}, {
             1.3333333333333333`, 0.00020701754385964912`}, {
             1.6666666666666667`, 0.00021428571428571425`}, {2., 
             0.00021236363636363635`}, {2.3333333333333335`, 
             0.00021629629629629627`}, {2.6666666666666665`, 
             0.00021659259259259255`}, {3., 0.00023359999999999996`}, {
             3.3333333333333335`, 0.0002545454545454545}, {
             3.6666666666666665`, 0.00027}, {4., 0.00027}}]}, 
           "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.00020000000000000044`}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[0, 0, 1]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}, 
     InterpretationBox[{
       TagBox[{{{}, {}, 
          TagBox[{
            RGBColor[1, 0, 0], 
            AbsoluteThickness[2], 
            Opacity[1.], 
            LineBox[CompressedData["
1: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
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {}}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
       StyleBox[
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
              Annotation[{
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]], 
                Line[CompressedData["
1:eJwV13k0VV0UAHCeSIYyz48nMr93SQkNe5eSJJUhkgglRaRQiogm85AylAzR
pGjQpDJLRApJImUKGTMPfX3n/XXXb9179tpn73POvVfR2cviAI2Dg8OPk4OD
fU0948yjsz9i3SGn4nsdeoZQ3sAws2EcgpbzD3uZaobw721hKIPhD8e/ehuH
SBtCanGUAjcjDJRdGets5w3AY63vkSmFZJBLV9gXUGoADXNuCSMKd2Gy9d7U
5A4DWPitQ3VQ4SXABX+I89OHjOo0798KVSCUGrw0pkMPxpOearRHVoH9O4ZK
ymc9MD74vrN+pgq4Ha7lPXynBwNcU9YFDdVwrrHMnCNPD/TXmhuGXayB9g0O
SeoBevAxb56mOlwHSwYe/syU0oOgai1THccG0KTli//cvRJy88K+ebBaYKg0
1M51Thf6RfojTZ1aoFpgwrN0VBdU/UzXqSW0QNyx+QyVXl1IX8Of0TnTAn1h
Ebjwsy7EV0W62lV8A46HrW5qebrg1xkzutm+DSYeyj7u3q8LafzvQ4U3/YBU
GRVXnablcBA+JQ8c64THd+mnj3/QAY7MyYJvEZ2wRqi9tfatDiQtkGutzuqE
eZszF1hFOvCuylX+blMnWLuIX6Y91AE1q/nMA4Zd0GnR9mY8Tgd63VTvf+fs
hmolU1EOGx04HB9Y+DG2ByR/1ASmdmsDbSKzvehuDwTwFte8+K4NKTbvOPJK
e6Bq/4GKr1+0oVpO1ChqvAdCXSaTtKq1QfP2ncottr9g/dIgQfE8bRh41fCx
VKEXqC0/N434a4Nnt3pnfm4fLMiryS0Q1YYfDl95S6r6YHtFgMVfAW2wbL7E
qu3qA2eps1ObeLRB//0v/26ZfkiqWG5eP0oB16NsIYmL/RAtJhMz8JqCpADF
dSccf4N/oJ+WjTUFfJMfXUJP/QaaHQckm1AQ6BUcFnPlN6QK1rf2rKbA2bm9
8fb73zBbWRSatZQCLZNU9+ZVA/BRo5fjzggLSkSlkw2EBmEuP6yqLJoFK6Le
FW7SHIQrytxaL0JYcIvnZNdO40GYybwMz/1YEDnTRB0OGAThFHujzw4s2NWe
8DaldxAEA/tsYikWvLPdOHCLawhGi041fFViwer6MeEn8kOgXL9xmCnFAkaF
xd73VkNAtyr9PMHBgv57QuNzxUPQsUeWxtXABHvlYmne1iF4e0tTKb2SCXWp
XiA2NQRG6X+CN79mQn7sh3At5jA8ju4szs9mgirfmYf6JsPgN6cVfiqFCSmh
zKaNLsPgz+PhYBrDhCC/SMW9ycPQ0bNocqE/E/4Mr958KH8YZFdcSp84woT9
h357+NYNg+GS1cqDzkz40pESf7Z/GJateOwzZMOEZaxlrW9pIxD6QH46ezsT
vvfPD5kJjUBlJG/Gs51MSLrdyNlAH4G771yVyyyZwKd4TrVdfwRKWOOPWsj4
d2viqDObRsBlXFe4bDcTLtjeWEW3GIGhv0cz7uxhAi32xeY97iPw3vvFKQ9H
Jsz+N3DwS+oIjA1bSre7MuF3q/WdOtoo6PQneMT6MqEmSVW9uGYUzuTaxLfG
MSFa6L1Gxr4xML1xsmXLWya8XEV/au45Bn3MfTYzpH5dDl4wf3oMnHOa3G5X
MWH1A1Erm8QxsE0phX81TOjdYh8o+GEMgrw/+6eS+huFDtb5rx4HNfMfHPE/
mDA9scTXQmIC0p+I+FjNMMH5m1URV80k2F2wHutTYQHftZ9HvL9Ows77+cmG
aix4bOcp194zCf7Me6bh6izgarnoX8A5BTvCIopUtFiQ1Vyg671qCtpuRF+z
1GFBz2fGne+ZU+D+r3b7qdUsOPxxIPal/zRkH3Qx6jZngXfFOWcv1VnY+Tm0
IeEYC+S7jHkmdWdB5PuaLbHHWfCetuheAM6Cqavhz3AfFizDqNGw3bOgId/i
G0jW69eCK8FZEbMgvDV6qe0pFqx/eOvG1+FZiE1oEeo8ywLha+9ajF7MQRXP
Avq+WBY8OipgKbXlLzg+DpNZnsOCmhRR/we7/kLoyy8rFt8n+ZbLpG3Y/xdW
nt8S3EcsI63+2yPoL3D2ij9IzWXBuZJNoSVP/4LAN1r8/COyP0SCnhxe+h8M
Nhm5XnnBgtkno6Jv5v6DeZWiMwYVLMg47d6vbcOB7qYdE76tLNAuXjR9cS8H
uolfWy7dxoLiBXe42104ULtdte0V8Y+oLkbUUQ68db38zL/vpB7pe236wjjw
7d81i4J/siClfHt5xmsO/L3tVZdrDwviBVfcEFnKiSs/BNI+DbMgJG1+5/gA
J26MT1y7npOCHdovvDXHOJGnbKdpGbF8yfE45xlOlHlDn9lIo6Cgo//jR24a
Rm1oWbeZi4I/y75ufyBPww3yjX7G3OR8uf90m+sOGqY4bi1nLaJg/UvPLc1P
aNhWGJiXI0QBR8MPfH2KC69fTUsKlKfgXF9hxqmzXPjtRb/nMPEijlSawSUu
PLH/1a99ChSIMHeXP73ChSu4T5ZvYFCw7OKnzXkPubBWQ92IRs4v09Wl5pk9
XNg0WSzrvYyCyzdv2l+yWIC8Sa+2CGpRoOLjetJKgxuTDlq5K+hTwDRst0zT
5kaV+iQDH+IVHLZUvx43XtnTVvKOeEPklp4gI26U2nOf5m1AgUOWllWOPTeG
z5tYFxpScLXxD0WL4cblJvlvzNZSwL0y6FfeGDfOzi6+smYDBV0Tibv43/Dg
ic/XJQ5upSBzve7xtjIePNk2/d8jYseoDzF51TzoaKSeNk/cosxdZdnMg9uE
lBbFmVHwyfLY6utjPFhKWxf/bBsFhY/MGEyNhXilX3N4fDsFiUc4+80TF6JZ
9etzG6zI/LsPB8Z78yLLxzjawJ4C40Cl+xtP8uLK7UqXfIg3iLe2TJ7hRfcF
Z03yiA03bdPfE8mLtQxteeW9FGhkU2NKt3lxr7SvKr8DBfwHxt2etvKiaNVu
Wp0jBTVdgVbNmxehmXyko7YLBeZdsZry8nwYevrcryOHyH3NrkZ7ZT689WdS
JYV46/FVZ65p8KHlj2Mmb4lNaN8/Sq3iQ62MOhX5wyQfhqaf6A4+VMkJ5awh
XmlfUcwbwoeaCjw7GR4UyDXOWI918+EWKVrrfU8K+sucg9894MeEzxsKnY5T
oBDXfDg6nx/XWy8JvERs5WBubfWKHysy02XziAunDTR+vONHpp7WzBxxPFO4
caqTH4+oZKxN8KFgdWKRqqqMAOp5fFIv8qUg8rBc3fkLAnjZYtnPvycoYAk3
0Y0cBXEywTNBKoCCnqiekCsHBJHT9PHRlcSpfFO/frkL4twJqZUWxAILpB5H
nhTEeqdZvwji/sndxk1xgpjl/KVznji7tc3zULkgPqkQvPQtkMzvTndRjPpi
1DuprhkWRN7XMOHUOrYYPdLdWrNCKDi5Xo332exi9LyBRoXEPUZ7cmM4l2DN
gva4L8SlJiWzG5YsQT8B6V+LQik4ZRF1+a7GEgwTU/M7Qvz7wLIKP6cl+M6r
Y6v2OdKfSGs14bolePby1n/Z5ynYPGg3tdRaCLnypm/aXqLghlhoQ5CtEBrJ
Nl3xIB5fnZPXukcI30Tt8QkmTg+fO3jVWQhHdFumbhPPql5vXnRUCFds5ZWb
JL7v3PZyJFwI9zWuHI8Oo0Co2TGgsFgI46o3v34STkFz6X5OOy1h9Neo8fwY
ScHI+haZQEoY3fmC3NqJF5ZsX5G+XBjXf4ixGiLWKzI82KMvjEZNXAsEoihI
eCVUe2yTMDq+KCsxJt6e/zopwkEYi0yFK14Sv80W034TK4y+TTbmV6MpeHqp
3IExIYwZ87oXtWIpuGP6XuriNIn/Lz7cgDhFoL5+cE4YrbOlQ4yJg2PbjV/R
RJDXtGfbPmKzpFnWLiERHJ4+YXeZuOO29r8ITRHcsdDaZop4ceX1tCknESwp
eObwPI4CV27fHx8+iOAAj8BW2csUyChUfZn7JILjfyj5ZcQf9Ol1ap9FMDfT
u5dFrOdR8SbkmwjeW3zceQMxT4P4Nb1eEaxx9hp0I85Of2Z9g1MUd5rZHswn
7lo9XX1khSiO3FmruSmBApdjp58KpIgi14P+ie1XSLzl35+qp4qi+JzxIxti
vj/4zDhdFHXCzV0diR968zwPviWKxwVD3ngSzx+NezH+WBQjxY8oRhFf9br9
qvW9KCYl9rx9R1zl0VBy/68oyhfRKlZfpYA6qPnBzEkM327AdSKJFHw/pOD1
YL8YJkoVq0kTR3qICi12E8M2E21BBnGf99zOOk8x9FT6U8Ykvhnw/vPOADGU
zPHsMyGWjHdv25Uohrq2HZJniP+9zhnYVyuGKpWeCl3EdSJa/L4G4ujfNVKY
lkTBuiNH+q6tEcdJwYBfWcS5lbmVpSCOan5Z/PeIowN0zgkZi+MSuxbjfGKz
Hr2/ORbimNOwKuwdcfXL9cMd7uKocD8LR4gr9tk07LhBxnfciFuTTMGr3JBr
WlwSuDvllFs1MY+ZtUwijwQOHI3gqSPe2aeazMknga/7n2Q0EP9Sqr3aJCSB
6aab61qJRZMl44PlJfDQNtuFw8TuofcvNRoQD6n2i6RQIGvb5BtwVAIPSGce
syU+zamxo6ZNAv0Gl+1oIe7ZyN+s8lMCabGm0t+Jd1wacDzbJYErIuzbfxIr
L8nz0vstgb+3bnTuI66RWxGTPi2Bawy4jaaJ5fXXffARlUS1Zgcv8WvkfPC0
MKNvkUTFWk6PbcRaj3UbT5hJovfj0o87iK9OiNnXb5dEhzHz5VbE7gFf3C/u
kkQvk4rfdsRi4fYRoy6SuCCEX9+N2DXbtbrijCQWbBZaGULM13rKxDNfEk3L
Il4+IdY7cVcw5rkk7g3bE/KM2EmkuT6vQBIffDcyeUn8wmTl3tFiSfQpt3tf
yI73dNjbp1YSP9qF5VYRl0Tvv3aqRxJXZan1fr/GPv/Mhy5ISaHZyoNLF16n
oPuWYkJagBRaC7qeNydOUJNe8NJaGleePSTcRmzvoHK701Yag/G6ZDuxcoKu
6WJ7adwjxEn/SZz/b1usi7M01vltX9ZN3NgUIrfYSxrVj53XHCQWPT+wwuWS
NG4qvMD3lzj+Z9EBwVfSqBjmMi6bSoGdZC2vfqE0ukW7NdOJl25ryXEukcYy
M7FXCsSPX4yPPq+Uxrdh5gFKxPUx6mecG6XxhFTjoAax8LrLV58PSiND2SrM
gDg2xbXSiSGDVz/dD7UmPuEXcjxASQajnidr2hA7WNxQSFSRwezZ/E+2xFp8
TSdqtGQwlnKVsieu8t+ktspAButOYIwzMW23cpiAhQzmpK5V8CL2lewwfR4q
g6/lbuZcILYf+zv56YIMnp50E75EvLFO+uZAmAwye7/6hBGLXNw5pxgrg6X3
7q+IJM6dLM6JvC6Dah8zE+OIez+nCTg/lcHbzw1/XWPXI2HvB4FfMmjyxSk2
l1juCZ+se78MJi7tKMgjbv/0/GDVoAwmZfB2PCTev0SE88K4DBYa6ao8IfYM
f6v7j1MWBWw9zj8nDgmmkkflZHHN6y8pRcR3PTj3N1nI4nq77m0fiKc3Zs+k
Fcpi9pEXlweJA16lhZaXyGLEH+5zQ8Qcy1ME+8pl0ScrwmeYeKFCjOLy97J4
S1ln1yixxMzJLeVfZHEoJ0h2glj3gVly74gsCp/lypln5yM+rq+jJIc9qe7l
/DfI92zEUKm1ihxaS5flCxD70vrMTqnLYZBHe5YgccBw274ySg7tKdtzS4gj
qiovWa+Rw+Q13SBKfCfwWrO/tRyqMoxvyRB3dm84WXpRDptceiXUiTekfcjU
iJBD26ef+TWI023tauOj5XD8+sQ/th3eey91uSKHBR8LurWIWx6m13DdlEMV
w5Zb2sT1p/9jbCqUw944t7lVxKXCBVWV43Kog2m1m4gV328ap6blMLd/Js2Y
OPjcJ/mkOTnUXjt+dDPxuqne4240OgYFPF28hbigVVJ+kRAd/zT06ZsRP77t
e8xUk46JLuIbLYiFnThTH7PoeCnO6D+2j8pEVcosp+PxkcpnlsSsqCy53/p0
PNpZvNSa+N6xhrcRxnR8IzjWbUOcuVZHttaJjhyjluJ72fma84XO7adjavm+
O2x3OHb2q7vRse5CgYEDsVLIlYILnnRs6thk40ic9XZmN56m4w0zy0An4vIv
9SWeZ+go0etAcybu6s1RTz1Lx96w5PNsK/M7zMxcpOPpgcgLLsTZ20uTniTQ
MT6Y69gB4h5vHzehayTeT1N7V2KVBBX9Ixl05K6sXHeQ+FZz+BeVXDpOB/b/
dmM/P7vmdmg+HQWDrJ4dIlalD/v9KKBjtEvAycPsfjtZSqRU0vH3yuhOd+Le
UO6eyVo67rBcE+lBrHbr+VPLRjrqPtHWOkJ8t1/WWvAnHcswytKTXa/jXZeD
Z+kYpnMo7Sjxg/O+wgeZ8si3o9jLl/iitctWrgl5zDzkdTuM+PUWa8/KOXlM
zTi0K5y9XtdujougKSA98OOCCGJ7Fc0vokIKuGok1zGSePnUH2dlTQV8cNZQ
IIb4e1LIqU1OCmit1r8igVgsyid1kZsCCqkeb2R7y1nX4lpPBQxZknDsCnH+
IVOeXQEKKOHldu8qcbihSLxrogI2Kv3iSSZe2Zpx92KtAroaphxMZfdL6VWX
WosCXjw8uvsGO757o0J1jwI2ZVptTCOeDeDaysPBwP9Mu/+ls9cbI7Z3Fw8D
7aoPfMwgPlwud+G2AAN7jyYlZhJ/5dcrMZFmYLpFAW8WcWxeqUOyAgPNUucf
sW1iuX2+bxkDWazEHdnEHFPfkg21GLgoSreL7RcpbqsiljPwxvrTHrfY/eg4
e0wLGDhT/Xj3beIk9WsParcy0OmlttQd9n4PmDkcuJuB78NVvrBtUWejxjzI
wFdUddxdYgFfsZuRIQw8Eaw7e484qDgqaetLBh4XNUx6QNyco3Lq1VsGcv31
W57Lrn9i0R7NRgZ6db94x3bPkVF5/mEGlg069+UR4+5wjtPzDGTkNB1/SJyy
Uamjf5Eirs90nWV7m6x1drWyIr48+WfuETHfw1GL1rWKKC9w6Ptj4sqN0RxD
uxRxwfTzJ0+Iz33VyP3npYg8YwsC8onXe1buEQ5TxJInvquesvOTHiI/J4p4
mWk2zvbRCrFizyJFFIYHac+Ieb1XH0ttUcS/eMXgOXGanLNyzYQi3u9nlLPd
MXxub5TaUnQI/5v1gr3fym5fNd+zFLXPHTrwkthuOn+fUNRSDNasX1LA7hez
VKO+cCnOftB/yrbr2IJPVRpKKPlc2Pg18f76uZPqe5UwuOO0xBti50d/GGEx
SpjTBW1sx9YLRJVXKuH6wR+JhcSFYyoz//4pobqmnmgR8f+XpkK2
                 "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, 
              "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0.00020000000000000044`}, 
              "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
              "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
              "DefaultStyle" -> {
                Directive[
                 Opacity[1.], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> Plot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.00020000000000000044`}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                Opacity[1.], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> Plot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
        False]}, 
      Annotation[{{{{}, {}, 
          Annotation[{
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]], 
            Line[CompressedData["
1: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
             "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, 
          "PlotRange" -> {{0., 4.}, {0.0002, 0.0004}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {0, 0.00020000000000000044`}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              (Identity[#]& )[
               Part[#, 1]], 
              (Identity[#]& )[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]}, 
    AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
    Axes -> {True, True}, AxesLabel -> {
      FormBox["\"Time (s)\"", TraditionalForm], 
      FormBox["\"Concentration (M)\"", TraditionalForm]}, 
    AxesOrigin -> {0, 0.00020000000000000044`}, DisplayFunction -> Identity, 
    Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.24, 0.6, 0.8], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.95, 0.627, 0.1425], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.455, 0.7, 0.21], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.578, 0.51, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.4, 0.64, 1.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1., 0.75, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.8, 0.4, 0.76], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.637, 0.65, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
      "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
      "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& )}}, PlotLabel -> 
    FormBox["\"CaMKII\[Beta] Molecular Rate Estimation\"", TraditionalForm], 
    PlotRange -> {{0., 4.}, {0.0002, 0.0004}}, PlotRangeClipping -> True, 
    PlotRangePadding -> {{0, 0}, {0, 0}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Experimental\"", "\"Fit\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>, 
                "RGBColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>, 
                "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& ), Editable -> True], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.968550231358493*^9, 3.968550262803948*^9}, {
  3.970291346595942*^9, 3.970291376202579*^9}},
 CellLabel->
  "Out[9563]=",ExpressionUUID->"98c4bdbf-bbd8-4a09-97bc-4b3d577e91e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", 
    RowBox[{"-", "0.00011758888249729743`"}]}], ",", 
   RowBox[{"km", "\[Rule]", "3.135163410852413`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.0002571539361020251`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.968550231398458*^9, 3.968550262832082*^9}, {
  3.970291346667542*^9, 3.9702913762349033`*^9}},
 CellLabel->
  "During evaluation of \
In[9563]:=",ExpressionUUID->"f999af07-c59d-4b7d-92a8-cc335d7603c9"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   9565, 564, 22500800256113988132, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{{3.968550241068838*^9, 3.968550262832999*^9}, {
  3.970291346423029*^9, 3.9702913762358522`*^9}},
 CellLabel->
  "During evaluation of \
In[9563]:=",ExpressionUUID->"7b0d9ba7-d842-4925-912c-216afede096f"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", 
      RowBox[{"-", "0.00011758888249729743`"}], "0.00007375681347625057`", 
      RowBox[{"-", "1.5942782362087895`"}], "0.14195798580788865`"},
     {"km", "3.135163410852413`", "3.2398815219265473`", "0.967678413434123`",
       "0.3560255483707123`"},
     {"ks", "0.0002571539361020251`", "0.00025809873818847173`", 
      "0.9963393773519469`", "0.34258275649736614`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{{3.968550231398458*^9, 3.968550262832082*^9}, {
  3.970291346667542*^9, 3.970291376238998*^9}},
 CellLabel->
  "During evaluation of \
In[9563]:=",ExpressionUUID->"58a23469-9d5f-4895-83fd-0da4b66963d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cofData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", 
       RowBox[{"1.9", "/", "1.65"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8", ",", 
       RowBox[{"3.5", "/", "2.3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.075", ",", 
       RowBox[{"4.875", "/", "2.9"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5", ",", 
       RowBox[{"5.", "/", "3."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.75", ",", 
       RowBox[{"4.9", "/", "2.8"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"4.25", "/", "2.775"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.33", ",", 
       RowBox[{"3.9", "/", "2.45"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.67", ",", 
       RowBox[{"3.5", "/", "2.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.", ",", 
       RowBox[{"3.125", "/", "2.2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.25", ",", 
       RowBox[{"3.", "/", "2.1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.67", ",", 
       RowBox[{"3.", "/", "2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.", ",", 
       RowBox[{"2.95", "/", "2."}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cofData", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
    RowBox[{"64.", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{"ParametricNDSolveValue", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "influx", ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"HeavisideTheta", "[", 
               RowBox[{"t", "-", "1."}], "]"}]}], ")"}]}], "+", "ks", "-", 
           RowBox[{"km", " ", 
            RowBox[{"m", "[", "t", "]"}], "*", "0.1"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"m", "[", "0", "]"}], "==", 
         RowBox[{"64.", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}]}]}], "}"}], ",", "m", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0.0", ",", "10."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ks", ",", "km", ",", "influx"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"cofData", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"0", "<", "km", "<", "10."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"influx", ",", "km", ",", "ks"}], "}"}], ",", "t"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", "cofData", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], "/.", 
       RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[19913]:=",ExpressionUUID->"95caf223-cb66-440c-bd6c-ace8f7964bdd"],

Cell[BoxData[
 GraphicsBox[{{{}, 
    InterpretationBox[{
      TagBox[{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
          LineBox[{{0., 0.000064}, {0.2, 0.0000736969696969697}, {0.8, 
           0.00009739130434782609}, {1.075, 0.00010758620689655173`}, {1.5, 
           0.00010666666666666665`}, {1.75, 0.00011200000000000001`}, {2., 
           0.00009801801801801802}, {2.33, 0.00010187755102040815`}, {2.67, 
           0.00009955555555555554}, {3., 0.0000909090909090909}, {3.25, 
           0.00009142857142857142}, {3.67, 0.000096}, {4., 0.0000944}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]},
       {"WolframDynamicHighlight", <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
      StyleBox[
       DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
            Annotation[{
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              
              Line[{{0., 0.000064}, {0.2, 0.0000736969696969697}, {0.8, 
               0.00009739130434782609}, {1.075, 0.00010758620689655173`}, {
               1.5, 0.00010666666666666665`}, {1.75, 
               0.00011200000000000001`}, {2., 0.00009801801801801802}, {2.33, 
               0.00010187755102040815`}, {2.67, 0.00009955555555555554}, {3., 
               0.0000909090909090909}, {3.25, 0.00009142857142857142}, {3.67, 
               0.000096}, {4., 0.0000944}}]}, "Charting`Private`Tag#1"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0, 4.}, {0.00006133333333355552, 
               0.00011200000000000001`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0.00006133333333355552}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.24, 0.6, 0.8], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4.}, {0.00006133333333355552, 
              0.00011200000000000001`}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.00006133333333355552}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>],
        ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}],
       Selectable->False]},
     Annotation[{{{}, {}, 
        Annotation[{
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          
          Line[{{0., 0.000064}, {0.2, 0.0000736969696969697}, {0.8, 
           0.00009739130434782609}, {1.075, 0.00010758620689655173`}, {1.5, 
           0.00010666666666666665`}, {1.75, 0.00011200000000000001`}, {2., 
           0.00009801801801801802}, {2.33, 0.00010187755102040815`}, {2.67, 
           0.00009955555555555554}, {3., 0.0000909090909090909}, {3.25, 
           0.00009142857142857142}, {3.67, 0.000096}, {4., 0.0000944}}]}, 
         "Charting`Private`Tag#1"]}}, <|
      "HighlightElements" -> <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
       "LayoutOptions" -> <|
        "PanelPlotLayout" -> <||>, 
         "PlotRange" -> {{0, 4.}, {0.00006133333333355552, 
           0.00011200000000000001`}}, 
         "Frame" -> {{False, False}, {False, False}}, 
         "AxesOrigin" -> {0, 0.00006133333333355552}, 
         "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
         "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
         "DefaultStyle" -> {
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.24, 0.6, 0.8], 
            AbsoluteThickness[2]]}, 
         "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), 
           "ScalingFunctions" -> {{Identity, Identity}, {
             Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
       "Meta" -> <|
        "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
         ListLinePlot, "GroupHighlight" -> False|>|>, 
      "DynamicHighlight"]], {{}, {}}}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], AbsoluteThickness[2], Opacity[1.], 
          LineBox[CompressedData["
1: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
dRVDZoIJlg3jfwC8LhUe
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, {}},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
            Annotation[{
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              Line[CompressedData["
1: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
dRVDZoIJlg3jfwC8LhUe
               "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4}, {0.00007562068543431767, 
              0.00010914837884829599`}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0.00007562068543431784}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            Plot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0, 4}, {0.00007562068543431767, 
             0.00010914837884829599`}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0.00007562068543431784}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          Line[CompressedData["
1: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
dRVDZoIJlg3jfwC8LhUe
           "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0, 4}, {0.00007562068543431767, 
          0.00010914837884829599`}}, 
        "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0, 0.00007562068543431784}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.00006133333333355552},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 4.}, {0.00006133333333355552, 0.00011200000000000001`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9678740672234488`*^9, 3.968222181200687*^9},
 CellLabel->
  "Out[19917]=",ExpressionUUID->"f79feec5-3e1d-4e31-b3cf-ba017a20ecfa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", "0.000046645851434562996`"}], ",", 
   RowBox[{"km", "\[Rule]", "3.3940933558614113`"}], ",", 
   RowBox[{"ks", "\[Rule]", "0.00002830668121874591`"}]}], "}"}]], "Print",
 CellChangeTimes->{3.967874067253796*^9, 3.9682221812790213`*^9},
 CellLabel->
  "During evaluation of \
In[19913]:=",ExpressionUUID->"7cec5cf5-41ef-41e3-9359-c69e99e8b6b1"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   19919, 355, 22485564841664108071, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.967874067254629*^9, 3.968222181279849*^9},
 CellLabel->
  "During evaluation of \
In[19913]:=",ExpressionUUID->"20349eb2-9cd8-4be6-a506-6d09ffc9e03d"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", "0.000046645851434562996`", "5.410997282199489`*^-6", 
      "8.62056456542927`", "6.084878939664648`*^-6"},
     {"km", "3.3940933558614113`", "4.176819599869469`", 
      "0.8126023340743471`", "0.4353645506462488`"},
     {"ks", "0.00002830668121874591`", "0.00004183084777963942`", 
      "0.6766939405068378`", "0.5139476163232225`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.967874067253796*^9, 3.968222181283346*^9},
 CellLabel->
  "During evaluation of \
In[19913]:=",ExpressionUUID->"e151f8fe-c29b-421e-b4ce-fc16e3fb2d46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"3.3940933558614113`", "/", "60."}]], "Input",
 CellChangeTimes->{{3.968698075082933*^9, 3.968698113763206*^9}},
 CellLabel->
  "In[9571]:=",ExpressionUUID->"f09b232e-0de0-4cb2-9caf-b90ed4d1ef4d"],

Cell[BoxData["0.05656822259769018`"], "Output",
 CellChangeTimes->{{3.968698076109498*^9, 3.9686981141100407`*^9}},
 CellLabel->
  "Out[9571]=",ExpressionUUID->"c4b36a38-d047-41f5-a9b5-e55ffe6d1134"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aip1VolPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1389", ",", "1170"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1415.5", ",", "1142.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1436.5", ",", "1097.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1460.5", ",", "1049.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1484.5", ",", "1034.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1505.5", ",", "1016.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1529.5", ",", "1010.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1550.5", ",", "1013.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1574.5", ",", "1022.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1598.5", ",", "1028.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1622.5", ",", "1049.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1640.5", ",", "1073.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1667.5", ",", "1094.5"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aip1ConcPoints", "=", 
   RowBox[{"{", 
    RowBox[{
    "1170", ",", "1142.5", ",", "1082.5", ",", "1025.5", ",", "992.5", ",", 
     "983.5", ",", "974.5", ",", "974.5", ",", "980.5", ",", "995.5", ",", 
     "1025.5", ",", "1055.5", ",", "1076.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aip1VolPoints", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}], "-=", "1322.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aip1ConcPoints", "=", 
   RowBox[{"aip1ConcPoints", "-", "1220.5"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aip1ConcPoints", "*=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aip1VolPoints", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "-=", "1220.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aip1VolPoints", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aip1VolPoints", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"aip1ConcPoints", "/", 
    RowBox[{"aip1VolPoints", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aip1VolPoints", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"aip1VolPoints", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "1"}], "]"}], "]"}], "/", 
     RowBox[{"aip1VolPoints", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "1."}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.968220675798192*^9, 3.968220828912031*^9}, {
   3.968220989902257*^9, 3.9682210751539803`*^9}, {3.968221105700871*^9, 
   3.968221108518694*^9}, {3.968221141159556*^9, 3.9682211974510612`*^9}, {
   3.968221282173036*^9, 3.9682212883671627`*^9}, {3.9682215330079117`*^9, 
   3.968221579496172*^9}, {3.968221689394291*^9, 3.968221762866744*^9}, 
   3.968221868860111*^9, {3.9682402305550327`*^9, 3.968240235058523*^9}, {
   3.972370718792232*^9, 3.972370718926519*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"806c3999-487b-4f7b-8daa-abf4ec0b050d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"aip1Data", "=", "aip1VolPoints"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aip1Data", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "2"}], "]"}], "]"}], "*=", 
    RowBox[{"5.", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{"ParametricNDSolveValue", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "influx", ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"HeavisideTheta", "[", 
               RowBox[{"t", "-", "1."}], "]"}]}], ")"}]}], "+", "ks", "-", 
           RowBox[{"km", " ", 
            RowBox[{"m", "[", "t", "]"}], "*", ".1"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"m", "[", "0", "]"}], "==", 
         RowBox[{"3.", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}]}]}], "}"}], ",", "m", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0.0", ",", "10."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ks", ",", "km", ",", "influx"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"aip1Data", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"0", "<", "km", "<", "10."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"influx", ",", "km", ",", "ks"}], "}"}], ",", "t"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", "aip1Data", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"eq", "[", 
         RowBox[{"ks", ",", "km", ",", "influx"}], "]"}], "[", "t", "]"}], "/.", 
       RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}], "]"}], 
  ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.967873003942505*^9, 3.967873005200593*^9}, {
  3.968220289802272*^9, 3.968220290067155*^9}, {3.968220637068512*^9, 
  3.9682206385540867`*^9}, {3.9682217908281517`*^9, 3.9682218137891617`*^9}, {
  3.968255356984321*^9, 3.968255357098727*^9}, {3.9701561364785233`*^9, 
  3.970156158139147*^9}, {3.9701562795989017`*^9, 3.970156296549746*^9}, {
  3.972370724558199*^9, 3.972370730932852*^9}, {3.976844229318218*^9, 
  3.976844229453833*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"249aaeb2-7cca-4145-8f62-caacf4667c49"],

Cell[BoxData[
 GraphicsBox[{{{}, 
    InterpretationBox[{
      TagBox[{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
          LineBox[{{0., 4.9999999999999996`*^-6}, {0.3984962406015038, 
           4.9999999999999996`*^-6}, {0.7142857142857142, 
           5.609756097560976*^-6}, {1.0751879699248121`, 
           5.701754385964911*^-6}, {1.4360902255639099`, 
           6.129032258064516*^-6}, {1.75187969924812, 
           5.808823529411765*^-6}, {2.1127819548872178`, 
           5.857142857142857*^-6}, {2.4285714285714284`, 
           5.942028985507245*^-6}, {2.789473684210526, 
           6.06060606060606*^-6}, {3.1503759398496243`, 
           5.859374999999999*^-6}, {3.511278195488721, 
           5.701754385964911*^-6}, {3.7819548872180446`, 
           5.612244897959183*^-6}, {4.1879699248120295`, 
           5.714285714285714*^-6}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]},
       {"WolframDynamicHighlight", <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
      StyleBox[
       DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
         Slot["HighlightElements"], 
         Slot["LayoutOptions"], 
         Slot["Meta"], 
         Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
            Annotation[{
              Hue[0.67, 0.6, 0.6], 
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              
              Line[{{0., 4.9999999999999996`*^-6}, {0.3984962406015038, 
               4.9999999999999996`*^-6}, {0.7142857142857142, 
               5.609756097560976*^-6}, {1.0751879699248121`, 
               5.701754385964911*^-6}, {1.4360902255639099`, 
               6.129032258064516*^-6}, {1.75187969924812, 
               5.808823529411765*^-6}, {2.1127819548872178`, 
               5.857142857142857*^-6}, {2.4285714285714284`, 
               5.942028985507245*^-6}, {2.789473684210526, 
               6.06060606060606*^-6}, {3.1503759398496243`, 
               5.859374999999999*^-6}, {3.511278195488721, 
               5.701754385964911*^-6}, {3.7819548872180446`, 
               5.612244897959183*^-6}, {4.1879699248120295`, 
               5.714285714285714*^-6}}]}, "Charting`Private`Tag#1"]}}, <|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, 
             "PlotRange" -> {{0, 4.1879699248120295`}, {4.937275985885137*^-6,
                6.129032258064516*^-6}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 4.937275985885137*^-6}, 
             "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
             "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
             "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.24, 0.6, 0.8], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4.1879699248120295`}, {4.937275985885137*^-6, 
              6.129032258064516*^-6}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 4.937275985885137*^-6}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>],
        ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
         4.503599627370496*^15, -4.503599627370496*^15}}],
       Selectable->False]},
     Annotation[{{{}, {}, 
        Annotation[{
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          
          Line[{{0., 4.9999999999999996`*^-6}, {0.3984962406015038, 
           4.9999999999999996`*^-6}, {0.7142857142857142, 
           5.609756097560976*^-6}, {1.0751879699248121`, 
           5.701754385964911*^-6}, {1.4360902255639099`, 
           6.129032258064516*^-6}, {1.75187969924812, 
           5.808823529411765*^-6}, {2.1127819548872178`, 
           5.857142857142857*^-6}, {2.4285714285714284`, 
           5.942028985507245*^-6}, {2.789473684210526, 
           6.06060606060606*^-6}, {3.1503759398496243`, 
           5.859374999999999*^-6}, {3.511278195488721, 
           5.701754385964911*^-6}, {3.7819548872180446`, 
           5.612244897959183*^-6}, {4.1879699248120295`, 
           5.714285714285714*^-6}}]}, "Charting`Private`Tag#1"]}}, <|
      "HighlightElements" -> <|
        "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
       "LayoutOptions" -> <|
        "PanelPlotLayout" -> <||>, 
         "PlotRange" -> {{0, 4.1879699248120295`}, {4.937275985885137*^-6, 
           6.129032258064516*^-6}}, 
         "Frame" -> {{False, False}, {False, False}}, 
         "AxesOrigin" -> {0, 4.937275985885137*^-6}, 
         "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
         "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
         "DefaultStyle" -> {
           Directive[
            PointSize[
             Rational[7, 360]], 
            RGBColor[0.24, 0.6, 0.8], 
            AbsoluteThickness[2]]}, 
         "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), 
           "ScalingFunctions" -> {{Identity, Identity}, {
             Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
       "Meta" -> <|
        "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
         ListLinePlot, "GroupHighlight" -> False|>|>, 
      "DynamicHighlight"]], {{}, {}}}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], AbsoluteThickness[2], Opacity[1.], 
          LineBox[CompressedData["
1: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
           "]]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, {}},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
            Annotation[{
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]], 
              Line[CompressedData["
1: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
               "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 4}, {4.191551255325268*^-6, 
              6.155851887644907*^-6}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 4.191551255325277*^-6}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               Opacity[1.], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            Plot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0, 4}, {4.191551255325268*^-6, 
             6.155851887644907*^-6}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 4.191551255325277*^-6}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]], 
          Line[CompressedData["
1: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
           "]]}, "Charting`Private`Tag#1"]}}, {}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0, 4}, {4.191551255325268*^-6, 
          6.155851887644907*^-6}}, 
        "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0, 4.191551255325277*^-6}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           Opacity[1.], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 4.937275985885137*^-6},
  DefaultBaseStyle->{"PlotGraphics", "Graphics"},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> Automatic, "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentSet", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotInteractivity:>True,
  PlotRange->{{0, 4.1879699248120295`}, {4.937275985885137*^-6, 
    6.129032258064516*^-6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.9678740683243227`*^9, 3.968220292056905*^9, 3.968221661416699*^9, {
   3.968221793575405*^9, 3.968221814299768*^9}, 3.968221874554587*^9, 
   3.968240243479823*^9, 3.968255362282979*^9, {3.970156159580378*^9, 
   3.9701561660338497`*^9}, {3.970156286290629*^9, 3.970156297699071*^9}, {
   3.972370720898116*^9, 3.972370732193981*^9}, 3.976844230824051*^9},
 CellLabel->
  "Out[501]=",ExpressionUUID->"5086c8bf-8a0b-4fc0-9f88-0e91d78c9151"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"influx", "\[Rule]", "3.250619866587586`*^-6"}], ",", 
   RowBox[{"km", "\[Rule]", "0.5511683011308086`"}], ",", 
   RowBox[{"ks", "\[Rule]", "1.6550783633022047`*^-7"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.9678740683535357`*^9, 3.968220292140912*^9, 3.968221661496167*^9, {
   3.9682217936584883`*^9, 3.9682218143795633`*^9}, 3.9682218746317263`*^9, 
   3.968240243558116*^9, 3.968255362364119*^9, {3.970156159586274*^9, 
   3.970156166044858*^9}, {3.970156286301909*^9, 3.970156297709516*^9}, {
   3.972370720912325*^9, 3.972370732207973*^9}, 3.976844230834156*^9},
 CellLabel->
  "During evaluation of \
In[497]:=",ExpressionUUID->"431f71d3-f949-4617-9ef4-107e6e6b2469"],

Cell[BoxData[
 TemplateBox[{
  "FittedModel", "constr", 
   "\"The property values \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"\\\\\\\"ParameterTable\\\\\\\"\\\", \\\"}\\\"}]\\) assume an \
unconstrained model. The results for these properties may not be valid, \
particularly if the fitted parameters are near a constraint boundary.\"", 2, 
   503, 38, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{
  3.9678740683542433`*^9, 3.968220291704381*^9, 3.968221661496909*^9, {
   3.96822179365938*^9, 3.968221814380464*^9}, 3.968221874632484*^9, 
   3.968240243559004*^9, 3.968255362364931*^9, {3.9701561594230337`*^9, 
   3.970156166054274*^9}, {3.970156286303185*^9, 3.970156297710371*^9}, {
   3.972370720935917*^9, 3.9723707322087183`*^9}, 3.976844230858588*^9},
 CellLabel->
  "During evaluation of \
In[497]:=",ExpressionUUID->"bdae03d9-badd-4979-81b7-0f267f5ab0eb"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"influx", "3.250619866587586`*^-6", "1.7365899997224595`*^-6", 
      "1.8718407149108873`", "0.09073304721791124`"},
     {"km", "0.5511683011308086`", "13.508195185015257`", 
      "0.040802512369840775`", "0.968256489316446`"},
     {"ks", "1.6550783633022047`*^-7", "8.011879663112165`*^-6", 
      "0.020657803572892153`", "0.9839250085166372`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Print",
 CellChangeTimes->{
  3.9678740683535357`*^9, 3.968220292140912*^9, 3.968221661496167*^9, {
   3.9682217936584883`*^9, 3.9682218143795633`*^9}, 3.9682218746317263`*^9, 
   3.968240243558116*^9, 3.968255362364119*^9, {3.970156159586274*^9, 
   3.970156166044858*^9}, {3.970156286301909*^9, 3.970156297709516*^9}, {
   3.972370720912325*^9, 3.972370732207973*^9}, 3.976844230862479*^9},
 CellLabel->
  "During evaluation of \
In[497]:=",ExpressionUUID->"5d54e85e-5d4c-4549-9250-9ee768a3495a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of Rules", "Subsection",ExpressionUUID->"c1a652e7-bc9c-4825-ac19-d1e317fca4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Bonilla", "-", 
     RowBox[{"Quintana", " ", "M"}]}], ",", 
    RowBox[{"W\[ODoubleDot]rg\[ODoubleDot]tter", " ", "F"}], ",", 
    RowBox[{"Tetzlaff", " ", "C"}], ",", 
    RowBox[{
     RowBox[{"Fauth", " ", 
      RowBox[{"M", ".", "Modeling"}], " ", "the", " ", "Shape", " ", "of", " ",
       "Synaptic", " ", "Spines", " ", "by", " ", "Their", " ", "Actin", " ", 
      
      RowBox[{"Dynamics", ".", "Front"}], " ", "Synaptic", " ", "Neurosci", 
      ".2020", " ", "Mar", " ", "10"}], ";", 
     RowBox[{"12", ":", 
      RowBox[{"9.", " ", "doi"}], ":", 
      RowBox[{
       RowBox[{"10.3389", "/", "fnsyn"}], ".2020", 
       RowBox[{".00009", ".", 
        RowBox[{"PMID", ":", "32218728"}]}]}]}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"kappa", "=", 
     RowBox[{".005", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "18"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Zeta]In", "=", "0.002"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9636745393932858`*^9, 3.963674541153862*^9}, 
   3.963674995537118*^9, {3.963676664125948*^9, 3.963676664681211*^9}, 
   3.963690681718493*^9, {3.9637023952875566`*^9, 3.9637023955304623`*^9}, {
   3.9637518561202497`*^9, 3.963751860676935*^9}, {3.964018239098691*^9, 
   3.964018239981019*^9}, {3.9640187544241333`*^9, 3.964018761693882*^9}, {
   3.9640189418841457`*^9, 3.964018942792131*^9}, {3.964218450886179*^9, 
   3.9642184512862043`*^9}, {3.96429478928211*^9, 3.9642947898746367`*^9}, {
   3.964310649409644*^9, 3.964310650090774*^9}, {3.9644464551134863`*^9, 
   3.964446479060196*^9}, {3.964452802185712*^9, 3.964452803006651*^9}, {
   3.9644983332666817`*^9, 3.964498333893279*^9}, {3.964531927885824*^9, 
   3.964531929595087*^9}, {3.9658352059825478`*^9, 3.965835206452114*^9}, {
   3.966318123717952*^9, 3.966318123969122*^9}, {3.9663344454511633`*^9, 
   3.96633444590853*^9}, 3.96782297984857*^9, {3.972092593809863*^9, 
   3.972092594823616*^9}, {3.972092764609334*^9, 3.972092765422288*^9}, {
   3.972092817513137*^9, 3.972092818485958*^9}, {3.972292403443017*^9, 
   3.972292423013332*^9}, {3.97237571644396*^9, 3.972375717578772*^9}, {
   3.9723758859390287`*^9, 3.972375908374875*^9}, 3.9723831277229557`*^9, {
   3.9725060921669607`*^9, 3.972506092857943*^9}, {3.97265952349039*^9, 
   3.972659523931735*^9}, {3.972756042479252*^9, 3.97275604255424*^9}, {
   3.972783230718259*^9, 3.972783230787146*^9}, {3.972783541543439*^9, 
   3.972783552599854*^9}, {3.97294233770973*^9, 3.972942338860675*^9}, {
   3.972942959063377*^9, 3.972942959185832*^9}, {3.972945656781693*^9, 
   3.9729457639568233`*^9}, {3.972945802744632*^9, 3.97294583007393*^9}, {
   3.9729458664415617`*^9, 3.972945909080813*^9}, 3.972946033931641*^9, 
   3.972946213917564*^9, {3.972946270915604*^9, 3.97294627832034*^9}, {
   3.9729494016459703`*^9, 3.972949402058646*^9}, {3.972949532345748*^9, 
   3.97294956666844*^9}, {3.972949641779415*^9, 3.972949659715802*^9}, {
   3.972953145523806*^9, 3.972953145570078*^9}, 3.97295439342798*^9, 
   3.97295496841369*^9, {3.9729588632472343`*^9, 3.9729588689947157`*^9}, {
   3.972981359950283*^9, 3.972981360016365*^9}, 3.9729986739578648`*^9, {
   3.9730283854461327`*^9, 3.973028412483758*^9}, {3.973040527950345*^9, 
   3.973040543972601*^9}, {3.973040599037624*^9, 3.973040608814115*^9}, {
   3.9730411649098997`*^9, 3.9730411692624283`*^9}, {3.9730422990390882`*^9, 
   3.9730422994505033`*^9}, {3.9730427349102087`*^9, 3.973042741542886*^9}, {
   3.97305530001997*^9, 3.9730553055578833`*^9}, {3.97305545188526*^9, 
   3.9730554520121403`*^9}, {3.9731885522379847`*^9, 
   3.9731885919222727`*^9}, {3.973259580632409*^9, 3.973259582790101*^9}, {
   3.973259676044086*^9, 3.9732596761524143`*^9}, 3.973260225448269*^9, {
   3.973270365561379*^9, 3.973270365854413*^9}, {3.973271274933735*^9, 
   3.9732712795985403`*^9}, {3.97388293352114*^9, 3.973882938044486*^9}, {
   3.974697866151442*^9, 3.974697878021017*^9}, {3.974698003088648*^9, 
   3.974698008721114*^9}, {3.9746984735822697`*^9, 3.974698476888929*^9}, {
   3.974698604405526*^9, 3.974698608632779*^9}, {3.974699670095024*^9, 
   3.974699678086598*^9}, 3.9747276561518183`*^9, {3.974747864773302*^9, 
   3.974747869056593*^9}, {3.974748714814587*^9, 3.9747487247068653`*^9}, {
   3.974748805674508*^9, 3.974748807375841*^9}, {3.974748896583634*^9, 
   3.974748898025728*^9}, {3.9747490627960587`*^9, 3.974749062922076*^9}, {
   3.974749380496277*^9, 3.974749385001943*^9}, {3.974783626957467*^9, 
   3.974783641411621*^9}, {3.974783747904882*^9, 3.9747837599227333`*^9}, {
   3.974783854834703*^9, 3.974783855830494*^9}, {3.9747848864586554`*^9, 
   3.974784889800088*^9}, {3.975516631138879*^9, 3.975516632618133*^9}, {
   3.975610969798388*^9, 3.9756109703070803`*^9}, {3.975856572442906*^9, 
   3.9758565786682253`*^9}, {3.977254572703148*^9, 3.9772545728703823`*^9}, {
   3.97725643544346*^9, 3.977256441315651*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"1b9d58cc-9d35-45c0-82db-02a3a7284646"],

Cell["\<\
We also define a function for getting the relative position after rotation \
which works with vectorized coordinates.\
\>", "Text",ExpressionUUID->"e6c29882-0830-4fc9-8c8d-898c3d4d9318"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newPos", "[", 
     RowBox[{
      RowBox[{"oldPos_", "?", "VectorQ"}], ",", " ", "angIn_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "\n", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "angIn", "]"}], ",", " ", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "angIn", "]"}]}]}], "}"}], ",", "\n", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "angIn", "]"}], ",", " ", 
            RowBox[{"Cos", "[", "angIn", "]"}]}], "}"}]}], "\n", "}"}], "}"}],
        " ", ".", " ", "oldPos"}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.964465229918806*^9, 3.9644652628780107`*^9}, {
  3.964466926369076*^9, 3.9644669321539717`*^9}, {3.964470602986259*^9, 
  3.964470606053906*^9}, {3.964470704502801*^9, 3.964470721928092*^9}, {
  3.964471010564211*^9, 3.9644710216768227`*^9}, {3.9644711518900623`*^9, 
  3.9644711543621492`*^9}, {3.964472318623487*^9, 3.964472368255138*^9}, {
  3.964473095725114*^9, 3.964473099440813*^9}, {3.9644748102052107`*^9, 
  3.964474817910679*^9}, {3.964475944434495*^9, 3.9644759591970587`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"1716a032-7599-4e9f-82ed-40a42e45beb1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualizing The Actin Network", "Section",ExpressionUUID->"4e6cf27f-383e-46ee-8bf4-acb469a9d1ff"],

Cell[CellGroupData[{

Cell["Visualizer", "Subsection",ExpressionUUID->"7587dd65-dad9-47e8-9178-ffcae41f195a"],

Cell["\<\
This is the legend for visualizing actin networks:
- Circles: Actin objects
- Squares: Arp objects
- Triangles: Capping objects
- Hexagons: CamKII\[Beta] objects
- Edge medium thickness indicates Actin-ATP and edge no thickness indicates \
Actin-ADP
- Opacity indicates degree of cofilin binding
- Color indicates bending angle\
\>", "Text",ExpressionUUID->"dfc9f736-7559-41b6-80db-55c04327a1a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VisualizeActinSnapshot", "[", 
   RowBox[{"initMoleculeList_", ",", "verbose_", ",", "energyMap_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ml", "=", "initMoleculeList"}], ",", "viz", ",", "stack", ",", 
      "pointCells", ",", "curCell", ",", "prevCell", ",", "color", ",", 
      "prevPos", ",", "energyFunc", ",", "vizLines", ",", "vizSpine", ",", 
      "nextSpine", ",", "moleculeList", ",", "partnerCoords", ",", 
      RowBox[{"shapeRadius", "=", 
       RowBox[{"3.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "9"}]]}]}], ",", "ABPObjects", ",", "curCam", ",", 
      "spineCells", ",", "i", ",", "camObjects", ",", "nextABP", ",", 
      "nucAct", ",", "poiCell", ",", "camNext1", ",", "camNext2", ",", 
      "pushABPBranch"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"--", 
      RowBox[{"-", 
       RowBox[{"helper", ":", 
        RowBox[{
         RowBox[{"push", " ", "ABP", " ", "glyph"}], "+", 
         RowBox[{
         "seed", " ", "its", " ", "nucleated", " ", "actin", " ", "branch", " ",
           "onto", " ", 
          RowBox[{"stack", "--"}]}], "-"}]}]}]}], "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"pushABPBranch", "[", 
       RowBox[{"abp_", ",", "origin_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"viz", ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"abp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "origin"}], "}"}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"viz", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"energyFunc", "[", "0.", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"abp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"abp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}]}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"abp", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "=!=", "nullPointer"}], ",", 
          RowBox[{
           RowBox[{"nucAct", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"moleculeList", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", 
                 RowBox[{"abp", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"PrependTo", "[", 
            RowBox[{"stack", ",", 
             RowBox[{"{", 
              RowBox[{"abp", ",", "nucAct", ",", "Black", ",", 
               RowBox[{"abp", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PrependTo", "[", 
            RowBox[{"viz", ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"abp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"nucAct", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"viz", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"energyFunc", "[", 
                RowBox[{"abp", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Rectangle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"abp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"abp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"{", 
                   RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}]}], 
                "]"}]}], "}"}]}], "]"}]}]}], "]"}], ";"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "initialize", " ", "the", " ", "stack", " ", "and", " ", "viz", " ", 
       "lists"}], "*)"}], 
     RowBox[{"stack", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"viz", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vizLines", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vizSpine", "=", 
      RowBox[{"{", "Black", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ABPObjects", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"ml", ",", 
        RowBox[{"ABP", "[", "__", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"camObjects", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"ml", ",", 
        RowBox[{"cam", "[", "__", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spineCells", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"ml", ",", 
        RowBox[{"spine", "[", "__", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"moleculeList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"initMoleculeList", ",", 
        RowBox[{"spine", "[", "__", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "spineCells", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"nextSpine", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"spineCells", ",", 
            RowBox[{"spine", "[", 
             RowBox[{
              RowBox[{"spineCells", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "__"}], "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vizSpine", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"spineCells", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"nextSpine", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"energyFunc", "[", "ang_", "]"}], ":=", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
       RowBox[{
        RowBox[{"ang", "^", "2"}], "/", 
        RowBox[{
         RowBox[{"(", "boundaryAngle", ")"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"seeds", " ", "we", " ", "start", " ", "DFS", " ", "from"}], "\[LongDash]", 
       RowBox[{
       "pointed", " ", "ends", " ", "and", " ", "any", " ", "actinJuncEnd", " ",
         "that", " ", "has", " ", "a", " ", "next"}]}], "*)"}], 
     RowBox[{"pointCells", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"moleculeList", ",", 
          RowBox[{"pointedEnd", "[", "__", "]"}]}], "]"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"moleculeList", ",", 
            RowBox[{"actinJuncEnd", "[", "__", "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "!=", "nullPointer"}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"Cases", "[", 
         RowBox[{"moleculeList", ",", 
          RowBox[{"ABP", "[", 
           RowBox[{"__", ",", "0.", ",", "_"}], "]"}]}], "]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Iterate", " ", "through", " ", "all", " ", "of", " ", "the", " ", 
       "seed", " ", "terminals"}], "*)"}], 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pointCells", "]"}], "!=", "0"}], ",", 
       RowBox[{
        RowBox[{"poiCell", "=", 
         RowBox[{"First", "@", "pointCells"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointCells", "=", 
         RowBox[{"Rest", "@", "pointCells"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "draw", " ", "symbol", " ", "for", " ", "the", " ", "seed", " ", 
          "terminal"}], "*)"}], 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "poiCell", "]"}], "===", "pointedEnd"}], ",", 
          
          RowBox[{"AppendTo", "[", 
           RowBox[{"viz", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"energyFunc", "[", "0.", "]"}], ",", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"poiCell", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "shapeRadius"}], 
               "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Head", "[", "poiCell", "]"}], "===", "ABP"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"viz", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"energyFunc", "[", "0.", "]"}], ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"poiCell", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{"poiCell", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}]}], 
               "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Head", "[", "poiCell", "]"}], "===", "actinJuncEnd"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "optional", " ", "ABP", " ", "spur", " ", "if", " ", "present"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"don", "'"}], "t", " ", "assume", " ", "a", " ", "next", 
             " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "ABPObjects"}], ">", "0"}], ",", 
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"cand", "=", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"ABPObjects", ",", 
                    RowBox[{"ABP", "[", 
                    RowBox[{
                    RowBox[{"poiCell", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "__"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cand", "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"nextABP", "=", 
                    RowBox[{"First", "@", "cand"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "draw", " ", "connector", " ", "and", " ", "ABP", " ", 
                    "glyph"}], "*)"}], 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"viz", ",", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nextABP", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"poiCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}],
                     "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"viz", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energyFunc", "[", "0.", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nextABP", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"{", 
                    RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"nextABP", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"shapeRadius", ",", "shapeRadius"}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "this", " ", "actinJuncEnd", " ", "is", " ", 
                    "terminal"}], ",", 
                    RowBox[{
                    "seed", " ", "the", " ", "nucleated", " ", "branch"}]}], 
                    "*)"}], 
                    RowBox[{"pushABPBranch", "[", 
                    RowBox[{"nextABP", ",", 
                    RowBox[{"poiCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], 
                 ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"draw", " ", "junction"}], "-", 
             RowBox[{"like", " ", "triangle", " ", "for", " ", "junc"}], "-", 
             "end"}], "*)"}], 
           RowBox[{"AppendTo", "[", 
            RowBox[{"viz", ",", 
             RowBox[{"Triangle", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"poiCell", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"poiCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
                   "shapeRadius"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"poiCell", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "shapeRadius"}], ",", 
                   RowBox[{"-", "shapeRadius"}]}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{"poiCell", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"+", "shapeRadius"}], ",", 
                   RowBox[{"-", "shapeRadius"}]}], "}"}]}]}], "}"}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "initialize", " ", "stack", " ", "ONLY", " ", "if", " ", "seed", " ",
           "has", " ", "a", " ", "next", " ", "pointer", " ", 
          RowBox[{"(", 
           RowBox[{
           "do", " ", "NOT", " ", "clear", " ", "stack", " ", "otherwise"}], 
           ")"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "poiCell", "]"}], ">=", "3"}], "&&", 
           RowBox[{
            RowBox[{"poiCell", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=!=", "nullPointer"}]}], ",", 
          RowBox[{"PrependTo", "[", 
           RowBox[{"stack", ",", 
            RowBox[{"{", 
             RowBox[{"poiCell", ",", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"moleculeList", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                   RowBox[{"poiCell", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "Black", ",", 
              RowBox[{"poiCell", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"DFS", " ", "traversal"}], "*)"}], 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "stack", "]"}], "!=", "0"}], ",", 
          RowBox[{
           RowBox[{"prevCell", "=", 
            RowBox[{"stack", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"curCell", "=", 
            RowBox[{"stack", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"color", "=", 
            RowBox[{"stack", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"prevPos", "=", 
            RowBox[{"stack", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"stack", "=", 
            RowBox[{"Rest", "@", "stack"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", "edge", "*)"}], 
           RowBox[{"PrependTo", "[", 
            RowBox[{"vizLines", ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"curCell", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "prevPos"}], "}"}], 
                "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"node", " ", "glyph"}], "&"}], " ", "color"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "curCell", "]"}], "===", "cap"}], ",", 
             RowBox[{"(*", 
              RowBox[{"cap", ":", 
               RowBox[{
               "triangle", " ", "pointing", " ", "\"\<forward\>\""}]}], 
              "*)"}], 
             RowBox[{"AppendTo", "[", 
              RowBox[{"viz", ",", 
               RowBox[{"{", 
                RowBox[{"Black", ",", 
                 RowBox[{"Triangle", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"shapeRadius", "*", "3."}], ")"}]}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"newPos", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"(", 
                    RowBox[{"shapeRadius", "*", "3."}], ")"}]}], "}"}], ",", 
                    RowBox[{"Pi", "/", "3"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"newPos", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"(", 
                    RowBox[{"shapeRadius", "*", "3."}], ")"}]}], "}"}], ",", 
                    RowBox[{"Pi", "/", "3"}]}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"+", 
                    RowBox[{
                    RowBox[{"newPos", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"(", 
                    RowBox[{"shapeRadius", "*", "3."}], ")"}]}], "}"}], ",", 
                    RowBox[{"Pi", "/", "3"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"newPos", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"(", 
                    RowBox[{"shapeRadius", "*", "3."}], ")"}]}], "}"}], ",", 
                    RowBox[{"Pi", "/", "3"}]}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "}"}], 
                  "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"(*", 
              RowBox[{"monomer", "/", "ends"}], "*)"}], 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"viz", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "curCell", "]"}], "===", 
                    "barbedEnd"}], ",", "Green", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=!=", "cofilin"}], ",", 
                    RowBox[{"energyFunc", "[", 
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"actinJunc", ",", "actinJuncEnd"}], "}"}], ",", 
                    RowBox[{"Head", "[", "curCell", "]"}]}], "]"}], ",", "5", 
                    ",", "4"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"energyFunc", "[", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"actinJunc", ",", "actinJuncEnd"}], "}"}], ",", 
                    RowBox[{"Head", "[", "curCell", "]"}]}], "]"}], ",", "5", 
                    ",", "4"}], "]"}], "]"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "5", "]"}]}], "]"}]}], "]"}]}], 
                   "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"actinJunc", ",", "actinJuncEnd"}], "}"}], ",", 
                    RowBox[{"Head", "[", "curCell", "]"}]}], "]"}], ",", 
                    RowBox[{"Triangle", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
                    "shapeRadius"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "shapeRadius"}], ",", 
                    RowBox[{"-", "shapeRadius"}]}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"+", "shapeRadius"}], ",", 
                    RowBox[{"-", "shapeRadius"}]}], "}"}]}]}], "}"}], "]"}], ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "shapeRadius"}], 
                    "]"}]}], "]"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"verbose", ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"viz", ",", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"Round", "[", 
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"ABP", " ", 
             RowBox[{"spur", "/", "nucleation"}], " ", "if", " ", "we", " ", 
             "land", " ", "on", " ", "a", " ", "junction", " ", "core", " ", 
             "or", " ", "a", " ", "terminal", " ", "junction", " ", "end"}], 
            "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "curCell", "]"}], "===", "actinJunc"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "curCell", "]"}], "===", 
                 "actinJuncEnd"}], "&&", 
                RowBox[{
                 RowBox[{"curCell", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "===", "nullPointer"}]}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"cand", "=", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"ABPObjects", ",", 
                    RowBox[{"ABP", "[", 
                    RowBox[{
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "__"}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cand", "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"nextABP", "=", 
                    RowBox[{"First", "@", "cand"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pushABPBranch", "[", 
                    RowBox[{"nextABP", ",", 
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], 
                 ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "push", " ", "forward", " ", "only", " ", "if", " ", "not", " ", 
             "terminal", " ", "and", " ", "pointer", " ", "is", " ", 
             "valid"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "curCell", "]"}], "=!=", "cap"}], "&&", 
                
                RowBox[{
                 RowBox[{"Head", "[", "curCell", "]"}], "=!=", 
                 "barbedEnd"}]}], ")"}], "&&", 
              RowBox[{
               RowBox[{"curCell", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "=!=", "nullPointer"}]}], ",", 
             RowBox[{"PrependTo", "[", 
              RowBox[{"stack", ",", 
               RowBox[{"{", 
                RowBox[{"curCell", ",", 
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"moleculeList", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"curCell", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "Black", ",", 
                 RowBox[{"curCell", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
           ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"CAM", " ", "edges", " ", "to", " ", "two", " ", "neighbors"}], 
      "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "camObjects", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"camNext1", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"moleculeList", ",", 
            RowBox[{"actin", "[", 
             RowBox[{
              RowBox[{"camObjects", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "__"}], "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"camNext2", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"moleculeList", ",", 
            RowBox[{"actin", "[", 
             RowBox[{
              RowBox[{"camObjects", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", "__"}], "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"vizSpine", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"camNext1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"camObjects", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"vizSpine", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"camNext2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"camObjects", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"vizSpine", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"energyMap", ",", 
              RowBox[{"energyFunc", "[", 
               RowBox[{"camObjects", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5"}], "]"}], "]"}], "]"}], ",", "Black"}],
              "]"}], ",", 
            RowBox[{"RegularPolygon", "[", 
             RowBox[{
              RowBox[{"camObjects", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "middleRadiusCam",
               ",", "12"}], "]"}], ",", "Black"}], "}"}]}], "]"}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "moleculeList", "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"viz", ",", "vizLines"}], "]"}], ",", "vizSpine"}], "]"}], 
        "]"}], ",", 
       RowBox[{"BarLegend", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<TemperatureMap\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9637433328599377`*^9, 3.963743370784601*^9}, {
   3.9637434079129333`*^9, 3.963743425623191*^9}, {3.963743474868642*^9, 
   3.9637434813665857`*^9}, {3.96374354003246*^9, 3.963743585343889*^9}, {
   3.963743726999793*^9, 3.963743728329565*^9}, 3.9637441330762997`*^9, 
   3.96374428260748*^9, {3.96374432357726*^9, 3.96374435571924*^9}, 
   3.9637443918454647`*^9, {3.963744684649585*^9, 3.963744688728724*^9}, 
   3.963744752608054*^9, {3.963744991609941*^9, 3.963744992178378*^9}, {
   3.963745043847085*^9, 3.963745046592297*^9}, {3.9640160530652237`*^9, 
   3.964016056450975*^9}, {3.964063858030897*^9, 3.964063904576421*^9}, {
   3.964063961476075*^9, 3.96406399752454*^9}, {3.964064029280356*^9, 
   3.964064036562508*^9}, {3.964064159093698*^9, 3.964064185574016*^9}, {
   3.9645603693916693`*^9, 3.964560376430121*^9}, {3.964564667484375*^9, 
   3.964564667534575*^9}, {3.964564717764536*^9, 3.964564717836721*^9}, {
   3.964980042653598*^9, 3.964980074630492*^9}, {3.96498011250987*^9, 
   3.964980126989421*^9}, {3.9649801967999153`*^9, 3.964980227763824*^9}, {
   3.964980268015604*^9, 3.96498029364695*^9}, {3.964980351197177*^9, 
   3.964980400480319*^9}, {3.964980615456299*^9, 3.9649806164155188`*^9}, 
   3.9650197136457644`*^9, {3.96502010960673*^9, 3.965020138480397*^9}, {
   3.965020226578104*^9, 3.965020229630596*^9}, {3.9650202601207333`*^9, 
   3.965020290271057*^9}, {3.9650203769382467`*^9, 3.965020413320342*^9}, {
   3.9650205287495327`*^9, 3.9650205567647448`*^9}, {3.96854869652365*^9, 
   3.968548703038714*^9}, {3.9685487602064333`*^9, 3.968548760301217*^9}, 
   3.968548811170816*^9, {3.970411715457609*^9, 3.970411735921303*^9}, {
   3.970411804574191*^9, 3.970411809003824*^9}, {3.970411842080212*^9, 
   3.970411858072938*^9}, {3.970411912785705*^9, 3.9704119280541563`*^9}, {
   3.972308420887206*^9, 3.972308471913773*^9}, {3.972509147936418*^9, 
   3.972509186474319*^9}, {3.9725102582637653`*^9, 3.972510278807454*^9}, {
   3.9727553646907063`*^9, 3.9727553656372833`*^9}, 3.972761718140479*^9, {
   3.972938695286174*^9, 3.9729387221586227`*^9}, {3.9753258112506227`*^9, 
   3.975325855242146*^9}, {3.975325887606393*^9, 3.975325896676717*^9}, {
   3.975325932118771*^9, 3.97532593835275*^9}, {3.9755772226939793`*^9, 
   3.9755772244338017`*^9}, {3.976691064434473*^9, 3.976691068750523*^9}, {
   3.977558301518324*^9, 3.977558321150839*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"119fabd1-2ec4-482f-bbd0-f398361ffce5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "to", " ", "grab", " ", "a", " ", "list", " ", "of", " ", 
    "all", " ", "the", " ", "actin", " ", "types", " ", "from", " ", "full", " ",
     "simulation"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"makeMoleculeLists", "[", "simulationArray_", "]"}], " ", ":=", 
   " ", "\n", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"actin", "[", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"spine", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"ABP", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"cam", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"barbedEnd", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"pointedEnd", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"actinJunc", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"cap", "[", " ", "__", "]"}]}], "]"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"simulationArray", ",", 
       RowBox[{"actinJuncEnd", "[", " ", "__", "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.96374474162679*^9, 3.9637447436256104`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"6eb0391b-e890-46fb-afc5-e81bb71d2b17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "to", " ", "return", " ", "graphics", " ", "list", " ", 
    "for", " ", "all", " ", "snapshots", " ", "in", " ", "a", " ", "sim"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vizSim", "[", 
      RowBox[{
      "simulationArray_", ",", " ", "verbose_", ",", " ", "energyMap_", ",", 
       RowBox[{"n_", ":", "10"}], ",", 
       RowBox[{"tmax_", ":", "0."}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vizList", ",", "dt", ",", "mLists", ",", "bbox", ",", "timePos", ",",
          "t", ",", "start", ",", 
         RowBox[{"simList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"mLists", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"makeMoleculeLists", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"simulationArray", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", "\n", 
        RowBox[{"bbox", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "&"}], ",", "#"}], 
                   "]"}], "&"}], "/@", "mLists"}], "]"}], "]"}], "-", 
              "actinObjectRise"}], ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "&"}], ",", "#"}], 
                   "]"}], "&"}], "/@", "mLists"}], "]"}], "]"}], "+", 
              "actinObjectRise"}]}], "}"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", " ", 
                 RowBox[{"Flatten", "[", "mLists", "]"}]}], "]"}], "]"}], "-",
               "actinObjectRise"}], ",", " ", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", " ", 
                 RowBox[{"Flatten", "[", "mLists", "]"}]}], "]"}], "]"}], "+",
               "actinObjectRise"}]}], "}"}]}], "}"}]}], ";", "\n", 
        RowBox[{"timePos", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "&"}], ",", "#"}], 
                   "]"}], "&"}], "/@", "mLists"}], "]"}], "]"}], "+", 
              RowBox[{"Min", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "&"}], ",", "#"}], 
                   "]"}], "&"}], "/@", "mLists"}], "]"}], "]"}]}], ")"}], "/",
             "2"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "mLists"}], "]"}], "]"}], "+", 
            RowBox[{"actinObjectRise", "*", "0.5"}]}]}], "}"}]}], ";", "\n", 
        RowBox[{"simList", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"simulationArray", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", "mLists"}], "}"}], 
          "]"}]}], ";", "\n", 
        RowBox[{"vizList", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"VisualizeActinSnapshot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "verbose", ",", 
                    "True"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Time: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ")"}], 
                    "]"}], "/", "1000."}], "]"}], "<>", "\"\< secs.\>\""}], 
                    "]"}], ",", "timePos"}], "]"}]}], "}"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Black", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", " ", 
                    RowBox[{"Flatten", "[", "mLists", "]"}]}], "]"}], "]"}], "-", 
                    RowBox[{".25", "actinObjectRise"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "actinObjectRise"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", " ", 
                    RowBox[{"Flatten", "[", "mLists", "]"}]}], "]"}], "]"}], "-", 
                    RowBox[{".25", "actinObjectRise"}]}]}], "}"}]}], "}"}], 
                    "]"}], ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Round", "[", 
                    RowBox[{"actinObjectRise", "*", "2", "*", "100", "*", 
                    SuperscriptBox["10", "9"]}], "]"}]}], "/", "100"}], "]"}],
                     "<>", "\"\<nm\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"actinObjectRise", ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], ",", " ", 
                    RowBox[{"Flatten", "[", "mLists", "]"}]}], "]"}], "]"}], "-", 
                    RowBox[{".75", "actinObjectRise"}]}]}], "}"}]}], "]"}]}], 
                  "}"}], "//", "Flatten"}]}], "]"}], ",", 
              RowBox[{"PlotRange", "->", "bbox"}]}], "]"}], "&"}], ",", 
           "simList"}], "]"}]}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sampleSimDirect", "[", "directory_", "]"}], ":=", "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "files", ",", "simList", ",", "maxTime", ",", "simNumbers", ",", "fgi",
         ",", "filegroups", ",", "simulationArray", ",", "t", ",", "sim", ",",
         "i", ",", "j", ",", 
        RowBox[{"globString", "=", "\"\<simSpine*.wls\>\""}]}], "}"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"simList", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", 
       RowBox[{"files", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
          "directory", "<>", "\"\</\>\"", "<>", "#", "<>", "\"\<.wls\>\""}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FileBaseName", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"FileNames", "[", 
             RowBox[{"directory", "<>", "\"\</\>\"", "<>", "globString"}], 
             "]"}]}], ",", "processFileNames"}], "]"}]}]}], ";", "\n", "\n", 
       RowBox[{"simNumbers", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "filegroups"}], "]"}]}], ";", "\n", 
       RowBox[{"simulationArray", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "@", "files"}]}], ",", 
         RowBox[{"i", "+=", "1"}], ",", "\n", 
         RowBox[{
          RowBox[{"sim", "=", 
           RowBox[{"Import", "[", 
            RowBox[{"files", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\n", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"simulationArray", ",", "sim"}], "]"}], ";"}]}], "\n", 
        "]"}], ";", "\n", "simulationArray"}]}], "\n", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.96854707585042*^9, 3.968547111818365*^9}, {
   3.9685471757499866`*^9, 3.968547201280142*^9}, {3.968547464143401*^9, 
   3.9685475096879*^9}, {3.972340098077591*^9, 3.97234015796097*^9}, {
   3.9723403552092524`*^9, 3.972340368245468*^9}, {3.9729385886767883`*^9, 
   3.972938593290156*^9}, {3.977183467863818*^9, 3.977183529851225*^9}, 
   3.977183573842754*^9, {3.977183632876081*^9, 3.97718368581269*^9}, {
   3.977183715815996*^9, 3.977183823950027*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"fffa00eb-b458-4b6d-9cf9-72ba6ea4a28c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"animateGrowth", "[", 
     RowBox[{"simulationArray_", ",", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mLists", ",", "bbox", ",", "timePos", ",", "xs", ",", "ys"}], 
       "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"mLists", " ", "=", " ", 
        RowBox[{"makeMoleculeLists", "/@", 
         RowBox[{"simulationArray", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{"xs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"mLists", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}]}], ";",
        "\n", 
       RowBox[{"ys", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"mLists", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}]}], ";",
        "\n", 
       RowBox[{"bbox", " ", "=", " ", 
        RowBox[{"RegionBounds", "[", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", "xs", "]"}], "-", 
              RowBox[{"2.", "actinObjectRise"}]}], ",", " ", 
             RowBox[{
              RowBox[{"Min", "[", "ys", "]"}], "-", 
              RowBox[{"2.", "actinObjectRise"}]}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "xs", "]"}], "+", 
              RowBox[{"2.", "actinObjectRise"}]}], ",", " ", 
             RowBox[{
              RowBox[{"Max", "[", "ys", "]"}], "+", 
              RowBox[{"2.", "actinObjectRise"}]}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\n", 
       RowBox[{"timePos", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", "xs", "]"}], "+", 
             RowBox[{"Min", "[", "xs", "]"}]}], ")"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", "ys", "]"}], "+", "actinObjectRise"}]}], 
         "}"}]}], ";", "\n", 
       RowBox[{"frames", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"{", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"VisualizeActinSnapshot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "verbose", ",", 
                    "True"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Time: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
                    "<>", "\"\<, Frame: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", "Bold", ",", 
                    RowBox[{"FontColor", "->", 
                    RowBox[{"Darker", "[", "LightBlue", "]"}]}]}], "]"}], ",",
                     "timePos"}], "]"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
                "]"}], ",", 
               RowBox[{"PlotRange", "->", "bbox"}]}], "]"}], "}"}], "]"}], 
           "&"}], ",", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
              "simulationArray"}], ",", "mLists", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "@", "simulationArray"}], "]"}]}], "}"}], 
           "]"}]}], "]"}]}], ";", "\n", 
       RowBox[{"ListAnimate", "[", "frames", "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"processFileNames", "[", "name_", "]"}], ":=", "\n", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"StringDelete", "[", 
     RowBox[{"name", ",", "LetterCharacter"}], "]"}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"animateGrowthDirectory", "[", 
     RowBox[{"directory_", ",", "globString_", ",", "outDir_", ",", 
      RowBox[{"dt_", ":", "0.01"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "maxis", ",", "frameN", ",", "xs", ",", "ys", ",", "start", ",", 
        "simList", ",", "t", ",", "mLists", ",", "bbox", ",", "timePos", ",", 
        "files", ",", "lastFrame", ",", "i", ",", "j", ",", "frameNumber", ",",
         "frames"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FileBaseName", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"FileNames", "[", 
            RowBox[{"directory", "<>", "globString"}], "]"}]}], ",", 
          "processFileNames"}], "]"}]}], ";", "\n", 
       RowBox[{"files", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"directory", "<>", "#", "<>", "\"\<.wls\>\""}], "&"}], "/@",
          "files"}]}], ";", "\n", 
       RowBox[{"simList", "=", 
        RowBox[{"sampleSimDirect", "[", "directory", "]"}]}], ";", "\n", "\n", 
       RowBox[{"mLists", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"makeMoleculeLists", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], "/@", "simList"}]}],
        ";", "\n", 
       RowBox[{"xs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"mLists", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}]}], ";",
        "\n", 
       RowBox[{"ys", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"mLists", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}]}], ";",
        "\n", 
       RowBox[{"bbox", " ", "=", " ", 
        RowBox[{"RegionBounds", "[", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", "xs", "]"}], "-", 
              RowBox[{"2", "actinObjectRise"}]}], ",", " ", 
             RowBox[{
              RowBox[{"Min", "[", "ys", "]"}], "-", 
              RowBox[{"2", "actinObjectRise"}]}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "xs", "]"}], "+", 
              RowBox[{"2", "actinObjectRise"}]}], ",", " ", 
             RowBox[{
              RowBox[{"Max", "[", "ys", "]"}], "+", 
              RowBox[{"2", "actinObjectRise"}]}]}], "}"}]}], "]"}], "]"}]}], ";",
        "\n", 
       RowBox[{"timePos", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", "xs", "]"}], "+", 
             RowBox[{"Min", "[", "xs", "]"}]}], ")"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", "ys", "]"}], "+", "actinObjectRise"}]}], 
         "}"}]}], ";", "\n", 
       RowBox[{"simList", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Length", "@", "mLists"}], "-", "1"}]}], "]"}], "*", 
            "dt"}], ",", "mLists"}], "}"}], "]"}]}], ";", "\n", 
       RowBox[{"CreateDirectory", "[", "outDir", "]"}], ";", "\n", 
       RowBox[{"frameNumber", "=", "0"}], ";", "\n", 
       RowBox[{"frames", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"VisualizeActinSnapshot", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "False", ",", 
                    "True"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Time: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}], "]"}], 
                    "<>", "\"\< s.\>\""}], ",", "Bold", ",", 
                    RowBox[{"FontSize", "->", "14"}], ",", 
                    RowBox[{"FontColor", "->", 
                    RowBox[{"Darker", "[", "LightBlue", "]"}]}]}], "]"}], ",",
                     "timePos"}], "]"}]}], "}"}]}], "]"}], "]"}], "//", 
              "Flatten"}], ",", 
             RowBox[{"PlotRange", "->", "bbox"}]}], "]"}], "&"}], ",", 
          "simList"}], "]"}]}], ";", "\n", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<=", 
          RowBox[{"Length", "@", "frames"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\n", 
         RowBox[{
          RowBox[{"frameNumber", "++"}], ";", "\n", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"outDir", "<>", "\"\<frame_\>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{"frameNumber", ",", "10", ",", "8"}], "]"}], 
             "<>", "\"\<.png\>\""}], ",", 
            RowBox[{"frames", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}]}], "\n", "]"}], 
       ";"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"animateGrowthDirectorySet", "[", 
    RowBox[{
    "directory_", ",", "globString_", ",", "outDir_", ",", "dimensions_", ",", 
     RowBox[{"dt_", ":", "0.001"}], ",", 
     RowBox[{"plotSims_", ":", "False"}], ",", 
     RowBox[{"plotAreas_", ":", "False"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "simPlots", ",", "simList", ",", "minLength", ",", "areaPlots", ",", 
       "start", ",", "t", ",", "mLists", ",", "bbox", ",", "timePos", ",", 
       "files", ",", "end", ",", "lastFrame", ",", "frames", ",", 
       "simulationArray", ",", "frame", ",", "groupfiles", ",", "filegroups", 
       ",", "fgi", ",", "maxTime", ",", "simSubList", ",", "xs", ",", "ys", ",",
        "maxis", ",", "simNumbers", ",", "i", ",", "j", ",", "sim", ",", 
       "dim"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"simList", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"groupfiles", "=", 
       RowBox[{"FileNames", "[", "directory", "]"}]}], ";", "\n", 
      RowBox[{"groupfiles", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"groupfiles", ",", 
         RowBox[{
          RowBox[{"DirectoryName", "[", "directory", "]"}], 
          "<>", "\"\<.DS_Store\>\""}]}], "]"}]}], ";", "\n", 
      RowBox[{"filegroups", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "@", "groupfiles"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"filegroups", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"groupfiles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</\>\"", "<>", "#", 
               "<>", "\"\<.wls\>\""}], "&"}], "/@", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"FileBaseName", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"FileNames", "[", 
                 RowBox[{
                  RowBox[{"groupfiles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
                  "globString"}], "]"}]}], ",", "processFileNames"}], "]"}]}],
             ")"}]}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"maxTime", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "&"}], "/@", 
         "filegroups"}], "]"}]}], ";", "\n", 
      RowBox[{"simList", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"progressbar", "=", 
       RowBox[{
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\<|\>\"", ",", "1"}], "]"}], "<>", 
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\< \>\"", ",", 
          RowBox[{
           RowBox[{"Length", "@", "filegroups"}], "-", "1"}]}], "]"}], 
        "<>", "\"\<|\>\""}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"Dynamic", "[", "progressbar", "]"}], "]"}], ";", "\n", 
      RowBox[{"simNumbers", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "filegroups"}], "]"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"fgi", "=", "1"}], ",", 
        RowBox[{"fgi", "<=", 
         RowBox[{"Length", "@", "filegroups"}]}], ",", 
        RowBox[{"fgi", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"files", "=", 
          RowBox[{"filegroups", "[", 
           RowBox[{"[", "fgi", "]"}], "]"}]}], ";", "\n", 
         RowBox[{"simulationArray", "=", 
          RowBox[{"{", "}"}]}], ";", "\n", 
         RowBox[{"t", "=", "0"}], ";", "\n", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<=", 
            RowBox[{"Length", "@", "files"}]}], ",", 
           RowBox[{"i", "+=", "1"}], ",", "\n", 
           RowBox[{
            RowBox[{"sim", "=", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{"files", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "<=", 
               RowBox[{"Length", "@", "sim"}]}], ",", 
              RowBox[{"j", "++"}], ",", "\n", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sim", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], ">=", "t"}], ",", 
                "\n", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"simulationArray", ",", 
                   RowBox[{"sim", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], ";", "\n", 
                 RowBox[{"t", "+=", "dt"}], ";"}]}], "\n", "]"}]}], "\n", 
             "]"}]}]}], "\n", "]"}], ";", "\n", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"simList", ",", "simulationArray"}], "]"}], ";", "\n", 
         RowBox[{"progressbar", "=", 
          RowBox[{
           RowBox[{"StringRepeat", "[", 
            RowBox[{"\"\<|\>\"", ",", "fgi"}], "]"}], "<>", 
           RowBox[{"StringRepeat", "[", 
            RowBox[{"\"\< \>\"", ",", 
             RowBox[{
              RowBox[{"Length", "@", "filegroups"}], "-", "fgi"}]}], "]"}], 
           "<>", "\"\<|\>\""}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"simList", "=", 
       RowBox[{"simList", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"dim", "=", 
       RowBox[{"QuotientRemainder", "[", 
        RowBox[{
         RowBox[{"Length", "@", "filegroups"}], ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"Sqrt", "@", 
           RowBox[{"Length", "@", "filegroups"}]}], "]"}]}], "]"}]}], ";", 
      "\n", "\n", 
      RowBox[{"minLength", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], "]"}]}], ";",
       "\n", 
      RowBox[{"mLists", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"makeMoleculeLists", "/@", "#"}], "&"}], "/@", "simList"}]}],
       ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"plotSims", ",", "\n", 
        RowBox[{
         RowBox[{"simPlots", "=", 
          RowBox[{"GraphicsGrid", "[", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"plotSim", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "@", "#"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"Transpose", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dt", "*", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"minLength", "-", "1."}]}], "]"}]}], "&"}], "/@", 
                    "simList"}], ",", 
                    RowBox[{"simList", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", "minLength"}]}], "]"}], "]"}]}], "}"}]}], 
                  ")"}]}], ")"}]}], ",", "dimensions"}], "]"}], ",", 
            RowBox[{"Frame", "->", "All"}]}], "]"}]}], ";", "\n", "\n", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"outDir", "<>", "\"\<simPlots.jpeg\>\""}], ",", 
           "simPlots"}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"plotAreas", ",", "\n", 
        RowBox[{
         RowBox[{"areaPlots", "=", 
          RowBox[{"GraphicsGrid", "[", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"membraneAreaPlotter", "[", 
                 RowBox[{"#", ",", "\"\<Membrane Area Over Time\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.005", ",", "0.025"}], "}"}]}], "}"}]}], "]"}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "@", "#"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"Transpose", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dt", "*", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"minLength", "-", "1."}]}], "]"}]}], "&"}], "/@", 
                    "simList"}], ",", 
                    RowBox[{"simList", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", "minLength"}]}], "]"}], "]"}]}], "}"}]}], 
                  ")"}]}], ")"}]}], ",", "dimensions"}], "]"}], ",", 
            RowBox[{"Frame", "->", "All"}]}], "]"}]}], ";", "\n", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"outDir", "<>", "\"\<areaPlots.jpeg\>\""}], ",", 
           "areaPlots"}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"simList", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "@", "#"}]}], "]"}], "&"}], "/@", "mLists"}], 
          ",", "mLists"}], "}"}]}]}], ";", "\n", "\n", 
      RowBox[{"xs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
             RowBox[{"mLists", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}],
          ")"}], "//", "Flatten"}]}], ";", "\n", 
      RowBox[{"ys", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
             RowBox[{"mLists", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "ListQ"}], "]"}]}],
          ")"}], "//", "Flatten"}]}], ";", "\n", 
      RowBox[{"bbox", " ", "=", " ", 
       RowBox[{"RegionBounds", "[", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", "xs", "]"}], "-", 
             RowBox[{"2", "actinObjectRise"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Min", "[", "ys", "]"}], "-", 
             RowBox[{"2", "actinObjectRise"}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", "xs", "]"}], "+", 
             RowBox[{"2", "actinObjectRise"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Max", "[", "ys", "]"}], "+", 
             RowBox[{"2", "actinObjectRise"}]}]}], "}"}]}], "]"}], "]"}]}], ";",
       "\n", 
      RowBox[{"timePos", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "xs", "]"}], "+", 
            RowBox[{"Min", "[", "xs", "]"}]}], ")"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", "ys", "]"}], "+", "actinObjectRise"}]}], 
        "}"}]}], ";", "\n", "\n", 
      RowBox[{"maxis", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], "&"}], "/@", "mLists"}]}], ";", "\n", 
      RowBox[{"CreateDirectory", "[", "outDir", "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "!=", "0"}], ",", 
        RowBox[{
         RowBox[{"dim", "=", 
          RowBox[{
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"dim", "=", 
          RowBox[{"dim", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "]"}], ";", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"frame", "=", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsGrid", "[", 
               RowBox[{
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VisualizeActinSnapshot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"simList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"frameN", "+", "1"}]}], "}"}], "]"}], "]"}], 
                    "]"}], ",", "False", ",", "True"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Time: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"simList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"frameN", "+", "1"}]}], "}"}], "]"}], "]"}], 
                    "]"}], "*", "dt"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}], "]"}], 
                    "<>", "\"\< s.\>\""}], ",", "Bold", ",", 
                    RowBox[{"FontSize", "->", "14"}], ",", 
                    RowBox[{"FontColor", "->", 
                    RowBox[{"Darker", "[", "LightBlue", "]"}]}]}], "]"}], ",",
                     "timePos"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Min", "[", "ys", "]"}], "-", 
                    "actinObjectRise"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "actinObjectRise"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "[", "ys", "]"}], "-", 
                    "actinObjectRise"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Round", "[", 
                    RowBox[{"actinObjectRise", "*", "2", "*", "1000"}], 
                    "]"}]}], "/", "1000"}], "]"}], "<>", "\"\< \[Mu]m\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"actinObjectRise", ",", 
                    RowBox[{
                    RowBox[{"Min", "[", "ys", "]"}], "-", 
                    RowBox[{"1.75", "actinObjectRise"}]}]}], "}"}]}], "]"}]}],
                     "}"}]}], "]"}], ",", 
                    RowBox[{"PlotRange", "->", "bbox"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "@", "filegroups"}]}], "]"}]}], ")"}], ",",
                   "dimensions"}], "]"}], ",", 
                RowBox[{"Frame", "->", "All"}]}], "]"}], ",", 
              RowBox[{"BarLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<TemperatureMap\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Kappa]B", "/", "2"}], "*", 
                    RowBox[{"\[Pi]", "/", "4"}]}]}], "}"}]}], "}"}], ",", 
                RowBox[{"LegendFunction", "->", "\"\<Frame\>\""}], ",", 
                RowBox[{
                "LegendLabel", "->", "\"\<Bending Energy in Joules\>\""}]}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"Frame", "->", "True"}]}], "]"}]}], ";", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"outDir", "<>", "\"\<frame_\>\"", "<>", 
            RowBox[{"IntegerString", "[", 
             RowBox[{"frameN", ",", "10", ",", "8"}], "]"}], 
            "<>", "\"\<.png\>\""}], ",", "frame"}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "0", ",", 
          RowBox[{"Max", "@", "maxis"}]}], "}"}]}], "]"}], ";"}]}], "\n", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.968504998073394*^9, 3.968505021751795*^9}, {
  3.968505115234928*^9, 3.968505115887731*^9}, {3.9685051728204947`*^9, 
  3.96850520613759*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"caa49df6-bcaa-4320-a4f2-67b10a7183f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",ExpressionUUID->"ea6f0e35-a244-4e1d-8766-cf2f7b667492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotSim", "[", 
   RowBox[{"simulationArray_", ",", 
    RowBox[{"slices_", ":", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"totalActin", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "barbedEnd"}], 
                  "&"}]}], "]"}], "]"}], "*", "nCG"}], "+", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "actinJunc"}], 
                  "&"}]}], "]"}], "]"}], "*", "nCG"}], "+", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actinJuncEnd"}], 
                   "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "nullPointer"}]}], 
                  "&"}]}], "]"}], "]"}], "*", "nCG"}], "+", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&"}]}],
                 "]"}], "]"}], "*", "nCG"}], "+", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], "&"}]}], 
                "]"}], "]"}], "*", "nCG"}], "+", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"actinATPCount", "[", "_", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "+", 
             RowBox[{"Abs", "[", " ", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"actinADPCount", "[", "_", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], "]"}]}]}], "}"}], 
          " ", "&"}], ",", " ", 
         RowBox[{"simulationArray", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "@", "simulationArray"}], ";;", "slices"}], 
           "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"SA", "=", 
       RowBox[{"simulationArray", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"Length", "@", "simulationArray"}], ";;", "slices"}], "]"}],
         "]"}]}], ",", "data"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"{", "\n", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"nCG", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], 
                    "&"}]}], "]"}], "]"}], "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actinJunc"}], 
                    "&"}]}], "]"}], "]"}], "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actinJuncEnd"}], 
                    "&&", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "nullPointer"}]}], 
                    "&"}]}], "]"}], "]"}], "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "barbedEnd"}], 
                    "&"}]}], "]"}], "]"}], "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], "&"}]}], 
                  "]"}], "]"}]}], ")"}]}]}], "}"}], " ", "&"}], ",", " ", 
          "SA"}], "]"}], ",", "\n", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"nCG", "*", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "||", 
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "actinJunc"}]}], ",", 
                   RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "==", "cofilin"}], 
                    "]"}], ",", "0"}], "]"}], "&"}], "/@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "}"}], " ", 
           "&"}], ",", " ", "SA"}], "]"}], ",", "\n", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"actinATPCount", "[", "_", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], "+", " ", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"actinADPCount", "[", "_", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}]}], "}"}], " ", 
           "&"}], ",", " ", "SA"}], "]"}], ",", "\n", "totalActin", ",", "\n", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"actinATPCount", "[", "_", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], " ", "&"}], ",",
           " ", "SA"}], "]"}], ",", "\n", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"actinADPCount", "[", "_", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "}"}], " ", 
           "&"}], ",", " ", "SA"}], "]"}]}], "}"}]}], ";", "\n", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotLegends", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<Polymerized Actin\>\"", ",", "\"\<Bound Cofilin\>\"", ",",
           " ", "\"\<Free Actin\>\"", ",", "\"\<Total Actin\>\"", 
          ",", "\"\<G-Actin-ATP\>\"", ",", "\"\<G-Actin-ADP\>\""}], "}"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"simulationArray", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"simulationArray", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Max", "[", "totalActin", "]"}]}], "}"}]}], "}"}]}], ",", 
       
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Time (s)\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", "\"\<Plot of Number of Molecules\>\""}]}], 
      "]"}]}]}], "\n", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9640226553774567`*^9, 3.9640226629752007`*^9}, {
  3.970149847362053*^9, 3.970149879643972*^9}, {3.9701499146796618`*^9, 
  3.970149928003439*^9}, {3.970150153700574*^9, 3.970150189558752*^9}, {
  3.973189999121821*^9, 3.973190002427786*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"38cba5e7-f0fd-475c-be6f-e99547dad72e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Molecule Rules", "Section",ExpressionUUID->"d128777f-5c63-4454-91fd-009185e12042"],

Cell["\<\
Here we define the rules that govern the changes in the number of free \
molecules without a change in the actin network structure. There is one rule \
that changes the type of bound nucleotide to actins in filaments. We have ARP \
synthesis and degradation, actin synthesis and degradation, actin-ADP and \
actin-ATP dissociation, F-Actin hydrolysis (conversion of F-actin-ATP to \
F-actin-ADP).\
\>", "Text",ExpressionUUID->"e25afe7b-1d43-47ed-be55-64f5c57d3ccb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "rules", " ", "for", " ", "ARP", " ", "synthesizing", " ", "and", " ", 
    "degrading"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesMolVanilla", " ", "=", " ", 
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"ARP", " ", "synthesis"}], " ", "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"arpCount", "[", "numArp", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"arpCount", "[", "numArp", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numArp", "'"}], "==", 
         RowBox[{"arpRate", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numArp", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"ARP", " ", "degradation"}], " ", "*)"}], "\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"arpCount", "[", "numArp", "]"}], " ", "->", " ", 
         RowBox[{"arpCount", "[", "numArp", "]"}]}], ")"}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numArp", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "arpDegRate"}], " ", "*", "numArp", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numArp", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Cap", " ", "synthesis"}], " ", "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"aip1Count", "[", "numCap", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"aip1Count", "[", "numCap", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCap", "'"}], "==", "aip1Rate"}], "]"}], ",", "\n", "\n", 
       
       RowBox[{"(*", " ", 
        RowBox[{"Cap", " ", "degradation"}], " ", "*)"}], "\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cappingCount", "[", "numCap", "]"}], " ", "->", " ", 
         RowBox[{"cappingCount", "[", "numCap", " ", "]"}]}], ")"}], ",", 
       "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCap", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "aip1DegRate"}], " ", "*", "numCap", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numCap", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Cam", " ", "synthesis"}], " ", "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"camCount", "[", "numCam", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"camCount", "[", "numCam", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCam", "'"}], "==", "camRate"}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Cam", " ", "degradation"}], " ", "*)"}], "\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"camCount", "[", "numCam", "]"}], " ", "->", " ", 
         RowBox[{"camCount", "[", "numCam", "]"}]}], ")"}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCam", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "camDegRate"}], " ", "*", "numCam", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numCam", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Cofilin", " ", "synthesis"}], " ", "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCofilin", "'"}], "==", "cofRate"}], "]"}], ",", "\n", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Cofilin", " ", "degradation"}], " ", "*)"}], "\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}], " ", "->", " ", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], ")"}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numCofilin", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "cofilinDegRate"}], " ", "*", "numCofilin", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numCofilin", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Actin", " ", "synthesis"}], " ", "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numActin", "'"}], "==", "actinRate"}], "]"}], ",", "\n", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Actin", " ", "degradation"}], " ", "*)"}], "\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"actinATPCount", "[", "numActin", "]"}], " ", ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ")"}], ",",
        "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numActin", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "actinDegRate"}], " ", "*", "numActin", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numActin", ">", "0"}], "]"}]}]}], "]"}], ",", "\n", "\n", 
       
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinADPCount", "[", "numActin", "]"}], " ", ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", "\n", 
       RowBox[{"solving", "[", 
        RowBox[{
         RowBox[{"numActin", "'"}], "==", 
         RowBox[{
          RowBox[{"-", "actinDegRate"}], " ", "*", "numActin", "  ", 
          RowBox[{"Boole", "[", 
           RowBox[{"numActin", ">", "0"}], "]"}]}]}], "]"}]}], "\n", "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesPiRelease", "=", 
     RowBox[{"{", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Hydrolysis", " ", "of", " ", "F"}], "-", "Actin", "-", 
        "Nucleotides"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ATP"}], 
           "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ADPPlusPi"}],
            "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kATPHydrolysis", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ADPPlusPi"}],
            "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ADP"}], 
           "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kPiRelease", "/", "nCG"}], "]"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
            "angABP", ",", "ATP"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
            "angABP", ",", "ADPPlusPi"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kATPHydrolysis", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
            "angABP", ",", "ADPPlusPi"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
            "angABP", ",", "ADP"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kPiRelease", "/", "nCG"}], "]"}], ",", "\[IndentingNewLine]",
        "\n", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "ATP", ",", "spineID", ",", "dist"}], 
           "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "ADPPlusPi", ",", "spineID", ",", 
            "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kATPHydrolysis", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "ADPPlusPi", ",", "spineID", ",", 
            "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "ADP", ",", "spineID", ",", "dist"}], 
           "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kPiRelease", "/", "nCG"}], "]"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ATP", ",", "spineID", ",",
             "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ADPPlusPi", ",", 
            "spineID", ",", "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kATPHydrolysis", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ADPPlusPi", ",", 
            "spineID", ",", "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ADP", ",", "spineID", ",",
             "dist"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kPiRelease", "/", "nCG"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesNuc", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"arpCount", "[", "numArp", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActinATP", "]"}], ",", 
          RowBox[{"newID", "[", "NID", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ABP", "[", 
           RowBox[{"NID", ",", " ", 
            RowBox[{"newPos", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"actinObjectRise", "/", "2"}], ",", " ", "0."}], 
               "}"}], ",", " ", "randAng"}], "]"}], ",", 
            RowBox[{"NID", "+", "1."}], ",", "0.", ",", "arpRule"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
            RowBox[{"NID", "+", "1."}], ",", " ", 
            RowBox[{"newPos", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"actinObjectRise", "/", "2"}], ",", " ", "0."}], 
               "}"}], ",", " ", 
              RowBox[{"randAng", "+", "\[Pi]"}]}], "]"}], ",", "ATP", ",", 
            "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
          RowBox[{"arpCount", "[", 
           RowBox[{"numArp", "-", "1"}], "]"}], ",", 
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActinATP", "-", "nCG"}], "]"}], ",", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", "+", "2."}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"with", "[", " ", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{"numActinATP", " ", ">", " ", "nCG"}], "&&", 
           RowBox[{"numArp", ">", "1."}]}], "]"}], 
         RowBox[{"1.", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"numArp", " ", "kArpNuc"}], ")"}]}], " ", "+", " ", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"numActinATP", " ", 
               RowBox[{"kPlusBarbedT", "/", "nCG"}]}], ")"}]}]}], ")"}]}], "  ", 
         RowBox[{"grammarPDF", "[", "\n", "   ", 
          RowBox[{
           RowBox[{"UniformDistribution", "[", 
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"2", " ", "\[Pi]"}]}], "}"}], "]"}], ",", " ", 
           "randAng"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"rulesDenuc", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}], ",", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
            "spineIDNext", ",", "distNext"}], "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "+", "nCG"}], "]"}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kMinusPointedD", "/", "nCG"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ABP", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "0.", ",", "ABPRule"}], 
           "]"}], ",", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
            "spineIDNext", ",", "distNext"}], "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "+", "nCG"}], "]"}], "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}]}], "\n", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesFilNuc", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"(*", 
       RowBox[{"rulesNuc", ","}], "*)"}], "rulesDenuc", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963666245823598*^9, 3.9636662492796783`*^9}, {
   3.963700967465282*^9, 3.96370096931437*^9}, {3.963810031967461*^9, 
   3.963810033935822*^9}, {3.9640349286989107`*^9, 3.964034942353266*^9}, {
   3.964035053369005*^9, 3.964035053782337*^9}, {3.964282400696391*^9, 
   3.964282456856895*^9}, {3.9650408485324697`*^9, 3.9650408520670757`*^9}, {
   3.965333878756775*^9, 3.96533405288218*^9}, {3.9653340986691017`*^9, 
   3.965334109454467*^9}, {3.965334427396264*^9, 3.9653345474834948`*^9}, {
   3.965334582702652*^9, 3.965334590284576*^9}, {3.965334642144141*^9, 
   3.965334648000876*^9}, {3.9653347242072277`*^9, 3.965334752871991*^9}, {
   3.9653348079088583`*^9, 3.9653348095474367`*^9}, {3.965334870348618*^9, 
   3.965334882503955*^9}, {3.965335831286137*^9, 3.9653358313899097`*^9}, {
   3.965335866533489*^9, 3.9653358728620443`*^9}, {3.965382659213595*^9, 
   3.965382672648547*^9}, {3.9658345367517157`*^9, 3.965834539455771*^9}, {
   3.965901593661049*^9, 3.965901594283476*^9}, 3.96590168995704*^9, {
   3.968421612040471*^9, 3.968421651614612*^9}, {3.968430528693218*^9, 
   3.968430730651702*^9}, 3.9685002765830517`*^9, {3.968773293443879*^9, 
   3.9687733567005377`*^9}, {3.969876623237093*^9, 3.969876627401567*^9}, {
   3.970150705802947*^9, 3.970150742445217*^9}, {3.9701507872139683`*^9, 
   3.970150826607596*^9}, 3.9701548893443203`*^9, {3.972087574738639*^9, 
   3.9720875756676064`*^9}, {3.9720878738306723`*^9, 3.972087877501853*^9}, {
   3.9725016432392197`*^9, 3.972501649408517*^9}, {3.972501721887656*^9, 
   3.972501833741465*^9}, {3.9725018790484*^9, 3.972501948428602*^9}, {
   3.972502196525539*^9, 3.972502300052779*^9}, {3.972502339921989*^9, 
   3.972502351199415*^9}, {3.972502485416518*^9, 3.9725024858174973`*^9}, {
   3.972502552233392*^9, 3.972502553847595*^9}, {3.9725026759176683`*^9, 
   3.972502678258671*^9}, {3.9725097531130953`*^9, 3.972509759983667*^9}, {
   3.972509833962821*^9, 3.972509848910255*^9}, {3.972509928843709*^9, 
   3.972509929233982*^9}, 3.972510014084112*^9, {3.972510085465892*^9, 
   3.972510095663197*^9}, {3.972510852116294*^9, 3.9725108553340054`*^9}, {
   3.972510974482377*^9, 3.972510980884219*^9}, {3.972511494833679*^9, 
   3.972511539577248*^9}, {3.972753061883122*^9, 3.972753068654326*^9}, {
   3.976845267253367*^9, 3.976845268961483*^9}, {3.976986281456687*^9, 
   3.9769862968123283`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"2cf740e6-2a31-43bd-871a-0cda3fc48a91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Barbed End Rules ", "Section",ExpressionUUID->"acdbb75d-90f1-4d7d-bb3a-3f67f8305b18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cross2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ax_", ",", "ay_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bx_", ",", "by_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ax", " ", "by"}], "-", 
    RowBox[{"ay", " ", "bx"}]}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rayIntersectsSegmentQ", "[", 
   RowBox[{
    RowBox[{"r0_", "?", "VectorQ"}], ",", 
    RowBox[{"d_", "?", "VectorQ"}], ",", 
    RowBox[{"s0_", "?", "VectorQ"}], ",", 
    RowBox[{"s1_", "?", "VectorQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "w", ",", "denom", ",", "t", ",", "u", ",", "eps"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"s1", "-", "s0"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"segment", " ", "direction"}], "*)"}], 
     RowBox[{"w", "=", 
      RowBox[{"s0", "-", "r0"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "from", " ", "ray", " ", "origin", " ", "to", " ", "segment", " ", 
       "start"}], "*)"}], 
     RowBox[{"denom", "=", 
      RowBox[{"cross2", "[", 
       RowBox[{"d", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eps", "=", 
      RowBox[{
       RowBox[{"10", "^", "3"}], " ", "$MachineEpsilon", " ", 
       RowBox[{"Norm", "[", "d", "]"}], " ", 
       RowBox[{"Norm", "[", "v", "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"scale", "-", 
       RowBox[{"aware", " ", "epsilon"}]}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"Parallel", " ", "or", " ", "nearly", " ", "so"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "denom", "]"}], "<", "eps"}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"cross2", "[", 
        RowBox[{"w", ",", "v"}], "]"}], "/", "denom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"cross2", "[", 
        RowBox[{"w", ",", "d"}], "]"}], "/", "denom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "===", "ComplexInfinity"}], "||", 
        RowBox[{"u", "===", "ComplexInfinity"}]}], ",", "False", ",", 
       RowBox[{
        RowBox[{"t", ">=", "0"}], "&&", 
        RowBox[{"0", "<=", "u", "<=", "1"}]}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointSegmentDistance", "[", 
   RowBox[{
    RowBox[{"r0_", "?", "VectorQ"}], ",", 
    RowBox[{"s0_", "?", "VectorQ"}], ",", 
    RowBox[{"s1_", "?", "VectorQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"s1", "-", "s0"}]}], ",", 
      RowBox[{"w", "=", 
       RowBox[{"r0", "-", "s0"}]}], ",", "u", ",", "uClamped", ",", "closest",
       ",", "eps"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eps", "=", 
      RowBox[{
       RowBox[{"10", "^", "3"}], " ", "$MachineEpsilon", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Norm", "[", "s0", "]"}], "+", 
         RowBox[{"Norm", "[", "s1", "]"}], "+", "1."}], ")"}]}]}], ";", "\n", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "v", "]"}], "<", "eps"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"Norm", "[", 
         RowBox[{"r0", "-", "s0"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w", ".", "v"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"v", ".", "v"}], ")"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"projection", " ", "parameter"}], "*)"}], 
     RowBox[{"uClamped", "=", 
      RowBox[{"Clip", "[", 
       RowBox[{"u", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"clamp", " ", "to", " ", "segment"}], "*)"}], 
     RowBox[{"closest", "=", 
      RowBox[{"s0", "+", 
       RowBox[{"uClamped", " ", "v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{"r0", "-", "closest"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"raySegmentIntersection", "[", 
   RowBox[{
    RowBox[{"r0_", "?", "VectorQ"}], ",", 
    RowBox[{"d_", "?", "VectorQ"}], ",", 
    RowBox[{"s0_", "?", "VectorQ"}], ",", 
    RowBox[{"s1_", "?", "VectorQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "w", ",", "denom", ",", "t", ",", "u", ",", "eps"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"s1", "-", "s0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"s0", "-", "r0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"denom", "=", 
      RowBox[{"cross2", "[", 
       RowBox[{"d", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eps", "=", 
      RowBox[{
       RowBox[{"10", "^", "3"}], " ", "$MachineEpsilon", " ", 
       RowBox[{"Norm", "[", "d", "]"}], " ", 
       RowBox[{"Norm", "[", "v", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "denom", "]"}], "<", "eps"}], ",", 
       RowBox[{"Return", "[", "None", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"cross2", "[", 
        RowBox[{"w", ",", "v"}], "]"}], "/", "denom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"cross2", "[", 
        RowBox[{"w", ",", "d"}], "]"}], "/", "denom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "===", "ComplexInfinity"}], "||", 
          RowBox[{"u", "===", "ComplexInfinity"}]}], ",", "False", ",", 
         RowBox[{
          RowBox[{"t", ">=", "0"}], "&&", 
          RowBox[{"0", "<=", "u", "<=", "1"}]}]}], "]"}], ",", 
       RowBox[{"r0", "+", 
        RowBox[{"t", " ", "d"}]}], ",", "None"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.97387783638405*^9, 3.973877849009849*^9}, {
   3.973878062273469*^9, 3.973878062476338*^9}, {3.97387810794551*^9, 
   3.973878108117669*^9}, {3.973879669292726*^9, 3.9738796835144653`*^9}, {
   3.973879878518838*^9, 3.9738798863200207`*^9}, {3.9738799288054113`*^9, 
   3.9738799451200333`*^9}, {3.973880381803137*^9, 3.973880388094208*^9}, {
   3.9738824792146473`*^9, 3.973882551872081*^9}, {3.9738825942095747`*^9, 
   3.973882598740004*^9}, {3.973882773646428*^9, 3.9738827914431267`*^9}, 
   3.973882858754004*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"470d4443-1f7e-496c-ba72-a0c44756b662"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesBarbPoly", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Rules", " ", "for", " ", "elongating", " ", "a", " ", "two", " ", 
       "node", " ", "graph"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "distNext"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "s1", ",", "s2", ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}]}], "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "distNext"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "s1", ",", "s2", ",", 
         "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Rule", " ", "for", " ", "elongating", " ", "using", " ", "free", " ",
          "actin"}], "-", "ADP"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", 
            "nucleotide"}], "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Rule", " ", "for", " ", "elongating", " ", "using", " ", "free", " ",
          "actin"}], "-", "ATP"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", 
            "nucleotide"}], "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nextArpID", ",", 
            "filamentAngle", ",", "branchAngle", ",", "nucleotide"}], "]"}]}],
          ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Rule", " ", "for", " ", "elongating", " ", "using", " ", "free", " ",
          "actin"}], "-", "ATP"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nextArpID", ",", 
            "filamentAngle", ",", "branchAngle", ",", "nucleotide"}], "]"}]}],
          ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", " ", "NID", ",", " ", "randAng", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nullPointer", ",", 
           "IDNextNextABP", ",", "filamentAngleNext", ",", "branchAngleNext", 
           ",", "nucleotideNext"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "IDNextNextABP", ",", 
           "randAng", ",", "branchAngleNext", ",", "nucleotideNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nullPointer", ",", 
           "IDNextNextABP", ",", "filamentAngleNext", ",", "branchAngleNext", 
           ",", "nucleotideNext"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "IDNextNextABP", ",", 
           "randAng", ",", "branchAngleNext", ",", "nucleotideNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nullPointer", ",", 
           "IDNextNextABP", ",", "filamentAngleNext", ",", "branchAngleNext", 
           ",", "nucleotideNext"}], "]"}], ",", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "IDNextNextABP", ",", 
           "randAng", ",", "branchAngleNext", ",", "nucleotideNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nullPointer", ",", 
           "IDNextNextABP", ",", "filamentAngleNext", ",", "branchAngleNext", 
           ",", "nucleotideNext"}], "]"}], ",", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "IDNextNextABP", ",", 
           "randAng", ",", "branchAngleNext", ",", "nucleotideNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Rules", " ", "for", " ", "nucleating", " ", "an", " ", "arp", " ", 
        "branch"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "nextActinID", ",", "nextArpID", ",", 
            "filamentAngle", ",", "branchAngle", ",", "nucleotide"}], "]"}]}],
          ",", "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "nextArpID", ",", "coordsNext", ",", "nullPointer", ",", "arpAngle",
            ",", "ABPRule"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "nextArpID", ",", "coordsNext", ",", "NID", ",", "randAng", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "nextActinID", ",", "nextArpID", ",", 
            "filamentAngle", ",", "branchAngle", ",", "nucleotide"}], "]"}]}],
          ",", "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "nextArpID", ",", "coordsNext", ",", "nullPointer", ",", "arpAngle",
            ",", "ABPRule"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "nextArpID", ",", "coordsNext", ",", "NID", ",", "randAng", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], " ", "numActin", "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Rule", " ", "for", " ", "penultimate", " ", "object", " ", "being", " ",
         "an", " ", "arp"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"ABP", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ABPRule"}], 
           "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "\n", "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "randAng", ",", 
           "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ATP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedT", "/", "nCG"}], " ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Rule", " ", "for", " ", "penultimate", " ", "object", " ", "being", " ",
         "an", " ", "arp"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", " ", "==", " ", 
          RowBox[{"ABP", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ABPRule"}], 
           "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", " ", "\n", 
         RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
           "]"}]}]}], "\n", "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aP", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
            "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "NID", ",", "randAng", ",", 
           "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", 
             RowBox[{"raySegmentIntersection", "[", 
              RowBox[{"coordsNext", ",", 
               RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
               "sCoordNext"}], "]"}], ",", 
             RowBox[{"coordsNext", "+", 
              RowBox[{"actinObjectRise", " ", 
               RowBox[{
                RowBox[{"newPos", "[", 
                 RowBox[{
                  RowBox[{"coordsNext", "-", "coords"}], ",", " ", 
                  "randAng"}], "]"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}]}]}], "]"}], 
           ",", "ADP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"pointSegmentDistance", "[", 
               RowBox[{"coordsNext", ",", "sCoord", ",", "sCoordNext"}], 
               "]"}], "<", "overgrowthL"}], ",", "sID", ",", "nullPointer"}], 
            "]"}], ",", "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"kPlusBarbedD", "/", "nCG"}], "  ", "numActin", "*", " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
          "randAng"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"numActin", ">", "nCG"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{"rayIntersectsSegmentQ", "[", 
          RowBox[{"coordsNext", ",", 
           RowBox[{"coordsNext", "-", "coords"}], ",", "sCoord", ",", 
           "sCoordNext"}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesBarbRetr", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{"**", 
       RowBox[{
       "*", " ", "retraction", " ", "at", " ", "the", " ", "barbed", " ", 
        "end"}]}], " ", "****)"}], "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "*", " ", "remove", " ", "one", " ", "actin", " ", "when", " ", "the", 
        " ", "previous", " ", "is", " ", "an", " ", "actin"}], ",", " ", 
       RowBox[{"removal", " ", "of", " ", "an", " ", "actin"}]}], "  ", 
      "**)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"X", " ", "->", " ", 
       RowBox[{"newActinEnd", " ", "->", " ", "oldActinEnd"}]}], " ", "*)"}], 
     "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ATP", ",", "spineID", ",",
            "dist"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActinATP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActinATP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedT", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ADPPlusPi", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ADP", ",", "spineID", ",",
            "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ATP", ",", "spineID", ",",
            "dist"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActinATP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActinATP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedT", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ADPPlusPi", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "ADP", ",", "spineID", ",",
            "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", " ", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "ATP", ",", "spineID", ",", 
           "dist"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActinATP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "nullPointer", ",", "0.0", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActinATP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedT", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", " ", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "ADPPlusPi", ",", "spineID", ",", 
           "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "nullPointer", ",", "0.0", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", " ", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "ADP", ",", "spineID", ",", 
           "dist"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numActinADP", "]"}]}], "\n", "}"}], 
       " ", "->", " ", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "nullPointer", ",", "0.0", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numActinADP", "+", "nCG"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"kMinusBarbedD", "/", "nCG"}], "]"}]}], "\n", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesBarb", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"rulesBarbPoly", ",", "rulesBarbRetr"}], "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.964467522443225*^9, 3.9644676184165907`*^9}, {
   3.9644676562825003`*^9, 3.964467686251464*^9}, {3.964467721182863*^9, 
   3.9644678259028587`*^9}, {3.964467858520474*^9, 3.96446788720788*^9}, {
   3.96446792156087*^9, 3.9644679435713177`*^9}, 3.9644679736178627`*^9, {
   3.964468005113721*^9, 3.96446806036543*^9}, {3.964468207402034*^9, 
   3.964468455774795*^9}, {3.964468675820622*^9, 3.964468743795603*^9}, {
   3.9650528184234047`*^9, 3.9650528638023567`*^9}, {3.965353076584258*^9, 
   3.965353082608342*^9}, {3.9684307524864817`*^9, 3.968430772207387*^9}, {
   3.968430894961307*^9, 3.968430907339446*^9}, 3.968956226423935*^9, {
   3.972508967770224*^9, 3.9725089729962587`*^9}, {3.9725101304335623`*^9, 
   3.97251013581369*^9}, {3.972510986032556*^9, 3.9725109908800793`*^9}, {
   3.9738777108993673`*^9, 3.973877778367818*^9}, {3.973877875953421*^9, 
   3.973877952930793*^9}, {3.973877992677676*^9, 3.973877996186987*^9}, {
   3.973878048980028*^9, 3.9738781202504053`*^9}, {3.973878167811655*^9, 
   3.973878273350013*^9}, {3.973878306582798*^9, 3.973878632601265*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"9666f068-bdf9-4030-a53c-28f957db758c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pointed End Rules", "Section",ExpressionUUID->"18b0aa7e-5bfc-48bc-b787-d8ea185d07d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"rules", " ", "for", " ", "model", " ", "b"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesPointPoly", " ", "=", " ", 
     RowBox[{"{", "\n", 
      RowBox[{"(*", 
       RowBox[{"Two", "-", 
        RowBox[{"node", " ", "pointed", " ", "end", " ", "elongation"}]}], 
       "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
             "spineIDNext", ",", "distNext"}], "]"}]}], ",", " ", "\n", 
          RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aN", ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
             "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
            "node"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], "\n", 
         "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "numActin", "*", " ", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
           "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
             "spineIDNext", ",", "distNext"}], "]"}]}], ",", " ", "\n", 
          RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aN", ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
             "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
            "node"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ADP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], "\n", 
         "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "numActin", "*", " ", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
           "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{"Two", "-", 
         RowBox[{"node", " ", "pointed", " ", "end", " ", "elongation"}]}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "nucleotideNext"}], 
            "]"}]}], ",", " ", "\n", 
          RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aN", ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
             "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
            "node"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], "\n", 
         "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "numActin", "*", " ", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
           "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "nucleotideNext"}], 
            "]"}]}], ",", " ", "\n", 
          RowBox[{"newID", "[", "NID", "]"}], ",", "\n", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "aN", ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "replacement", " ", "node", " ", "for", " ",
             "the", " ", "new", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
            "node"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ADP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], "\n", 
         "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "numActin", "*", " ", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", " ", "\[Theta]p"}], "]"}], ",", " ", 
           "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
        "elongation", " ", "at", " ", "the", " ", "pointed", " ", "end"}], 
        " ", "*)"}], "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
        "identical", " ", "in", " ", "many", " ", "ways", " ", "to", " ", 
         "the", " ", "barbed", " ", "end", " ", "elongation"}], "*)"}], "\n", 
       
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "nucleotide", ",",
             "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
             "angleNext", ",", "nucleotideNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Rule", " ", "for", " ", "elongating", " ", "in", " ", "the", " ", 
          "presence", " ", "of", " ", "free", " ", "actin"}], "-", "ADP"}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "nucleotide", ",",
             "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
             "angleNext", ",", "nucleotideNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinADPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ADP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJuncEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",",
             "angle", ",", "angleABP", ",", "nucleotide"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
             "angleNext", ",", "nucleotideNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",", 
            RowBox[{"-", "randAng"}], ",", "angleABP", ",", "nucleotide"}], 
           "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Rule", " ", "for", " ", "elongating", " ", "in", " ", "the", " ", 
          "presence", " ", "of", " ", "free", " ", "actin"}], "-", "ADP"}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJuncEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",",
             "angle", ",", "angleABP", ",", "nucleotide"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
             "angleNext", ",", "nucleotideNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinADPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",", 
            RowBox[{"-", "randAng"}], ",", "angleABP", ",", "nucleotide"}], 
           "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ADP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], ",", "s1", ",", "s2"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJuncEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",",
             "angle", ",", "angleABP", ",", "nucleotide"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", "nucleotideNext", ",", 
             "spineIDNext", ",", "distNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",", 
            RowBox[{"-", "randAng"}], ",", "angleABP", ",", "nucleotide"}], 
           "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}], " ", ",", "s1", ",", "s2"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Rule", " ", "for", " ", "elongating", " ", "in", " ", "the", " ", 
          "presence", " ", "of", " ", "free", " ", "actin"}], "-", "ADP"}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actinJuncEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",",
             "angle", ",", "angleABP", ",", "nucleotide"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNext", ",", " ", "coordsNext", ",", "nucleotideNext", ",", 
             "spineIDNext", ",", "distNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinADPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "s1", ",", "s2", ",", "\n", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "IDNextABP", ",", 
            RowBox[{"-", "randAng"}], ",", "angleABP", ",", "nucleotide"}], 
           "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "nucleotide", ",",
             "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             "IDNextNextJunc", ",", "angleNext", ",", "angleNextJunc", ",", 
             "nucleotideNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "s1", ",", "s2", ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ATP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedT", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Rule", " ", "for", " ", "elongating", " ", "in", " ", "the", " ", 
          "presence", " ", "of", " ", "free", " ", "actin"}], "-", "ADP"}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "nucleotide", ",",
             "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             "IDNextNextJunc", ",", "angleNext", ",", "angleNextJunc", ",", 
             "nucleotideNext"}], "]"}]}], ",", "  ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinADPCount", "[", "numActin", "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sID", ",", "sCoord", ",", "sIDNext"}], "]"}]}], ",", 
          RowBox[{"s2", "==", 
           RowBox[{"spine", "[", 
            RowBox[{"sIDNext", ",", "sCoordNext", ",", "sIDNextNext"}], 
            "]"}]}]}], "}"}], " ", "->", " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinADPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "s1", ",", "s2", ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"actin", "[", 
           RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
            RowBox[{"-", "randAng"}], ",", "nucleotide"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "make", " ", "the", " ", "new", " ", "node", " ", "at", " ", "the",
             " ", "pointed", " ", "end"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{"NID", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", 
              RowBox[{"raySegmentIntersection", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
                "sCoordNext"}], "]"}], ",", 
              RowBox[{"coords", "+", 
               RowBox[{"actinObjectRise", " ", 
                RowBox[{
                 RowBox[{"newPos", "[", 
                  RowBox[{
                   RowBox[{"coords", "-", "coordsNext"}], ",", " ", 
                   "randAng"}], "]"}], "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords", "-", "coordsNext"}], "]"}]}]}]}]}], "]"}],
             ",", "ID", ",", "ADP", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pointSegmentDistance", "[", 
                RowBox[{"coords", ",", "sCoord", ",", "sCoordNext"}], "]"}], "<",
                "overgrowthL"}], ",", "sID", ",", "nullPointer"}], "]"}], ",",
             "actinObjectRise"}], "]"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"same", " ", "as", " ", "with", " ", "barbed"}], ",", " ", 
           
           RowBox[{
           "for", " ", "the", " ", "sake", " ", "of", " ", "simplicity", " ", 
            "it", " ", "will", " ", "grow", " ", "in", " ", "a", " ", 
            "simple", " ", "line"}]}], " ", "*)"}], "\n", "}"}]}], ",", "\n", 
       
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"numActin", ">", "nCG"}], "]"}], 
         RowBox[{"kPlusPointedD", "/", "nCG"}], " ", "*", "numActin", "*", 
         RowBox[{"grammarPDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0.0", ",", "\[Theta]p"}], "]"}], ",", "randAng"}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{"rayIntersectsSegmentQ", "[", 
           RowBox[{"coords", ",", 
            RowBox[{"coords", "-", "coordsNext"}], ",", "sCoord", ",", 
            "sCoordNext"}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"rulesPointRetr", "=", 
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "retraction", " ", "at", " ", "the", " ", "pointed", " ", "end"}], " ",
        "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "ATP", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
            "angleNext", ",", "nucleotideNext"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", " ", "coordsNextNext", ",", " ", 
             "IDNextNextNext", ",", "angleNextNext", ",", 
             "nucleotideNextNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}]}], "}"}], " ", "->",
         " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
            "nucleotideNext", ",", "nullPointer", ",", "actinObjectRise"}], 
           "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{"kMinusPointedT", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "ADP", ",", 
            "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
            "angleNext", ",", "nucleotideNext"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", " ", "coordsNextNext", ",", " ", 
             "IDNextNextNext", ",", "angleNextNext", ",", 
             "nucleotideNextNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}]}], "}"}], " ", "->",
         " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
            "nucleotideNext", ",", "nullPointer", ",", "actinObjectRise"}], 
           "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{"kMinusPointedD", "/", "nCG"}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "ADPPlusPi", ",",
             "nullPointer", ",", "dist"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
            "angleNext", ",", "nucleotideNext"}], "]"}], ",", 
          RowBox[{"aN", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", " ", "coordsNextNext", ",", " ", 
             "IDNextNextNext", ",", "angleNextNext", ",", 
             "nucleotideNextNext"}], "]"}]}], ",", " ", 
          RowBox[{"newID", "[", "NID", "]"}], ",", 
          RowBox[{"actinATPCount", "[", "numActin", "]"}]}], "}"}], " ", "->",
         " ", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actinATPCount", "[", 
           RowBox[{"numActin", "-", "nCG"}], "]"}], ",", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "update", " ", "the", " ", "newID", " ", "object", " ", "so", " ", 
            "it", " ", "can", " ", "create", " ", "unique", " ", "object", " ",
             "ids"}], " ", "*)"}], "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"NID", " ", "+", " ", "1"}], "]"}], ",", "\n", "aN", ",", 
          "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
           "recreate", " ", "the", " ", "current", " ", "node", " ", "as", " ",
             "a", " ", "INT"}], " ", "*)"}], "\n", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
            "nucleotideNext", ",", "nullPointer", ",", "actinObjectRise"}], 
           "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{"kMinusPointedD", "/", "nCG"}], "]"}]}], "\n", "}"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesPoint", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"rulesPointPoly", ",", "rulesPointRetr"}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.964468081703266*^9, 3.9644681227995253`*^9}, {
  3.964468465248886*^9, 3.964468650035426*^9}, {3.964468749365196*^9, 
  3.964468821806451*^9}, {3.965052873881147*^9, 3.965052911900221*^9}, {
  3.9684307811106167`*^9, 3.968430809046693*^9}, {3.9684308758021*^9, 
  3.968430886931885*^9}, {3.9738786523571777`*^9, 3.973878777499116*^9}, {
  3.9738788458110027`*^9, 3.973878943525873*^9}, {3.973878989513628*^9, 
  3.9738792044705544`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"a3918d5f-561b-4c76-ad41-da055754576a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Branching Rules", "Section",ExpressionUUID->"ef62b9dd-c0b5-4c90-854f-67837ae46014"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesBranchAdd", " ", "=", " ", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "arp", " ", "binding", " ", "to", " ", "open", " ", "actin", " ", 
       "monomer"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aP", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", " ", "coords", ",", " ", "IDNext", ",", "angle", ",", 
            "nucleotide"}], "]"}]}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", " ", "coordsNext", ",", " ", "IDNextNext", ",", 
           "angleNext", ",", "nucleotideNext"}], "]"}], ",", 
         RowBox[{"aN", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNextNext", ",", " ", "coordsNextNext", ",", " ", 
            "IDNextNextNext", ",", "angleNextNext", ",", 
            "nucleotideNextNext"}], "]"}]}], ",", 
         RowBox[{"newID", "[", "NID", "]"}], ",", 
         RowBox[{"arpCount", "[", "numArp", "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], " ", "->", " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"newID", "[", 
          RowBox[{"NID", "+", "1"}], "]"}], ",", "aP", ",", "aN", ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "arpcount", " ", "variable"}], 
          " ", "*)"}], "\n", 
         RowBox[{"arpCount", "[", 
          RowBox[{"numArp", " ", "-", " ", "1"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{"re", "-", 
           RowBox[{
           "create", " ", "the", " ", "current", " ", "actin", " ", "monomer",
             " ", "and", " ", "have", " ", "it", " ", "point", " ", "to", " ",
             "the", " ", "new", " ", "arp", " ", "protein"}]}], " ", "*)"}], 
         "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "NID", ",", 
           "angleNext", ",", 
           RowBox[{"\[Theta]Arp", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", 
               RowBox[{"Boole", "[", 
                RowBox[{"branchSide", ">", "0.5"}], "]"}]}]}], ")"}]}], ",", 
           "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "make", " ", "the", " ", "newly", " ", "created", " ", "end", " ", 
           "node"}], " ", "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{"NID", ",", 
           RowBox[{"coordsNext", "+", 
            RowBox[{"arp23Height", " ", 
             RowBox[{
              RowBox[{"newPos", "[", 
               RowBox[{
                RowBox[{"coordsNextNext", "-", "coordsNext"}], ",", " ", 
                RowBox[{"\[Theta]Arp", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"branchSide", ">", "0.5"}], "]"}]}]}], ")"}]}]}], 
               "]"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNextNext", "-", "coordsNext"}], "]"}]}]}]}], ",",
            "nullPointer", ",", "0.0", ",", "arpRule"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{"numArp", ">", "1."}], "]"}], "numArp", "*", "kbranch", "*", 
        
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"UniformDistribution", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}], "]"}], ",", " ", 
          "branchSide"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"nucleotideNext", "!=", "camABP"}], "&&", 
          RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
          RowBox[{"nucleotideNext", "!=", "cofilinSingle"}], "&&", 
          RowBox[{"nucleotideNext", "!=", "aip1"}]}], "]"}]}], "]"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesArpUnbind", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "arp", " ", "unbinding", " ", "from", " ", "the", " ", "arp", " ", 
       "complex", " ", "if", " ", "it", " ", "is", " ", "the", " ", "last", " ",
        "monomer", " ", "and", " ", "has", " ", "no", " ", "branches", " ", 
       "from", " ", "it"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDArp", ",", 
           "filamentAngle", ",", "branchAngle", ",", "nucleotide"}], "]"}], ",",
          " ", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDArp", ",", "coordsArp", ",", "nullPointer", ",", "angle", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"arpCount", "[", "numArp", "]"}]}], "\n", "}"}], " ", "->", 
       " ", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"arpCount", "[", 
          RowBox[{"numArp", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "recreate", " ", "the", " ", "arp", " ", "complex", " ", "and", " ",
            "have", " ", "it", " ", "point", " ", "to", " ", "empty", " ", 
           "space"}], " ", "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "filamentAngle", ",", 
           "nucleotide"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "kminus2", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDArp", ",", "coordsArp", ",", "IDNext", ",", "0.", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"arpCount", "[", "numArp", "]"}]}], "}"}], "->", 
       "\[IndentingNewLine]", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "IDArp", ",", "coordsArp", ",", "IDNext", ",", "ADP", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"arpCount", "[", 
          RowBox[{"numArp", "+", "1."}], "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"with", "[", "kNucOff", "]"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesBranch", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"rulesBranchAdd", ",", "rulesArpUnbind"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9636674583788223`*^9, 3.9636674605944843`*^9}, {
   3.964480096721274*^9, 3.964480106154224*^9}, {3.964893458698596*^9, 
   3.964893549562148*^9}, {3.965332629658492*^9, 3.965332630273047*^9}, 
   3.965333828966013*^9, {3.9653540701213903`*^9, 3.965354072838312*^9}, {
   3.968430825978141*^9, 3.968430867399955*^9}, {3.969812857909651*^9, 
   3.969812860275828*^9}, {3.9702384721398773`*^9, 3.970238477831417*^9}, {
   3.972512567379486*^9, 3.972512685698597*^9}, {3.9725191222650146`*^9, 
   3.972519259586018*^9}, {3.9725192938946238`*^9, 3.972519297861651*^9}, {
   3.9732796166499243`*^9, 3.973279620704199*^9}, {3.9732796953916492`*^9, 
   3.973279695592318*^9}, {3.9738970301181517`*^9, 3.973897044481793*^9}, {
   3.976878248172185*^9, 3.9768782496961327`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"bf5d21a1-d1d5-454b-a511-c8601341de0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cofilin Rules", "Section",
 CellChangeTimes->{{3.8452255087867575`*^9, 3.8452255123363495`*^9}, {
  3.948600302455357*^9, 
  3.948600303169815*^9}},ExpressionUUID->"7b30f901-caee-4ba7-ba92-\
70d0a80d5dc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesCofBind", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Bind", " ", "and", " ", "unbind", " ", "Cofilin", " ", "to", " ", 
       "actin"}], "-", "ADP"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", 
          "cofilinSingle"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "1"}], "]"}], ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{"kOnSingleCof", "*", "numCofilin", "*", "nCG", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angleNext", ",",
           "angleABP", ",", "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angleNext", ",",
           "angleABP", ",", "cofilinSingle"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "1"}], "]"}], ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{"kOnSingleCof", "*", "numCofilin", "*", "nCG", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", 
          "cofilinSingle"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", 
          "cofilin"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{"2", 
       RowBox[{"kOnCofEdge", "/", "nCG"}], "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angleNext", ",",
           "angleABP", ",", "cofilinSingle"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angleNext", ",",
           "angleABP", ",", "cofilin"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{"2", 
       RowBox[{"kOnCofEdge", "/", "nCG"}], "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Accelerated", " ", "bind", " ", "cofilin"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a1", "==", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "cofilin"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"actin", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
           "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
           "cofilin"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a1", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"a2", "==", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "cofilin"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", 
          "cofilin"}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a2", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], " ", "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a1", "==", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "cofilin"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"actin", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
           "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
           "cofilin"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a1", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"a2", "==", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
            "angleNext", ",", "angleNextABP", ",", "cofilin"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actin", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", 
          "cofilin"}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a2", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], " ", "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a1", "==", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "cofilin"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
           "angleNext", ",", "angleNextABP", ",", "ADP"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
           "angleNext", ",", "angleNextABP", ",", "cofilin"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a1", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",", 
          "angleABP", ",", "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"a2", "==", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "cofilin"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", "numCofilin", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"actinJunc", "[", 
         RowBox[{
         "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",", 
          "angleABP", ",", "cofilin"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"cofilinCount", "[", 
         RowBox[{"numCofilin", "-", "nCG"}], "]"}], ",", "a2", ",", 
        RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"with", "[", 
      RowBox[{
       RowBox[{"kOnCofEdge", "/", "nCG"}], " ", "*", "numCofilin", " ", 
       RowBox[{"Boole", "[", 
        RowBox[{"numCofilin", ">=", "nCG"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesCofOff", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Accelerated", " ", "off", " ", "cofilin"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "cofilin"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ADP"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"a2", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "cofilin"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
          "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], " ", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
             "angleABP", ",", "cofilin"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"a2", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
             "angleNext", ",", "angleNextABP", ",", "cofilin"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angleNext", ",", "ADP"}], 
          "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
            "angleNext", ",", "angleNextABP", ",", "ADP"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], " ", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "cofilin"}],
            "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
            "angleNext", ",", "angleNextABP", ",", "ADP"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ADP"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
            "angleNext", ",", "angleNextABP", ",", "ADP"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"a2", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "cofilin"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], 
        "\[IndentingNewLine]", "}"}], "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "ADP"}], "]"}], ",", " ", "\[IndentingNewLine]", 
         
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ADP"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", "nCG"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kOffCof", "/", "nCG"}], " ", "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesCofPiRelease", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "cofilin"}], 
           "]"}]}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADPPlusPi"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"cofact", ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADP"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ADPPlusPi"}], 
          "]"}], ",", 
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angNext", ",",
             "cofilin"}], "]"}]}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", " ", "coords", ",", "IDNext", ",", "ang", ",", "ADP"}], 
          "]"}], ",", "cofact", ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cofact", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
            "angABP", ",", "cofilin"}], "]"}]}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADPPlusPi"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"cofact", ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADP"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "ADPPlusPi"}], 
          "]"}], ",", 
         RowBox[{"cofact", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDNextABP", ",",
             "angNext", ",", "angNextABP", ",", "cofilin"}], "]"}]}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", " ", "coords", ",", "IDNext", ",", "ang", ",", "ADP"}], 
          "]"}], ",", "cofact", ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "cofilin"}], 
           "]"}]}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADPPlusPi"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"cofact", ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "angNext", ",", 
           "ADP"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",", 
           "angABP", ",", "ADPPlusPi"}], "]"}], ",", 
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angNext", ",",
             "cofilin"}], "]"}]}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", " ", "coords", ",", "IDNext", ",", "IDABP", ",", "ang", ",",
            "angABP", ",", "ADP"}], "]"}], ",", "cofact", ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "cofilin"}], 
           "]"}]}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "IDNextABP", ",", 
           "angNext", ",", "angNextABP", ",", "ADPPlusPi"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"cofact", ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "IDNextNext", ",", "IDNextABP", ",", 
           "angNext", ",", "angNextABP", ",", "ADP"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "ang", ",", "cofilin"}], 
           "]"}]}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "ADPPlusPi", ",", "spineID", ",", 
           "dist"}], "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"cofact", ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsN", ",", "ADP", ",", "spineID", ",", "dist"}],
           "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "ADPPlusPi", ",", "spineID", ",", 
           "dist"}], "]"}], ",", 
         RowBox[{"cofact", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angNext", ",",
             "cofilin"}], "]"}]}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", " ", "coords", ",", "ADP", ",", "spineID", ",", "dist"}],
           "]"}], ",", "cofact", ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"kCofPiRelease", "/", "nCG"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"debranch", " ", "filaments"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesDebranch", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDParentNext", ",", "IDNext", ",", 
           "angleParent", ",", "angleABP", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "ABPRule"}], "]"}]}], "\n", "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDParentNext", ",", "angleParent", ",", 
           "nucleotide"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "0.", ",", 
           "ABPRule"}], "]"}]}], "\n", "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"debranchRate", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[Sigma]ArpCof", "*", 
            RowBox[{"Boole", "[", 
             RowBox[{"nucleotide", "==", "cofilin"}], "]"}]}], "]"}]}], "+", 
         RowBox[{"compRate", 
          RowBox[{"(", 
           RowBox[{"Boole", "[", 
            RowBox[{"nucleotide", "==", "cofilin"}], "]"}], ")"}]}]}], ")"}], 
       "]"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"sever", " ", "filaments"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesMechSever", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}],
        "->", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "nucleotideNextNext", ",", "nullPointer", ",", "actinObjectRise"}],
           "]"}]}], "\n", "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "cofAngle"}]}], 
             ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "cofAngle"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}]}], ")"}], "&&", 
            
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "bareAngle"}], "||", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "bareAngle"}]}], ")"}]}], ")"}]}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP",
            ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextNextABP", ",", "0.", ",", "angleNextNextABP", ",", 
           "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "cofAngle"}]}], 
             ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "cofAngle"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}]}], ")"}], "&&", 
            
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "bareAngle"}], "||", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "bareAngle"}]}], ")"}]}], ")"}]}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
           "IDNextNextABP", ",", "angleNext", ",", "angleNextABP", ",", 
           "nucleotideNext"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}],
        "->", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actinJuncEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nullPointer", ",", 
           "IDNextNextABP", ",", "0.", ",", "angleNextABP", ",", 
           "nucleotideNext"}], "]"}], ",", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "nucleotideNextNext", ",", "nullPointer", ",", "actinObjectRise"}],
           "]"}]}], "\n", "}"}]}], ",", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "cofAngle"}]}], 
             ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "cofAngle"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "==", "cofilin"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "angleNext", "]"}], ">", 
                 "boundaryAngle"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
                 "boundaryAngle"}]}], ")"}]}], ")"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nucleotideNext", "!=", "cofilin"}], "&&", 
              RowBox[{"nucleotideNextNext", "!=", "cofilin"}]}], ")"}], "&&", 
            
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "angleNext", "]"}], ">", "bareAngle"}], "||", 
              RowBox[{
               RowBox[{"Abs", "[", "angleNextNext", "]"}], ">", 
               "bareAngle"}]}], ")"}]}], ")"}]}], "]"}]}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesCof", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rulesCofBind", ",", "rulesCofOff", ",", "rulesCofPiRelease", ",", 
     "rulesMechSever", ",", "rulesDebranch"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8452255362143884`*^9, 3.8452256771200504`*^9}, {
   3.8452257163492823`*^9, 3.845225833850254*^9}, {3.845227665471175*^9, 
   3.8452276662692013`*^9}, {3.845227832607931*^9, 3.845227833532648*^9}, {
   3.859558674095551*^9, 3.85955869453555*^9}, {3.86170149093228*^9, 
   3.861701524477656*^9}, {3.861701566838954*^9, 3.861701568278117*^9}, {
   3.86170160910188*^9, 3.86170161433533*^9}, {3.8617035837021303`*^9, 
   3.861703617616363*^9}, {3.8617037575088053`*^9, 3.861703773712944*^9}, {
   3.861703805333394*^9, 3.861703830825732*^9}, {3.8620879829079103`*^9, 
   3.8620880071550503`*^9}, {3.862618501291379*^9, 3.8626186099357224`*^9}, {
   3.864992018196658*^9, 3.86499201819814*^9}, {3.865006501516026*^9, 
   3.865006553640764*^9}, 3.865006601781831*^9, {3.865006637978092*^9, 
   3.865006667923307*^9}, {3.865006949931422*^9, 3.865006954484827*^9}, {
   3.866398926041472*^9, 3.866398935562561*^9}, {3.875307588438367*^9, 
   3.875307599369028*^9}, {3.876536246929028*^9, 3.876536248828474*^9}, {
   3.8765379498490973`*^9, 3.876537955691831*^9}, {3.876871381467639*^9, 
   3.876871402344141*^9}, {3.876969261999645*^9, 3.8769692676565447`*^9}, 
   3.877619459215231*^9, {3.8809720398410473`*^9, 3.880972059765266*^9}, {
   3.880972136884095*^9, 3.8809721368848543`*^9}, 3.880972346211713*^9, {
   3.880972745926051*^9, 3.8809727602772913`*^9}, {3.880975610744978*^9, 
   3.880975618815565*^9}, 3.8809756596476107`*^9, {3.886604563991837*^9, 
   3.886604580805167*^9}, {3.886604626303287*^9, 3.8866046832358303`*^9}, {
   3.886617817121861*^9, 3.886617819398931*^9}, {3.886618325310409*^9, 
   3.886618331800823*^9}, {3.886618821864661*^9, 3.886618855289954*^9}, {
   3.886696624563724*^9, 3.886696637075878*^9}, {3.8868108297560315`*^9, 
   3.88681083024487*^9}, {3.8868109170681725`*^9, 3.8868109172920165`*^9}, {
   3.88681498732647*^9, 3.886814989009339*^9}, {3.8868152648224564`*^9, 
   3.8868152702736564`*^9}, {3.8868520064567423`*^9, 3.886852069185646*^9}, {
   3.886928609255768*^9, 3.886928618035972*^9}, {3.8869292932003636`*^9, 
   3.886929447636284*^9}, {3.886929511100661*^9, 3.886929517918938*^9}, {
   3.886929563110797*^9, 3.8869296235939803`*^9}, {3.8869297205006824`*^9, 
   3.8869297531250153`*^9}, 3.886929784567851*^9, {3.886929836681322*^9, 
   3.886929859756592*^9}, 3.886930405521248*^9, {3.8869305482897353`*^9, 
   3.8869305870165434`*^9}, {3.8869306229189835`*^9, 3.886930630199312*^9}, {
   3.8869371070711656`*^9, 3.8869373510903444`*^9}, {3.886937384165498*^9, 
   3.8869374064098215`*^9}, {3.8869464946819167`*^9, 3.886946673691471*^9}, {
   3.8869469598982024`*^9, 3.8869469736094503`*^9}, {3.8869470875616207`*^9, 
   3.886947100322337*^9}, {3.8869471445227575`*^9, 3.8869471547476616`*^9}, {
   3.8869471904508104`*^9, 3.886947191488145*^9}, {3.8869631170745835`*^9, 
   3.886963124053014*^9}, {3.8871601086588464`*^9, 3.887160117333048*^9}, {
   3.8872403106661325`*^9, 3.887240310760335*^9}, {3.887259982473611*^9, 
   3.8872599907766924`*^9}, {3.88726283249045*^9, 3.8872629357939005`*^9}, {
   3.887262967604345*^9, 3.887262975943125*^9}, {3.8872632224548373`*^9, 
   3.8872632263112507`*^9}, {3.887263257083233*^9, 3.8872633133515854`*^9}, {
   3.8872633808680887`*^9, 3.8872634301152277`*^9}, {3.8872634703097267`*^9, 
   3.8872634927599325`*^9}, {3.88726354134254*^9, 3.887263822713761*^9}, {
   3.8872639752555237`*^9, 3.8872639828785934`*^9}, {3.8872644279522467`*^9, 
   3.887264431088685*^9}, {3.887264618296976*^9, 3.8872646207619815`*^9}, {
   3.887265870239401*^9, 3.887265878239492*^9}, {3.887265970821372*^9, 
   3.8872659941804266`*^9}, {3.8872857417758455`*^9, 3.887285804956603*^9}, {
   3.8872858488917117`*^9, 3.8872859324919896`*^9}, {3.887286412202639*^9, 
   3.8872864383058577`*^9}, {3.8872865808883047`*^9, 3.887286614409294*^9}, {
   3.887297859071316*^9, 3.8872978631019173`*^9}, {3.887298309476729*^9, 
   3.8872983193531823`*^9}, {3.887298460466241*^9, 3.8872984632193236`*^9}, {
   3.88729850872104*^9, 3.88729853827833*^9}, {3.8873048113984427`*^9, 
   3.8873048114205713`*^9}, {3.8873048752144723`*^9, 3.887304875221691*^9}, {
   3.887304992685255*^9, 3.88730499270142*^9}, {3.887305330315383*^9, 
   3.8873053374734793`*^9}, {3.8873078799137115`*^9, 
   3.8873079325791683`*^9}, {3.887310228171843*^9, 3.887310234068865*^9}, {
   3.8873115836594725`*^9, 3.8873115983102684`*^9}, {3.8873116346040897`*^9, 
   3.887311643277169*^9}, {3.887321973988837*^9, 3.8873219797104893`*^9}, 
   3.8873223507479753`*^9, {3.8887843191288357`*^9, 3.888784344707438*^9}, {
   3.888784523062902*^9, 3.8887845230707684`*^9}, {3.8888373229851*^9, 
   3.8888373429768133`*^9}, {3.888838293913364*^9, 3.888838297149349*^9}, {
   3.889014246426564*^9, 3.88901426302246*^9}, {3.889272451318377*^9, 
   3.889272458105173*^9}, {3.889272563709234*^9, 3.889272564768873*^9}, 
   3.8892727886986094`*^9, {3.889272831512383*^9, 3.88927283705315*^9}, {
   3.8894639862898893`*^9, 3.889463987570705*^9}, {3.8894641572824497`*^9, 
   3.889464165313258*^9}, {3.889466462521789*^9, 3.889466474671303*^9}, {
   3.889778923719166*^9, 3.8897789276277533`*^9}, {3.893474310214147*^9, 
   3.893474320259719*^9}, {3.895286660651352*^9, 3.895286660659446*^9}, {
   3.8952867182563343`*^9, 3.89528671826103*^9}, {3.8952871593937597`*^9, 
   3.895287159397093*^9}, {3.8952877017948*^9, 3.895287711034131*^9}, {
   3.895307460227543*^9, 3.895307535510467*^9}, {3.897099738690523*^9, 
   3.897099772020317*^9}, {3.897099875674*^9, 3.897099900215281*^9}, {
   3.897099985085153*^9, 3.897099993724496*^9}, {3.897100031351046*^9, 
   3.897100031737906*^9}, {3.897100197522509*^9, 3.897100235609364*^9}, 
   3.897100297011284*^9, {3.8971003957010117`*^9, 3.8971003991227703`*^9}, {
   3.900597891230217*^9, 3.9005979092904263`*^9}, {3.900606636217309*^9, 
   3.900606659169873*^9}, {3.9006067617031517`*^9, 3.900606780793347*^9}, {
   3.900607126752163*^9, 3.900607142144924*^9}, {3.900607187782537*^9, 
   3.900607194441285*^9}, 3.900740895657712*^9, {3.900794718012274*^9, 
   3.900794751959421*^9}, {3.901047405263105*^9, 3.901047405467107*^9}, {
   3.9010475490949163`*^9, 3.9010475493708763`*^9}, {3.901663875654868*^9, 
   3.901663895570053*^9}, {3.901663932682157*^9, 3.901663941813491*^9}, {
   3.901663992016996*^9, 3.901664109557355*^9}, {3.901664210723185*^9, 
   3.90166421178122*^9}, {3.901664244700564*^9, 3.901664283856647*^9}, {
   3.901664315634315*^9, 3.9016644477444267`*^9}, {3.9016645244584103`*^9, 
   3.9016645851078587`*^9}, {3.901664835420721*^9, 3.901664864789075*^9}, {
   3.9016649323456383`*^9, 3.901665066375211*^9}, 3.901667364218926*^9, {
   3.901667695706616*^9, 3.9016677150606318`*^9}, {3.901667772312222*^9, 
   3.901667996160286*^9}, {3.9016711279426394`*^9, 3.901671259140085*^9}, {
   3.901673563198454*^9, 3.901673568114027*^9}, {3.901696075379367*^9, 
   3.901696120817439*^9}, {3.901702226262722*^9, 3.9017023100059977`*^9}, 
   3.901913758521461*^9, {3.902085385753173*^9, 3.902085386590487*^9}, {
   3.90208544682416*^9, 3.902085465986431*^9}, {3.9020854962181396`*^9, 
   3.902085496765697*^9}, {3.9020856967134542`*^9, 3.9020857325881577`*^9}, {
   3.902094616726839*^9, 3.902094617284762*^9}, {3.902309332555114*^9, 
   3.9023093863918333`*^9}, {3.902309443710647*^9, 3.902309454816087*^9}, {
   3.9023094930833807`*^9, 3.90230953302705*^9}, {3.9023095822749453`*^9, 
   3.902309636458061*^9}, {3.9023097746302977`*^9, 3.902309793979363*^9}, {
   3.9023098594740143`*^9, 3.902309953190371*^9}, {3.9023100210894136`*^9, 
   3.902310059631679*^9}, {3.902310093504346*^9, 3.9023101031188173`*^9}, {
   3.9023105693086987`*^9, 3.902310598141404*^9}, {3.902400355624576*^9, 
   3.9024003937836237`*^9}, {3.90240087265724*^9, 3.9024008864513407`*^9}, {
   3.902400933555298*^9, 3.9024009355115356`*^9}, {3.9024179898808002`*^9, 
   3.902418004029937*^9}, {3.90242802897923*^9, 3.9024280702663593`*^9}, {
   3.902429221088505*^9, 3.902429241260758*^9}, {3.9024519386160183`*^9, 
   3.902451940443974*^9}, {3.902456962382133*^9, 3.902456965587839*^9}, {
   3.902457035922125*^9, 3.902457037760468*^9}, {3.9024570678746843`*^9, 
   3.902457079462606*^9}, {3.911657209969718*^9, 3.911657230060289*^9}, {
   3.911657263290501*^9, 3.9116573126816607`*^9}, {3.934418921403358*^9, 
   3.934418929050273*^9}, {3.9344190638489103`*^9, 3.9344190696672573`*^9}, {
   3.934419101521619*^9, 3.93441910412144*^9}, {3.934419155634685*^9, 
   3.9344191853904457`*^9}, {3.9344192417824183`*^9, 
   3.9344193474300013`*^9}, {3.935066982426156*^9, 3.935066982999666*^9}, {
   3.935067054653943*^9, 3.935067117498932*^9}, {3.935080110941691*^9, 
   3.935080130424646*^9}, {3.935275289719797*^9, 3.9352753446998053`*^9}, {
   3.938302813702259*^9, 3.938302816150848*^9}, {3.9393213335798597`*^9, 
   3.9393213689870977`*^9}, {3.939420977004344*^9, 3.9394210373631372`*^9}, {
   3.939795669648329*^9, 3.939795672582768*^9}, {3.9399212523131857`*^9, 
   3.939921279981318*^9}, {3.939984488173339*^9, 3.939984488423952*^9}, {
   3.9399845228973093`*^9, 3.939984536831274*^9}, {3.939984570610784*^9, 
   3.939984571496166*^9}, {3.940175047928178*^9, 3.9401750518719683`*^9}, {
   3.940216994772814*^9, 3.9402169952974586`*^9}, {3.940217168098218*^9, 
   3.940217171670644*^9}, {3.940217636822942*^9, 3.9402176558636*^9}, {
   3.9405886535769577`*^9, 3.9405886726571293`*^9}, {3.940603138788625*^9, 
   3.9406031394806004`*^9}, {3.9406364456612997`*^9, 
   3.9406364486413393`*^9}, {3.9411802497378817`*^9, 3.941180266835403*^9}, {
   3.942212928448187*^9, 3.942213067801548*^9}, {3.942213117582121*^9, 
   3.9422131331259193`*^9}, {3.942213183991424*^9, 3.94221323065802*^9}, {
   3.942213269163576*^9, 3.9422132832686653`*^9}, {3.9422133204475393`*^9, 
   3.9422134538417673`*^9}, {3.943246858176573*^9, 3.94324685919773*^9}, 
   3.945318344110013*^9, {3.945318510001361*^9, 3.945318513015463*^9}, {
   3.945318577139676*^9, 3.945318613827957*^9}, {3.945448949378993*^9, 
   3.945448951395718*^9}, {3.946033892983637*^9, 3.946033896392247*^9}, {
   3.946809504453857*^9, 3.946809536114009*^9}, {3.946809574422415*^9, 
   3.9468097431289463`*^9}, {3.946810267896093*^9, 3.9468102788180237`*^9}, {
   3.947933418579899*^9, 3.947933420487854*^9}, 3.947933459729957*^9, {
   3.948098259754347*^9, 3.948098260219392*^9}, {3.948109192249278*^9, 
   3.948109227398067*^9}, {3.948351029366403*^9, 3.9483510738195457`*^9}, 
   3.948600320578206*^9, {3.9486003676514*^9, 3.948600399970853*^9}, {
   3.9486010146438847`*^9, 3.948601052922915*^9}, {3.94860178794601*^9, 
   3.948601788588216*^9}, {3.948627557251678*^9, 3.948627565900455*^9}, {
   3.949175602903756*^9, 3.949175715326139*^9}, {3.949178774270755*^9, 
   3.9491787963610487`*^9}, 3.94918680123146*^9, {3.949187803695692*^9, 
   3.949187807999701*^9}, {3.956252971433668*^9, 3.956252984754181*^9}, {
   3.956253024113174*^9, 3.956253034814464*^9}, {3.957534151243795*^9, 
   3.95753416450639*^9}, {3.957534303141624*^9, 3.9575344058318787`*^9}, {
   3.957534449038093*^9, 3.957534453109131*^9}, {3.9575345551726913`*^9, 
   3.957534704267043*^9}, {3.957534872487343*^9, 3.9575349829129963`*^9}, {
   3.957535032492762*^9, 3.9575350426907454`*^9}, {3.957554663339821*^9, 
   3.957554708048009*^9}, {3.9575992215217133`*^9, 3.957599439012084*^9}, {
   3.958629693591434*^9, 3.9586298966402397`*^9}, {3.965333717750434*^9, 
   3.9653337350777683`*^9}, {3.96541238493253*^9, 3.965412388834648*^9}, {
   3.968430919159532*^9, 3.9684309504244204`*^9}, {3.970150716632782*^9, 
   3.970150763959079*^9}, {3.970161284168046*^9, 3.970161419757888*^9}, {
   3.9702377774134073`*^9, 3.970237815113825*^9}, {3.97249956823602*^9, 
   3.9724996016040497`*^9}, {3.972500372423609*^9, 3.972500372820917*^9}, {
   3.972500420651135*^9, 3.9725004286023417`*^9}, 3.97276178892456*^9, {
   3.972982426334045*^9, 3.972982426497128*^9}, {3.97307728154778*^9, 
   3.973077284902727*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"068e1d77-45ae-4e6e-b77b-fb294ec715b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Severing-Capping Rules", "Section",
 CellChangeTimes->{{3.976843978697633*^9, 
  3.9768439806349783`*^9}},ExpressionUUID->"b64f170b-b73d-4469-ad9f-\
f16b3f5b7e32"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesAip1Bind", "=", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "cofilin"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", "capNum", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "aip1"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", 
           RowBox[{"capNum", "-", "1"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}]}], ",", 
       RowBox[{"with", "[", 
        RowBox[{"kaip1on", "*", "capNum"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesAip1Sever", "=", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "aip1"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", "capNum", "]"}]}], "\n", "}"}], "->", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"cap", "[", 
           RowBox[{"IDNext", ",", "coordsNext", ",", "aip1"}], "]"}], ",", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "nucleotideNextNext", ",", "nullPointer", ",", 
            "actinObjectRise"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", 
           RowBox[{"capNum", "-", "1"}], "]"}]}], "\n", "}"}]}], ",", 
       RowBox[{"with", "[", "kaip1sever", "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "aip1"}], "]"}], ",", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "IDNextNextNextABP", ",", "angleNextNext", ",", 
            "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", "capNum", "]"}]}], "\n", "}"}], "->", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"cap", "[", 
           RowBox[{"IDNext", ",", "coordsNext", ",", "aip1"}], "]"}], ",", 
          RowBox[{"actinJuncEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "IDNextNextNextABP", ",", "0.", ",", "angleNextNextABP", ",", 
            "cofilin"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", 
           RowBox[{"capNum", "-", "1"}], "]"}]}], "\n", "}"}]}], ",", 
       RowBox[{"with", "[", "kaip1sever", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesCapOn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "nucleotide", ",", "nullPointer", ",", 
           "dist"}], "]"}], "->", 
         RowBox[{"cap", "[", 
          RowBox[{"ID", ",", "coords", ",", "nucleotide"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"with", "[", 
        RowBox[{"kcapon", "*", "125", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesCapOff", "=", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cap", "[", 
           RowBox[{"IDNext", ",", "coordsNext", ",", "aip1"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", "capNum", "]"}]}], "}"}], "->", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "cofilin", ",", "nullPointer", ",",
             "actinObjectRise"}], "]"}], ",", 
          RowBox[{"aip1Count", "[", 
           RowBox[{"capNum", "+", "1"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", "kaip1off", "]"}]}], "\n", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesCap", "=", 
     RowBox[{"If", "[", 
      RowBox[{"aipKO", ",", 
       RowBox[{"Join", "[", "rulesCapOn", "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
        "rulesAip1Bind", ",", "rulesAip1Sever", ",", "rulesCapOff", ",", 
         "rulesCapOn"}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.968430956824568*^9, 3.968430979578553*^9}, {
  3.9768440062683697`*^9, 3.976844199026555*^9}, {3.976844539856903*^9, 
  3.976844657610733*^9}, {3.976844696008862*^9, 3.976844785326603*^9}, {
  3.976844861893194*^9, 3.976845002273802*^9}, {3.976845433022777*^9, 
  3.9768454386145563`*^9}, {3.97698549543499*^9, 3.976985672084049*^9}, {
  3.97698583718679*^9, 3.9769858822857323`*^9}, {3.976986463510435*^9, 
  3.97698649885986*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"5d92dd8e-596b-4ccf-bb1d-d7e4c5973a07"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Network Remodeling Test", "Section",ExpressionUUID->"1609e4d4-0290-421e-bfc5-ad012eba05c5"],

Cell["\<\
This section tests the actin remodeling rules defined so far.\
\>", "Text",ExpressionUUID->"7c508ecb-3dc3-4f13-946e-2bf78ef30044"],

Cell[CellGroupData[{

Cell["Function for Getting Filament Lengths", "Subsection",ExpressionUUID->"114635a6-4cc7-4157-93ba-4928978be41b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getFActinDistribution", "[", "initMoleculeList_", "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pointCells", ",", " ", "arpIDs", ",", "arps", ",", " ", "curCell", ",", 
      " ", "branchLengths", ",", 
      RowBox[{"moleculeList", "=", "initMoleculeList"}], ",", "branchLength", 
      ",", 
      RowBox[{"branchLengthArp", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"branchLengthPOI", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"branchLengths", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "make", " ", "an", " ", "array", " ", "of", " ", "all", " ", "the", " ",
        "pointed", " ", "ends"}], " ", "*)"}], " ", "\n", 
     RowBox[{"pointCells", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"moleculeList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "TYPE", "]"}], "]"}], "==", "POI"}]}], "&"}]}], " ", 
       "]"}]}], ";", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "make", " ", "an", " ", "array", " ", "of", " ", "all", " ", "the", " ",
        "arps"}], " ", "*)"}], "\n", 
     RowBox[{"arpIDs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "BRANCH", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"moleculeList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "BRANCH", "]"}], "]"}], "!=", "arpIDFree"}]}], 
          "&"}]}], "]"}]}]}], ";", "\n", 
     RowBox[{"arps", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"moleculeList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"arpIDs", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "ID", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], ";",
      "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "@", "pointCells"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"curCell", "=", 
         RowBox[{"pointCells", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", 
        RowBox[{"branchLength", "=", "1"}], ";", "\n", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"curCell", "[", 
            RowBox[{"[", "NEXT", "]"}], "]"}], "!=", "aIDFreeB"}], ",", "\n", 
          
          RowBox[{
           RowBox[{"curCell", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"moleculeList", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "ID", "]"}], "]"}], "==", 
                  RowBox[{"curCell", "[", 
                   RowBox[{"[", "NEXT", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
           RowBox[{"branchLength", "++"}], ";", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"curCell", "[", 
               RowBox[{"[", "TYPE", "]"}], "]"}], "==", "CAP"}], ",", 
             RowBox[{"Break", ";"}]}], "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"branchLengthPOI", ",", 
          RowBox[{"branchLength", "*", "nCG"}]}], "]"}], ";"}]}], "\n", "]"}],
      ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "@", "arps"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"curCell", "=", 
         RowBox[{"arps", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", 
        RowBox[{"branchLength", "=", "1"}], ";", "\n", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"curCell", "[", 
            RowBox[{"[", "NEXT", "]"}], "]"}], "!=", "aIDFreeB"}], ",", "\n", 
          
          RowBox[{
           RowBox[{"curCell", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"moleculeList", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "===", "actin"}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "ID", "]"}], "]"}], "==", 
                  RowBox[{"curCell", "[", 
                   RowBox[{"[", "NEXT", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
           RowBox[{"branchLength", "++"}], ";"}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"branchLengthArp", ",", 
          RowBox[{"branchLength", "*", "nCG"}]}], "]"}], ";"}]}], "\n", "]"}],
      ";", "\n", "\n", 
     RowBox[{"Join", "[", 
      RowBox[{"branchLengthPOI", ",", "branchLengthArp"}], "]"}]}]}], "\n", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[169]:=",ExpressionUUID->"682611f6-6ee2-460f-92aa-e38d4155df41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SegmentSegmentDistance", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1_", ",", "q2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "d1", ",", "d2", ",", "r", ",", "a", ",", "b", ",", "c", ",", "e", ",", 
      "f", ",", "denom", ",", "s", ",", "t", ",", 
      RowBox[{"eps", "=", "$MachineEpsilon"}]}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "direction", " ", "vectors", " ", "and", " ", "initial", " ", "offset"}],
      "*)"}], 
    RowBox[{
     RowBox[{"d1", "=", 
      RowBox[{"p2", "-", "p1"}]}], ";", "\n", 
     RowBox[{"d2", "=", 
      RowBox[{"q2", "-", "q1"}]}], ";", "\n", 
     RowBox[{"r", "=", 
      RowBox[{"p1", "-", "q1"}]}], ";", "\n", 
     RowBox[{"(*", "dot\:2011products", "*)"}], 
     RowBox[{"a", "=", 
      RowBox[{"d1", " ", ".", " ", "d1"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"squared", " ", "length", " ", "of", " ", "segment", " ", "1"}],
       "*)"}], 
     RowBox[{"b", "=", 
      RowBox[{"d1", " ", ".", " ", "d2"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"dot", 
       RowBox[{"(", 
        RowBox[{"d1", ",", "d2"}], ")"}]}], "*)"}], 
     RowBox[{"c", "=", 
      RowBox[{"d2", " ", ".", " ", "d2"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"squared", " ", "length", " ", "of", " ", "segment", " ", "2"}],
       "*)"}], 
     RowBox[{"e", "=", 
      RowBox[{"d2", " ", ".", " ", "r"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"dot", 
       RowBox[{"(", 
        RowBox[{"d2", ",", "r"}], ")"}]}], "*)"}], 
     RowBox[{"f", "=", 
      RowBox[{"d1", " ", ".", " ", "r"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"dot", 
       RowBox[{"(", 
        RowBox[{"d1", ",", "r"}], ")"}]}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"handle", " ", "degenerate", " ", "segments"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "<", "eps"}], "&&", 
        RowBox[{"c", "<", "eps"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "both", " ", "segments", " ", "reduce", " ", "to", " ", "points"}], 
        "*)"}], 
       RowBox[{"Return", "[", 
        RowBox[{"Norm", "[", "r", "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "<", "eps"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"first", " ", "segment", " ", "is", " ", "a", " ", "point"}],
          ";", 
         RowBox[{"project", " ", "onto", " ", "second"}]}], "*)"}], 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"e", "/", "c"}]}], ";", "\n", 
        RowBox[{"t", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"t", ",", "0"}], "]"}], ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"Return", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{"p1", "-", 
           RowBox[{"(", 
            RowBox[{"q1", "+", 
             RowBox[{"t", " ", "d2"}]}], ")"}]}], "]"}], "]"}]}]}], "]"}], ";",
      "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"c", "<", "eps"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "second", " ", "segment", " ", "is", " ", "a", " ", "point"}], ";", 
         RowBox[{"project", " ", "onto", " ", "first"}]}], "*)"}], 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{"-", "f"}], "/", "a"}]}], ";", "\n", 
        RowBox[{"s", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"s", ",", "0"}], "]"}], ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"Return", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "+", 
             RowBox[{"s", " ", "d1"}]}], ")"}], "-", "q1"}], "]"}], "]"}]}]}],
       "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"general", " ", "case"}], "*)"}], 
     RowBox[{"denom", "=", 
      RowBox[{
       RowBox[{"a", " ", "c"}], "-", 
       RowBox[{"b", "^", "2"}]}]}], ";", "\n", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "e"}], "-", 
         RowBox[{"c", " ", "f"}]}], ")"}], "/", "denom"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"clamp", " ", "s", " ", 
       RowBox[{"to", "[", 
        RowBox[{"0", ",", "1"}], "]"}]}], "*)"}], 
     RowBox[{"s", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"s", ",", "0"}], "]"}], ",", "1"}], "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "compute", " ", "t", " ", "corresponding", " ", "to", " ", "clamped", " ",
        "s"}], "*)"}], 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "s"}], "+", "e"}], ")"}], "/", "c"}]}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"if", " ", "t", " ", "out", " ", 
        RowBox[{"of", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}], ",", 
       RowBox[{"clamp", " ", "and", " ", "re\:2011solve", " ", "s"}]}], 
      "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "<", "0"}], ",", 
       RowBox[{
        RowBox[{"t", "=", "0"}], ";", "\n", 
        RowBox[{"s", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "f"}], "/", "a"}], ",", "0"}], "]"}], ",", "1"}], 
          "]"}]}]}], ",", 
       RowBox[{"t", ">", "1"}], ",", 
       RowBox[{
        RowBox[{"t", "=", "1"}], ";", "\n", 
        RowBox[{"s", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", "-", "f"}], ")"}], "/", "a"}], ",", "0"}], "]"}], 
           ",", "1"}], "]"}]}]}]}], "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"vector", " ", "between", " ", "closest", " ", "points"}], 
      "*)"}], 
     RowBox[{"Norm", "[", 
      RowBox[{"r", "+", 
       RowBox[{"d1", " ", "s"}], "-", 
       RowBox[{"d2", " ", "t"}]}], "]"}]}]}], "]"}]}]], "Code",
 CellLabel->
  "In[170]:=",ExpressionUUID->"d9362596-878e-4f8a-a4c4-04f6c31e0170"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bundling Rules", "Section",ExpressionUUID->"6df491bb-4639-4d6a-9bf6-f6d0dbed3d80"],

Cell[CellGroupData[{

Cell["Rules", "Subsection",ExpressionUUID->"77159853-3af5-4ea3-8570-d7b774c97f81"],

Cell["\<\
This set of rules implements bundling by CamKII\[Beta] which has the effect \
of strengthening filaments.\
\>", "Text",ExpressionUUID->"33f37b69-a305-4cd4-a021-a8200e2647c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "rules", " ", "bundle", " ", "actin", " ", "nodes", " ", 
    "that", " ", "exist", " ", "close", " ", "to", " ", "each", " ", 
    "other"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesBundlingOn", "=", "\n", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"a1P", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1", ",", "coords1", ",", "ID1Next", ",", "angle1Next", ",", 
             "nucleotide1"}], "]"}]}], ",", "\n", 
          RowBox[{"a1M", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
          RowBox[{"a1N", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
              "angle1NextNextNext", ",", "nucleotide1NextNext"}], "]"}]}], ",",
           "\n", 
          RowBox[{"a2P", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2", ",", "coords2", ",", "ID2Next", ",", "angle2Next", ",", 
             "nucleotide2"}], "]"}]}], ",", "\n", 
          RowBox[{"a2M", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
          RowBox[{"a2N", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
              "angle2NextNextNext", ",", "nucleotide2NextNext"}], "]"}]}], ",",
           "\n", 
          RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", "\n", 
        RowBox[{"{", "\n", 
         RowBox[{"a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
            "angle1NextNext", ",", "camABP"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
            "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
          RowBox[{"cam", "[", 
           RowBox[{"IDCounter", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}], 
            ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
             "2."}]}], "]"}], ",", "\n", 
          RowBox[{"newID", "[", 
           RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
          RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
          RowBox[{"camCount", "[", 
           RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"ArcCos", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".", 
               " ", 
               RowBox[{"(", 
                RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
               ")"}]}], "]"}], "]"}], "<", 
           RowBox[{"15", "Degree"}]}], "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
           RowBox[{"Norm", "[", 
            RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
           RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], "koncamKII\[Beta]",
          "*", "numCam", " ", 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{"numCam", ">=", "12."}], "&&", 
           RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
           RowBox[{"nucleotide2Next", "!=", "camABP"}], "&&", 
           RowBox[{"nucleotide1Next", "!=", "cofilin"}], "&&", 
           RowBox[{"nucleotide2Next", "!=", "cofilin"}], "&&", 
           RowBox[{"nucleotide1Next", "!=", "aip1"}], "&&", 
           RowBox[{"nucleotide2Next", "!=", "aip1"}]}], "]"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{",", "\n", 
        RowBox[{
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"a1P", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID1", ",", "coords1", ",", "ID1Next", ",", "ID1NextABP", ",", 
              "angle1Next", ",", "angle1NextABP", ",", "nucleotide1"}], 
             "]"}]}], ",", "\n", 
           RowBox[{"a1M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
              "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a1N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
               "angle1NextNextNext", ",", "nucleotide1NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"a2P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2", ",", "coords2", ",", "ID2Next", ",", "angle2Next", ",", 
              "nucleotide2"}], "]"}]}], ",", "\n", 
           RowBox[{"a2M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
              "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a2N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
               "angle2NextNextNext", ",", "nucleotide2NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", 
         "\n", 
         RowBox[{"{", "\n", 
          RowBox[{
          "a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "camABP"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDCounter", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}],
              ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
              "2."}]}], "]"}], ",", "\n", 
           RowBox[{"newID", "[", 
            RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", 
            RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
        
        RowBox[{"with", "[", 
         RowBox[{
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".",
                 " ", 
                RowBox[{"(", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
                ")"}]}], "]"}], "]"}], "<", 
            RowBox[{"15", "Degree"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
            RowBox[{"Norm", "[", 
             RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
            RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], 
          "koncamKII\[Beta]", "*", "numCam", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"numCam", ">=", "12."}], "&&", 
            RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
            RowBox[{"nucleotide2Next", "!=", "camABP"}]}], "]"}]}], "]"}], ",",
         "\n", 
        RowBox[{
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"a1P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1", ",", "coords1", ",", "ID1Next", ",", "angle1Next", ",", 
              "nucleotide1"}], "]"}]}], ",", "\n", 
           RowBox[{"a1M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
              "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a1N", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
               "ID1NextNextNextABP", ",", "angle1NextNextNext", ",", 
              "angle1NextNextNextABP", ",", "nucleotide1NextNext"}], "]"}]}], 
           ",", "\n", 
           RowBox[{"a2P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2", ",", "coords2", ",", "ID2Next", ",", "angle2Next", ",", 
              "nucleotide2"}], "]"}]}], ",", "\n", 
           RowBox[{"a2M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
              "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a2N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
               "angle2NextNextNext", ",", "nucleotide2NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", 
         "\n", 
         RowBox[{"{", "\n", 
          RowBox[{"a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "camABP"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDCounter", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}],
              ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
              "2."}]}], "]"}], ",", "\n", 
           RowBox[{"newID", "[", 
            RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", 
            RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
        
        RowBox[{"with", "[", 
         RowBox[{
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".",
                 " ", 
                RowBox[{"(", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
                ")"}]}], "]"}], "]"}], "<", 
            RowBox[{"15", "Degree"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
            RowBox[{"Norm", "[", 
             RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
            RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], 
          "koncamKII\[Beta]", "*", "numCam", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"numCam", ">=", "12."}], "&&", 
            RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
            RowBox[{"nucleotide2Next", "!=", "camABP"}]}], "]"}]}], "]"}], ",",
         "\n", 
        RowBox[{
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"a1P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1", ",", "coords1", ",", "ID1Next", ",", "angle1Next", ",", 
              "nucleotide1"}], "]"}]}], ",", "\n", 
           RowBox[{"a1M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
              "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a1N", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
               "ID1NextNextNextABP", ",", "angle1NextNextNext", ",", 
              "angle1NextNextNextABP", ",", "nucleotide1NextNext"}], "]"}]}], 
           ",", "\n", 
           RowBox[{"a2P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2", ",", "coords2", ",", "ID2Next", ",", "angle2Next", ",", 
              "nucleotide2"}], "]"}]}], ",", "\n", 
           RowBox[{"a2M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
              "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a2N", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
               "ID2NextNextNextABP", ",", "angle2NextNextNext", ",", 
              "angle2NextNextNextABP", ",", "nucleotide2NextNext"}], "]"}]}], 
           ",", "\n", 
           RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", 
         "\n", 
         RowBox[{"{", "\n", 
          RowBox[{"a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "camABP"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDCounter", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}],
              ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
              "2."}]}], "]"}], ",", "\n", 
           RowBox[{"newID", "[", 
            RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", 
            RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
        
        RowBox[{"with", "[", 
         RowBox[{
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".",
                 " ", 
                RowBox[{"(", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
                ")"}]}], "]"}], "]"}], "<", 
            RowBox[{"15", "Degree"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
            RowBox[{"Norm", "[", 
             RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
            RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], 
          "koncamKII\[Beta]", "*", "numCam", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"numCam", ">=", "12."}], "&&", 
            RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
            RowBox[{"nucleotide2Next", "!=", "camABP"}]}], "]"}]}], "]"}], ",",
         "\n", 
        RowBox[{
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"a1P", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1", ",", "coords1", ",", "ID1Next", ",", "angle1Next", ",", 
              "nucleotide1"}], "]"}]}], ",", "\n", 
           RowBox[{"a1M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
              "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a1N", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
               "ID1NextNextNextABP", ",", "angle1NextNextNext", ",", 
              "angle1NextNextNextABP", ",", "nucleotide1NextNext"}], "]"}]}], 
           ",", "\n", 
           RowBox[{"a2P", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID2", ",", "coords2", ",", "ID2Next", ",", "ID2NextABP", ",", 
              "angle2Next", ",", "angle2NextABP", ",", "nucleotide2"}], 
             "]"}]}], ",", "\n", 
           RowBox[{"a2M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
              "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a2N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
               "angle2NextNextNext", ",", "nucleotide2NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", 
         "\n", 
         RowBox[{"{", "\n", 
          RowBox[{"a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "camABP"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDCounter", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}],
              ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
              "2."}]}], "]"}], ",", "\n", 
           RowBox[{"newID", "[", 
            RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", 
            RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
        
        RowBox[{"with", "[", 
         RowBox[{
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".",
                 " ", 
                RowBox[{"(", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
                ")"}]}], "]"}], "]"}], "<", 
            RowBox[{"15", "Degree"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
            RowBox[{"Norm", "[", 
             RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
            RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], 
          "koncamKII\[Beta]", "*", "numCam", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"numCam", ">=", "12."}], "&&", 
            RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
            RowBox[{"nucleotide2Next", "!=", "camABP"}]}], "]"}]}], "]"}], ",",
         "\n", 
        RowBox[{
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"a1P", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID1", ",", "coords1", ",", "ID1Next", ",", "ID1NextABP", ",", 
              "angle1Next", ",", "angle1NextABP", ",", "nucleotide1"}], 
             "]"}]}], ",", "\n", 
           RowBox[{"a1M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
              "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a1N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID1NextNext", ",", "coords1NextNext", ",", "ID1NextNextNext", ",",
               "angle1NextNextNext", ",", "nucleotide1NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"a2P", "==", 
            RowBox[{"actinJunc", "[", 
             RowBox[{
             "ID2", ",", "coords2", ",", "ID2Next", ",", "ID2NextABP", ",", 
              "angle2Next", ",", "angle2NextABP", ",", "nucleotide2"}], 
             "]"}]}], ",", "\n", 
           RowBox[{"a2M", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
              "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}], ",", "\n", 
           
           RowBox[{"a2N", "==", 
            RowBox[{"actin", "[", 
             RowBox[{
             "ID2NextNext", ",", "coords2NextNext", ",", "ID2NextNextNext", ",",
               "angle2NextNextNext", ",", "nucleotide2NextNext"}], "]"}]}], ",",
            "\n", 
           RowBox[{"newID", "[", "IDCounter", "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", "numCam", "]"}]}], "\n", "}"}], "->", 
         "\n", 
         RowBox[{"{", "\n", 
          RowBox[{"a1P", ",", "a2P", ",", "a2N", ",", "a1N", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "camABP"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "camABP"}], "]"}], ",", "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDCounter", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords1Next", "+", "coords2Next"}], ")"}], "/", "2"}],
              ",", "ID1Next", ",", "ID2Next", ",", "0.0", ",", "camRule", ",", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"coords2Next", "-", "coords1Next"}], "]"}], "/", 
              "2."}]}], "]"}], ",", "\n", 
           RowBox[{"newID", "[", 
            RowBox[{"IDCounter", "+", "1"}], "]"}], ",", 
           RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
           RowBox[{"camCount", "[", 
            RowBox[{"numCam", "-", "12"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
        
        RowBox[{"with", "[", 
         RowBox[{
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"coords1NextNext", "-", "coords1"}], ")"}], " ", ".",
                 " ", 
                RowBox[{"(", 
                 RowBox[{"coords2NextNext", "-", "coords2"}], ")"}]}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords1NextNext", "-", "coords1"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"coords2NextNext", "-", "coords2"}], "]"}]}], 
                ")"}]}], "]"}], "]"}], "<", 
            RowBox[{"15", "Degree"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"lowerRadiusCam", "*", "2."}], "<", 
            RowBox[{"Norm", "[", 
             RowBox[{"coords1Next", "-", "coords2Next"}], "]"}], "<", 
            RowBox[{"upperRadiusCam", "*", "2."}]}], "]"}], 
          "koncamKII\[Beta]", "*", "numCam", " ", 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"numCam", ">=", "12."}], "&&", 
            RowBox[{"nucleotide1Next", "!=", "camABP"}], "&&", 
            RowBox[{"nucleotide2Next", "!=", "camABP"}]}], "]"}]}], "]"}]}], 
       "*)"}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"rulesBundlingOff", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a1M", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
             "angle1NextNext", ",", "nucleotide1Next"}], "]"}]}], ",", "\n", 
          RowBox[{"cam", "[", 
           RowBox[{
           "camID", ",", "camCoords", ",", "ID1Next", ",", "ID2Next", ",", 
            "camAngle", ",", "ABPRule", ",", "camDist"}], "]"}], ",", 
          RowBox[{"camCount", "[", "numCam", "]"}], ",", "\n", 
          RowBox[{"a2M", "==", 
           RowBox[{"actin", "[", 
            RowBox[{
            "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
             "angle2NextNext", ",", "nucleotide2Next"}], "]"}]}]}], "\n", 
         "}"}], "->", "\n", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"camCount", "[", 
           RowBox[{"numCam", "+", "12"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID1Next", ",", "coords1Next", ",", "ID1NextNext", ",", 
            "angle1NextNext", ",", "ADP"}], "]"}], ",", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID2Next", ",", "coords2Next", ",", "ID2NextNext", ",", 
            "angle2NextNext", ",", "ADP"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", "koffcamKII\[Beta]", "]"}]}], "\n", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesBundling", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"rulesBundlingOn", ",", "rulesBundlingOff"}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.964282325879086*^9, 3.9642823500207148`*^9}, {
  3.9642878036916437`*^9, 3.964287826726804*^9}, {3.968431004653121*^9, 
  3.9684310155901937`*^9}, {3.969805614366942*^9, 3.969805630737349*^9}, {
  3.9720937016295147`*^9, 3.972093730932446*^9}, {3.972506577058429*^9, 
  3.972506630308606*^9}, {3.9732598732823563`*^9, 3.973259880140867*^9}, {
  3.973259958733541*^9, 3.973259972693491*^9}, {3.974783549319474*^9, 
  3.974783552677623*^9}, {3.976877817051093*^9, 3.976877821228006*^9}, {
  3.976877967262495*^9, 3.976877971158906*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"09c0a18c-7088-4b7b-af18-bcc6550514c2"],

Cell["\<\
The cell below shows the Lennard-Jones potential as a function of a distance \
d, size of the well \[Epsilon] and ratio constant \[Sigma]LJ where the \
minimum occurs at \[Sigma]LJ .\
\>", "Text",ExpressionUUID->"8bde53e9-3693-481c-9c9d-7ac6129ebccc"],

Cell["\<\
The total energy in this section is a combination of anistropic buckling, \
angular bending energy, membrane areal energy, membrane line tension energy, \
and membrane mean Helfrich energy.\
\>", "Text",ExpressionUUID->"a485e30c-203e-48db-aa94-b7b5259f92d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tri-nodal Anisotropic Force", "Subsection",ExpressionUUID->"5abce886-44e0-4627-92be-9a96b370f091"],

Cell[CellGroupData[{

Cell["Rules", "Subsubsection",ExpressionUUID->"eab54c0c-90c9-49d4-8b9d-c140b16ead33"],

Cell["\<\
To create anisotropic movement, buckling occurs in a series of three actin \
beads with only the center one moving. The total potential equals the sum of \
potentials of the two rods such that main movement occurs perpendicular to \
the axis connecting the first and third actins.\
\>", "Text",ExpressionUUID->"af4349a7-1afb-4edd-8177-67049ea58702"],

Cell["\<\
The negative gradient of the Lennard - Jones potential with respect the \
coordinates of each point is the restoring force acting on each point .\
\>", "Text",ExpressionUUID->"9fcf206d-5ec8-49d2-a58c-aec1668d3cd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Norm", "'"}], "[", "d_", "]"}], ":=", 
   RowBox[{"d", "/", 
    RowBox[{"Norm", "[", "d", "]"}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gradP1", "[", 
    RowBox[{"x1In_", ",", "x2In_", ",", 
     RowBox[{"rules_", "?", "ListQ"}], ",", "l_", ",", "clipFactor_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"potential", "[", 
         RowBox[{"r", ",", 
          RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "l0"}], "]"}], ",", 
        "r"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1In", "-", "x2In"}], ")"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"x1In", "-", "x2In"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"Join", "[", 
     RowBox[{"rules", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "->", 
         RowBox[{"Norm", "[", 
          RowBox[{"x1In", "-", "x2In"}], "]"}]}], ",", 
        RowBox[{"\[Epsilon]", "->", "clipFactor"}], ",", 
        RowBox[{"l0", "->", "l"}]}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gradP2", "[", 
    RowBox[{"x1In_", ",", "x2In_", ",", 
     RowBox[{"rules_", "?", "ListQ"}], ",", "l_", ",", "clipFactor_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"potential", "[", 
         RowBox[{"r", ",", 
          RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "l0"}], "]"}], ",", 
        "r"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x2In", "-", "x1In"}], ")"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"x1In", "-", "x2In"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"Join", "[", 
     RowBox[{"rules", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "->", 
         RowBox[{"Norm", "[", 
          RowBox[{"x1In", "-", "x2In"}], "]"}]}], ",", 
        RowBox[{"\[Epsilon]", "->", "clipFactor"}], ",", 
        RowBox[{"l0", "->", "l"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[174]:=",ExpressionUUID->"52d1d23e-e4ca-4b1b-922d-14a6ae3a5ebc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deltaFuncPairwiseP1", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", "rules_"}], "]"}], ":=", 
   "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "p1Delta", "}"}], ",", "\n", 
     RowBox[{"p1Delta", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"updateFunction", "/.", "rules"}], ")"}], "[", 
             RowBox[{"d0", "/.", "rules"}], "]"}]}], "  ", 
           RowBox[{"gradP1", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1o", ",", "y1o"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2o", ",", "y2o"}], "}"}], ",", "rules", ",", 
             RowBox[{"d0", "/.", "rules"}], ",", 
             RowBox[{"\[Epsilon]", "/.", "rules"}]}], "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Infinity", "->", "0."}], ",", 
            RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}], ")"}], "/.", 
        RowBox[{"Indeterminate", "->", "0."}]}], "]"}]}]}], "\n", "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaFuncPairwiseP2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", "rules_"}], "]"}], ":=", 
   "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "p2Delta", "}"}], ",", "\n", 
     RowBox[{"p2Delta", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"updateFunction", "/.", "rules"}], ")"}], "[", 
             RowBox[{"d0", "/.", "rules"}], "]"}]}], " ", 
           RowBox[{"gradP2", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1o", ",", "y1o"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2o", ",", "y2o"}], "}"}], ",", "rules", ",", 
             RowBox[{"d0", "/.", "rules"}], ",", 
             RowBox[{"\[Epsilon]", "/.", "rules"}]}], "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Infinity", "->", "0."}], ",", 
            RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}], ")"}], "/.", 
        RowBox[{"Indeterminate", "->", "0."}]}], "]"}]}]}], "\n", "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"potentialFunc", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", "rules_", ",", "l0In_"}], 
   "]"}], ":=", "\n", 
  RowBox[{
   RowBox[{"potential", "[", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"x1", "-", "x2"}], "]"}], ",", "rules", ",", "\[Epsilon]", ",", 
     "l0In"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "->", 
      RowBox[{"{", 
       RowBox[{"x1o", ",", "y1o"}], "}"}]}], ",", 
     RowBox[{"x2", "->", 
      RowBox[{"{", 
       RowBox[{"x2o", ",", "y2o"}], "}"}]}]}], "}"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972938155606936*^9, 3.972938160534289*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"ba4339d0-e8c4-4019-bbfb-3a34636df7d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Change", " ", "angle", " ", "range"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"transformAngle", "[", "ang_", "]"}], ":=", "\n", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"ang", ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "<=", "Pi"}], ",", "\n", 
      RowBox[{"Mod", "[", 
       RowBox[{"ang", ",", "Pi"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"ang", ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "-", 
       RowBox[{"2", "Pi"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Functions", " ", "for", " ", "determining", " ", "the", " ", "change", " ",
      "to", " ", "the", " ", "angle", " ", "of", " ", "the", " ", "first", " ",
      "actin"}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"getStartActinDeltaTheta", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1x_", ",", "p1y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p2x_", ",", "p2y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pnewx_", ",", "pnewy_"}], "}"}]}], "]"}], ":=", "\n", 
    RowBox[{"transformAngle", "[", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"angNext", "=", 
          RowBox[{"ArcTan", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pnewx", ",", "pnewy"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"p1x", ",", "p1y"}], "}"}]}], ")"}]}]}], ",", 
         RowBox[{"angPrev", "=", 
          RowBox[{"ArcTan", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p2x", ",", "p2y"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"p1x", ",", "p1y"}], "}"}]}], ")"}]}]}]}], "}"}], ",", 
       "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "angNext", "]"}], ">", 
           RowBox[{"Pi", "/", "2"}]}], "&&", 
          RowBox[{
           RowBox[{"Sign", "[", "angNext", "]"}], "!=", 
           RowBox[{"Sign", "[", "angPrev", "]"}]}]}], ",", "\n", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"angNext", ",", 
              RowBox[{"2", "Pi"}]}], "]"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"angPrev", ",", 
              RowBox[{"2", "Pi"}]}], "]"}]}], ")"}]}], ",", "\n", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"(", 
           RowBox[{"angNext", "-", "angPrev"}], ")"}]}]}], "\n", "]"}]}], 
      "\n", "]"}], "]"}]}], "\n", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", "=", 
       RowBox[{"getStartActinDeltaTheta", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1x", ",", "p1y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p2x", ",", "p2y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pnewx", ",", "pnewy"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"startActinDeltaTheta", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1xIn_", ",", "p1yIn_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2xIn_", ",", "p2yIn_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pnewxIn_", ",", "pnewyIn_"}], "}"}]}], "]"}], ":=", "\n", 
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p2x", "->", "p2xIn"}], ",", 
         RowBox[{"p2y", "->", "p2yIn"}], ",", 
         RowBox[{"p1x", "->", "p1xIn"}], ",", 
         RowBox[{"p1y", "->", "p1yIn"}], ",", 
         RowBox[{"pnewx", "->", "pnewxIn"}], ",", 
         RowBox[{"pnewy", "->", "pnewyIn"}]}], "}"}]}]}]}], "\n", "]"}], "\n",
    "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Functions", " ", "for", " ", "determining", " ", "the", " ", "change", " ",
      "to", " ", "the", " ", "angle", " ", "of", " ", "the", " ", "third", " ",
      "actin"}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"getEndActinDeltaTheta", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p2x_", ",", "p2y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p3x_", ",", "p3y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pnewx_", ",", "pnewy_"}], "}"}]}], "]"}], ":=", "\n", 
    RowBox[{"transformAngle", "[", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"angNext", "=", 
          RowBox[{"ArcTan", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p3x", ",", "p3y"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"pnewx", ",", "pnewy"}], "}"}]}], ")"}]}]}], ",", 
         RowBox[{"angPrev", "=", 
          RowBox[{"ArcTan", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p3x", ",", "p3y"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"p2x", ",", "p2y"}], "}"}]}], ")"}]}]}]}], "}"}], ",", 
       "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "angNext", "]"}], ">", 
           RowBox[{"Pi", "/", "2"}]}], "&&", 
          RowBox[{
           RowBox[{"Sign", "[", "angNext", "]"}], "!=", 
           RowBox[{"Sign", "[", "angPrev", "]"}]}]}], ",", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"angNext", ",", 
                RowBox[{"2", "Pi"}]}], "]"}], "-", 
              RowBox[{"Mod", "[", 
               RowBox[{"angPrev", ",", 
                RowBox[{"2", "Pi"}]}], "]"}]}], ")"}]}], ")"}]}], ",", "\n", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"angNext", "-", "angPrev"}], ")"}]}], ")"}]}]}], "\n", 
        "]"}]}], "\n", "]"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[180]:=",ExpressionUUID->"dc7d3835-7738-4bd9-87c2-17c5abadb034"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", "=", 
      RowBox[{"getEndActinDeltaTheta", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p2x", ",", "p2y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3x", ",", "p3y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pnewx", ",", "pnewy"}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"endActinDeltaTheta", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p2xIn_", ",", "p2yIn_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3xIn_", ",", "p3yIn_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pnewxIn_", ",", "pnewyIn_"}], "}"}]}], "]"}], ":=", "\n", 
     RowBox[{"tmp", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p2x", "->", "p2xIn"}], ",", 
        RowBox[{"p2y", "->", "p2yIn"}], ",", 
        RowBox[{"p3x", "->", "p3xIn"}], ",", 
        RowBox[{"p3y", "->", "p3yIn"}], ",", 
        RowBox[{"pnewx", "->", "pnewxIn"}], ",", 
        RowBox[{"pnewy", "->", "pnewyIn"}]}], "}"}]}]}]}], "\n", "]"}], "\n", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "for", " ", "determining", " ", "the", " ", "angle", " ", 
    "of", " ", "the", " ", "middle", " ", "actin"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"middleThetaMovement", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1x_", ",", "p1y_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p2newx_", ",", "p2newy_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p3x_", ",", "p3y_"}], "}"}]}], "]"}], ":=", "\n", 
  RowBox[{"transformAngle", "[", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"angNext", "=", 
        RowBox[{"ArcTan", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p3x", ",", "p3y"}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{"p2newx", ",", "p2newy"}], "}"}]}], ")"}]}]}], ",", 
       RowBox[{"angPrev", "=", 
        RowBox[{"ArcTan", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p2newx", ",", "p2newy"}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{"p1x", ",", "p1y"}], "}"}]}], ")"}]}]}]}], "}"}], ",", 
     "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "angNext", "]"}], ">", 
         RowBox[{"Pi", "/", "2"}]}], "&&", 
        RowBox[{
         RowBox[{"Sign", "[", "angNext", "]"}], "!=", 
         RowBox[{"Sign", "[", "angPrev", "]"}]}]}], ",", 
       RowBox[{"Evaluate", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"angNext", ",", 
            RowBox[{"2", "Pi"}]}], "]"}], "-", 
          RowBox[{"Mod", "[", 
           RowBox[{"angPrev", ",", 
            RowBox[{"2", "Pi"}]}], "]"}]}], ")"}]}], ",", "\n", 
       RowBox[{"Evaluate", "@", 
        RowBox[{"(", 
         RowBox[{"angNext", "-", "angPrev"}], ")"}]}]}], "\n", "]"}]}], "\n", 
    "]"}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.972501202748763*^9, 3.972501203680223*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"e9d1bd4a-a1b8-4700-b09c-3b44d2d7f75a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesAnisotropicLinear", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"distNextNext", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDNextNextABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDNextNextABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDABP", ",", "angleNextNext", ",", "angleABP", ",", 
           "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], 
        "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesAnisotropicJunc", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}], ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"bE", "==", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
             "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", "bE", ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pE", "==", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", "pE", ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}], ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesAnisotropicCam", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"cam", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
           "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", 
               RowBox[{"camDist", ",", "CAM"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABP", ",", "coordsNextNext", ",", 
              RowBox[{"ABPRule", "[", 
               RowBox[{"camDist", ",", "CAM"}], "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "ID", ",", 
             "IDNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "ABPRule", ",", "camDist"}], 
            "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesAnisotropicArp", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleABPNext", ",", "nucleotideABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", "ARP", "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", 
             RowBox[{"secondAngle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "IDABPNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
             RowBox[{"angleABPNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideABPNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"ABPRule", "[", "ARP", "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"distABPNext", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", 
             RowBox[{"secondAngle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "IDABPNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
             "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}]}], 
        "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "0.", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleABPNext", ",", "nucleotideABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP1", "[", 
            RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
             RowBox[{"actinRule", "[", 
              RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
           "*)"}], "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "IDABPNext", ",",
              "0.", ",", "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
             RowBox[{"angleABPNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideABPNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", "IDABPNextNextNext",
            ",", "angleNextNext", ",", "nucleotideABPNextNext"}], "]"}]}], 
        "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "IDABPNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",",
       "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
           "distNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", 
              RowBox[{"actinRule", "[", 
               RowBox[{"distNextNext", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
             "distNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "\n", "}"}]}], ";"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndCam", "=", 
    RowBox[{"{", "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"cam", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
           "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP1", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", 
             RowBox[{"ABPRule", "[", 
              RowBox[{"camDist", ",", "ACT"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords", ",", "delta"}], "]"}], ",", "IDNext", ",", 
             "angle", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cam", "[", 
            RowBox[{
            "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
             "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cam", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
           "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP2", "[", 
            RowBox[{"coordsABP", ",", "coordsNextNext", ",", 
             RowBox[{"ABPRule", "[", 
              RowBox[{"camDist", ",", "ACT"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
           "*)"}], "\n", 
          RowBox[{
           RowBox[{"cam", "[", 
            RowBox[{
            "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
             "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "IDNextNextNext", ",", "angleNextNext", ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndActin", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP1", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", " ", 
             RowBox[{"actinRule", "[", 
              RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{"ID", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords", ",", "delta"}], "]"}], ",", "IDNext", ",", 
             "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", 
             ",", "nucleotideNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{"ID", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"deltaFuncPairwiseP1", "[", 
              RowBox[{"coords", ",", "coordsNext", ",", " ", 
               RowBox[{"actinRule", "[", 
                RowBox[{"distNext", ",", "False"}], "]"}]}], "]"}]}], "]"}], ",",
            "IDNext", ",", "nucleotide", ",", "nullPointer", ",", "dist"}], 
          "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "distNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", 
             RowBox[{"deltaFuncPairwiseP2", "[", 
              RowBox[{"coords", ",", "coordsNext", ",", " ", 
               RowBox[{"actinRule", "[", 
                RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}], "]"}], ",", 
           "nucleotideNext", ",", "nullPointer", ",", "distNext"}], "]"}]}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "nullPointer", ",", "angleABP", ",",
            "ABPRule"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP2", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", 
             RowBox[{"ABPRule", "[", "ABP", "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], 
           ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "nullPointer", 
             ",", "angleABP", ",", "ABPRule"}], "]"}]}], "\n", "}"}]}], 
        "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", " ", 
           RowBox[{"deltaFuncPairwiseP2", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", " ", 
             RowBox[{"actinRule", "[", 
              RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNext", ",", "nullPointer", ",", "dist"}], "]"}]}], 
          "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{"IDNext", ",", "coordsNext", ",", "nucleotideNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", " ", 
           RowBox[{"deltaFuncPairwiseP2", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", " ", 
             RowBox[{"actinRule", "[", 
              RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndArp", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "distNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncPairwiseP2", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", " ", 
             RowBox[{"actinRule", "[", 
              RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "angleABP", ",", 
             "ABPRule"}], "]"}], ",", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNext", ",", "nullPointer", ",", "distNext"}], "]"}]}],
           "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "\n", "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesAnisotropic", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rulesAnisotropicLinear", ",", "rulesAnisotropicJunc", ",", 
     "rulesAnisotropicCam", ",", "rulesAnisotropicArp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesEndRadial", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"rulesEndCam", ",", "rulesEndActin", ",", "rulesEndArp"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9645354041386223`*^9, 3.9645354055995483`*^9}, {
   3.965491867917602*^9, 3.9654918979151697`*^9}, {3.965493339992962*^9, 
   3.965493340677575*^9}, {3.9654945109639482`*^9, 3.965494514908122*^9}, {
   3.968431039523945*^9, 3.968431116837422*^9}, {3.9684311618833647`*^9, 
   3.9684311711691427`*^9}, {3.968431366002397*^9, 3.968431510746882*^9}, {
   3.9684318739530153`*^9, 3.968431883286982*^9}, 3.97249963719665*^9, {
   3.9724996787727337`*^9, 3.9724997136893873`*^9}, {3.972499745323674*^9, 
   3.972499810967202*^9}, {3.972500558046027*^9, 3.972500572267014*^9}, {
   3.972500603340506*^9, 3.972500614487473*^9}, {3.9725006503398046`*^9, 
   3.97250067008714*^9}, {3.9725007174212914`*^9, 3.972500718036112*^9}, 
   3.972501072031475*^9, {3.972501264903759*^9, 3.9725012885690613`*^9}, {
   3.9725015072985563`*^9, 3.972501513557461*^9}, {3.9725066599115*^9, 
   3.972506703701439*^9}, {3.9725431853521423`*^9, 3.972543190227359*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"8061e8e2-b8bf-4af0-bcfc-ececc2683cc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Norm", "'"}], "[", "vec_", "]"}], ":=", 
   RowBox[{"vec", "/", 
    RowBox[{"Norm", "[", "vec", "]"}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"k", "[", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x2", "-", "x3"}], ")"}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], 
      RowBox[{"b", "[", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x2", "-", "x1"}], ")"}], " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{"x3", "-", "x2"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"x2", "-", "x1"}], "]"}], 
      RowBox[{"Norm", "[", 
       RowBox[{"x3", "-", "x2"}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"x3", "-", "x2"}], "]"}], "/", 
    RowBox[{"Norm", "[", 
     RowBox[{"x2", "-", "x1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"x2", "-", "x1"}], "]"}], 
     RowBox[{"Norm", "[", 
      RowBox[{"x3", "-", "x2"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"DbendInt", "=", 
   RowBox[{"Re", "[", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"asub", "=", 
        RowBox[{"a", "[", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], "}"}], ",", 
      RowBox[{"\[Kappa]Pot", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "\[Theta]", "]"}], "-", "ang"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            RowBox[{"asub", "^", "2"}]}], "]"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", "[", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], "+", 
         RowBox[{"k", "[", 
          RowBox[{"x3", ",", "x2", ",", "x1"}], "]"}]}], ")"}]}]}], "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DbendEnd1", "=", 
   RowBox[{"Re", "[", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"asub", "=", 
        RowBox[{"a", "[", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"-", "\[Kappa]Pot"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "\[Theta]", "]"}], "-", "ang"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            RowBox[{"asub", "^", "2"}]}], "]"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"k", "[", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], ")"}]}]}], "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DbendEnd3", "=", 
    RowBox[{"Re", "[", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"asub", "=", 
         RowBox[{"a", "[", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"-", "\[Kappa]Pot"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", "\[Theta]", "]"}], "-", "ang"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}], 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{"asub", "^", "2"}]}], "]"}]}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{"k", "[", 
          RowBox[{"x3", ",", "x2", ",", "x1"}], "]"}], ")"}]}]}], "]"}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"deltaFuncP1Angular", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3o_", ",", "y3o_"}], "}"}], ",", "rule_"}], "]"}], ":=", "\n", 
  
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"updateFunction", "/.", "rule"}], ")"}], "[", 
        RowBox[{"d0", "/.", "rule"}], "]"}], " ", "DbendEnd1"}], "/.", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "->", 
           RowBox[{"{", 
            RowBox[{"x1o", ",", "y1o"}], "}"}]}], ",", 
          RowBox[{"x2", "->", 
           RowBox[{"{", 
            RowBox[{"x2o", ",", "y2o"}], "}"}]}], ",", 
          RowBox[{"x3", "->", 
           RowBox[{"{", 
            RowBox[{"x3o", ",", "y3o"}], "}"}]}]}], "}"}], ",", "rule"}], 
       "]"}]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Indeterminate", "->", "0."}], ",", 
     RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"deltaFuncP2Angular", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3o_", ",", "y3o_"}], "}"}], ",", "rule_"}], "]"}], ":=", "\n", 
  
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"updateFunction", "/.", "rule"}], ")"}], "[", 
        RowBox[{"d0", "/.", "rule"}], "]"}], "DbendInt"}], "/.", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "->", 
           RowBox[{"{", 
            RowBox[{"x1o", ",", "y1o"}], "}"}]}], ",", 
          RowBox[{"x2", "->", 
           RowBox[{"{", 
            RowBox[{"x2o", ",", "y2o"}], "}"}]}], ",", 
          RowBox[{"x3", "->", 
           RowBox[{"{", 
            RowBox[{"x3o", ",", "y3o"}], "}"}]}]}], "}"}], ",", "rule"}], 
       "]"}]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Indeterminate", "->", "0."}], ",", 
     RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"deltaFuncP3Angular", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1o_", ",", "y1o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2o_", ",", "y2o_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3o_", ",", "y3o_"}], "}"}], ",", "rule_"}], "]"}], ":=", "\n", 
  
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"updateFunction", "/.", "rule"}], ")"}], "[", 
        RowBox[{"d0", "/.", "rule"}], "]"}], " ", "DbendEnd3"}], "/.", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "->", 
           RowBox[{"{", 
            RowBox[{"x1o", ",", "y1o"}], "}"}]}], ",", 
          RowBox[{"x2", "->", 
           RowBox[{"{", 
            RowBox[{"x2o", ",", "y2o"}], "}"}]}], ",", 
          RowBox[{"x3", "->", 
           RowBox[{"{", 
            RowBox[{"x3o", ",", "y3o"}], "}"}]}]}], "}"}], ",", "rule"}], 
       "]"}]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Indeterminate", "->", "0."}], ",", 
     RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.972505840368534*^9, {3.972507770206718*^9, 3.972507771206566*^9}, {
   3.9729381425089817`*^9, 3.972938149929826*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"d051d0fa-326f-4854-8b98-6a821d996e48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesBendingLinear", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDNextNextABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDNextNextABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDABP", ",", "angleNextNext", ",", "angleABP", ",", 
           "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
             "spineID", ",", "dist"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "IDABP", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], 
        "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesBendingJunc", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", "coordsABP", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", 
                   RowBox[{"70", "Degree"}]}], ",", 
                  RowBox[{"\[Theta]", "->", 
                   RowBox[{"VectorAngle", "[", 
                    RowBox[{
                    RowBox[{"coordsNext", "-", "coords"}], ",", 
                    RowBox[{"coordsABP", "-", "coordsNext"}]}], "]"}]}]}], 
                 "}"}]}], "]"}]}], "]"}], "+", "\n", 
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{
             "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", "0."}], ",", 
                  RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}],
              "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}], ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pE", "==", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", "coordsABP", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", 
                   RowBox[{"70", "Degree"}]}], ",", 
                  RowBox[{"\[Theta]", "->", 
                   RowBox[{"VectorAngle", "[", 
                    RowBox[{
                    RowBox[{"coordsNext", "-", "coords"}], ",", 
                    RowBox[{"coordsABP", "-", "coordsNext"}]}], "]"}]}]}], 
                 "}"}]}], "]"}]}], "]"}], "+", "\n", 
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{
             "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", "0."}], ",", 
                  RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}],
              "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", "pE", ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNextNext"}], "]"}], ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"bE", "==", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
             "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", "coordsABP", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", 
                   RowBox[{"70", "Degree"}]}], ",", 
                  RowBox[{"\[Theta]", "->", 
                   RowBox[{"VectorAngle", "[", 
                    RowBox[{
                    RowBox[{"coordsNext", "-", "coords"}], ",", 
                    RowBox[{"coordsABP", "-", "coordsNext"}]}], "]"}]}]}], 
                 "}"}]}], "]"}]}], "]"}], "+", "\n", 
            RowBox[{"deltaFuncP2Angular", "[", 
             RowBox[{
             "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"Join", "[", " ", 
               RowBox[{
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BArp"}], ",", 
                  RowBox[{"ang", "->", "0."}], ",", 
                  RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}],
              "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", "IDNextNext", 
             ",", "ABPID", ",", "\n", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "delta"}], "]"}], ",", 
               "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", "bE", ",", 
           RowBox[{"ABP", "[", 
            RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"endActinDeltaTheta", "[", 
                RowBox[{"coordsNext", ",", "coordsABP", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesBendingCam", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"cam", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
           "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"camRule", "[", 
                RowBox[{"camDist", ",", "CAM"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]BCam"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", 
                  RowBox[{"VectorAngle", "[", 
                   RowBox[{
                    RowBox[{"coordsABP", "-", "coords"}], ",", 
                    RowBox[{"coordsNextNext", "-", "coordsABP"}]}], "]"}]}]}],
                 "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actin", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"cam", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "ID", ",", 
             "IDNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "ABPRule", ",", "camDist"}], 
            "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
             "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
          "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesBendingArp", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleABPNext", ",", "nucleotideABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"ACT", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", 
                  RowBox[{"VectorAngle", "[", 
                   RowBox[{
                    RowBox[{"coordsABPNext", "-", "coordsABP"}], ",", 
                    RowBox[{"coordsABP", "-", "coords"}]}], "]"}]}]}], 
                "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", 
             RowBox[{"secondAngle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "IDABPNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
             RowBox[{"angleABPNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideABPNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"ACT", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", 
                  RowBox[{"VectorAngle", "[", 
                   RowBox[{
                    RowBox[{"coordsABPNext", "-", "coordsABP"}], ",", 
                    RowBox[{"coordsABP", "-", "coords"}]}], "]"}]}]}], 
                "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", 
             RowBox[{"secondAngle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABP", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", "IDABPNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABP", ",", "delta"}], "]"}], ",", 
               "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
             "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}]}], 
        "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", "IDABPNextNextNext",
            ",", "angleNextNext", ",", "nucleotideABPNextNext"}], "]"}]}], 
        "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{
            "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
             
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "IDABPNextNextNext", ",", 
             RowBox[{"angleNextNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",",
       "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
           "distNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{
            "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
             
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
             "distNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP2Angular", "[", 
            RowBox[{
            "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
             
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{
               RowBox[{"startActinDeltaTheta", "[", 
                RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                 RowBox[{"addVectors", "[", 
                  RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}],
             "]"}], ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "IDABPNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
               "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], 
            "]"}], ",", "\n", 
           RowBox[{"cap", "[", 
            RowBox[{
            "IDABPNextNext", ",", "coordsABPNextNext", ",", 
             "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "\n", "}"}]}], ";"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndBendingActin", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"a3", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP1Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{"ID", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords", ",", "delta"}], "]"}], ",", "IDNext", ",", 
             "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coords", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNext"}], "]"}], ",", "a3"}], "\n", "}"}]}], "]"}]}], ",",
       "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"a3", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
            "IDABPNextNextNext", ",", "angleNextNext", ",", 
            "angleABPNextNextNext", ",", "nucleotideNextNext"}], "]"}]}]}], 
        "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP1Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{"ID", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords", ",", "delta"}], "]"}], ",", "IDNext", ",", 
             "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coords", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNext"}], "]"}], ",", "a3"}], "\n", "}"}]}], "]"}]}], ",",
       "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"a3", "==", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
             "spineIDNextNext", ",", "distNextNext"}], "]"}]}]}], "}"}], "->",
        "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP1Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"pointedEnd", "[", 
            RowBox[{"ID", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords", ",", "delta"}], "]"}], ",", "IDNext", ",", 
             "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"endActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coords", ",", "delta"}], "]"}]}], "]"}]}], ",", 
             "nucleotideNext"}], "]"}], ",", "a3"}], "\n", "}"}]}], "]"}]}], ",",
       "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "nullPointer", ",", "distNextNext"}], "]"}]}], "}"}], "->", "\n", 
       
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext", ",", "nullPointer", ",", "distNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
            "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "nullPointer", ",", "distNextNext"}], "]"}]}], "}"}], "->", "\n", 
       
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext", ",", "nullPointer", ",", "distNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
             "angleABP", ",", "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "nullPointer", ",", "distNextNext"}], "]"}]}], "}"}], "->", "\n", 
       
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext", ",", "nullPointer", ",", "distNextNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
            "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
             "angleABP", ",", "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nucleotideNext", "==", "cofilin"}], ",", 
                    RowBox[{"\[Kappa]B", "/", "5."}], ",", "\[Kappa]B"}], 
                   "]"}]}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleNext"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"a1", ",", "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
             RowBox[{"angleNext", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNextNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "nucleotideNext"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"IDNextNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNextNext", ",", "delta"}], "]"}], ",", 
             "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "nullPointer", ",", "distABPNext"}], "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{"deltaFuncP3Angular", "[", 
            RowBox[{"coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"actinRule", "[", 
                RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Kappa]Pot", "->", "\[Kappa]B"}], ",", 
                 RowBox[{"ang", "->", "0."}], ",", 
                 RowBox[{"\[Theta]", "->", "angleABP"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{
            "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], 
           ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"ABP", "[", 
            RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
             RowBox[{"angleABP", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsABPNext", ",", "delta"}], "]"}]}], "]"}]}], ",",
              "ABPRule"}], "]"}], ",", "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{"IDABPNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "delta"}], "]"}], ",", 
             "nucleotideABPNext", ",", "nullPointer", ",", "distABPNext"}], 
            "]"}]}], "\n", "}"}]}], "]"}]}], ",", "\n", 
      RowBox[{"with", "[", "biomechanicalRate", "]"}]}], "\n", "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesBending", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rulesBendingLinear", ",", "rulesBendingJunc", ",", "rulesBendingCam", ",",
      "rulesBendingArp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesEndBending", "=", "rulesEndBendingActin"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963668904509758*^9, 3.963668913424613*^9}, {
   3.9636692712047367`*^9, 3.9636693333763933`*^9}, {3.9636857488941107`*^9, 
   3.963685749760706*^9}, {3.965493033990613*^9, 3.965493038566478*^9}, {
   3.96843152518889*^9, 3.968431625638342*^9}, {3.968431796472042*^9, 
   3.968431865307414*^9}, {3.9724998781888638`*^9, 3.972499955259123*^9}, {
   3.972499985961287*^9, 3.972500018629241*^9}, {3.972500075537758*^9, 
   3.972500123467174*^9}, {3.972500193731256*^9, 3.972500229506544*^9}, {
   3.972500986601811*^9, 3.972501008936776*^9}, {3.972501303781973*^9, 
   3.9725013257719*^9}, 3.972501444464388*^9, {3.972501475176982*^9, 
   3.972501481092388*^9}, {3.972506717788623*^9, 3.972506730253169*^9}, {
   3.972508224029326*^9, 3.972508254994836*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"87b1275e-ee9b-46aa-b37b-39edf1158af6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hessian Thermal Noise", "Subsection",ExpressionUUID->"5f8843f4-21ba-4b97-a58b-8c8a7fd1426e"],

Cell[CellGroupData[{

Cell["Rules", "Subsubsection",ExpressionUUID->"6fa471dc-f78e-4856-8e38-54c5ed8a2cc1"],

Cell["\<\
In this section, another term of the Taylor expansion of the potential \
includes such that the force term also depends on the Hessian, a matrix of \
second derivatives of the potential, which adds noise to the gradient \
minimization.
Below, we utilize a pairwise Lennard-Jones potential between two points ri \
and rj. The equilibrium displacement vector between ri and rj where rj moves \
to the minimum coordinate denotes by u. 

The Hessian approximation to the potential where the gradient or the first \
derivative approaches zero follows from the Taylor expansion of a potential \
which, in this case, equals
U(R+u) \[TildeTilde] U(R) + Transpose[U`(R)]u + 1/2 \\!\\(\\( 
\\*SuperscriptBox[\\(u\\), \\(\[Transpose]\\)]\\ H\\)
\\*SubscriptBox[\\(|\\), \\(R\\)]\\) u + ...,
where U is the potential function, R is the equilibrium displacement vector \
and u the displacement from equilibrium. Again, we use gradient clipping.\
\>", "Text",ExpressionUUID->"60ddf256-6ae5-4400-b94c-22497bbbfd5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"addVectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dx_", ",", "dy_"}], "}"}]}], "]"}], ":=", "\n", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2"}], "}"}], "+", 
   RowBox[{"{", 
    RowBox[{"dx", ",", "dy"}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"potentialTrinodal", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "rule1_", ",", "rule2_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"potential", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"x2", "-", "x1"}], "]"}], ",", 
        RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], "/.", 
      "rule1"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"potential", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"x3", "-", "x2"}], "]"}], ",", 
        RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], "/.", 
      "rule2"}], ")"}]}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972938134869842*^9, 3.9729381391197968`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"32c4fa41-f363-48c3-868e-3bdeda3603c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TriNodalHessianExpr", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"r1", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ1"}], ",", 
                RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ1"}], ",", 
                RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss1"}], ",", 
                RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss1"}], ",", 
                RowBox[{"\[Kappa]", "->", "\[Kappa]1"}]}], "}"}], ",", 
              "\[Epsilon]1", ",", "l01"}], "]"}], ",", "r1"}], "]"}], ",", 
          "r1"}], "]"}], ")"}], 
       RowBox[{"HoldForm", "[", 
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", "rhat1", ",", "rhat1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"potential", "[", 
           RowBox[{"r1", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ1"}], ",", 
              RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ1"}], ",", 
              RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss1"}], ",", 
              RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss1"}], ",", 
              RowBox[{"\[Kappa]", "->", "\[Kappa]1"}]}], "}"}], ",", 
            "\[Epsilon]1", ",", "l01"}], "]"}], ",", "r1"}], "]"}], "/", 
        "r1"}], " ", 
       RowBox[{"HoldForm", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "rhat1", ",", "rhat1"}], "]"}]}], ")"}], 
        "]"}]}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"potential", "[", 
            RowBox[{"r2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ2"}], ",", 
               RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ2"}], ",", 
               RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss2"}], ",", 
               RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss2"}], ",", 
               RowBox[{"\[Kappa]", "->", "\[Kappa]2"}]}], "}"}], ",", 
             "\[Epsilon]2", ",", "l02"}], "]"}], ",", "r2"}], "]"}], ",", 
         "r2"}], "]"}], 
       RowBox[{"HoldForm", "[", 
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", "rhat2", ",", "rhat2"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"potential", "[", 
           RowBox[{"r2", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ2"}], ",", 
              RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ2"}], ",", 
              RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss2"}], ",", 
              RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss2"}], ",", 
              RowBox[{"\[Kappa]", "->", "\[Kappa]2"}]}], "}"}], ",", 
            "\[Epsilon]2", ",", "l02"}], "]"}], ",", "r2"}], "]"}], "/", 
        "r2"}], " ", 
       RowBox[{"HoldForm", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "rhat2", ",", "rhat2"}], "]"}]}], ")"}], 
        "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndHessianExpr", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"potential", "[", 
           RowBox[{"r", ",", 
            RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], ",", 
          "r"}], "]"}], ",", "r"}], "]"}], 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "rhat", ",", "rhat"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"potential", "[", 
          RowBox[{"r", ",", 
           RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], ",", 
         "r"}], "]"}], "/", "r"}], " ", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", "rhat", ",", "rhat"}], "]"}]}], ")"}], 
       "]"}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"JuncHessianExpr", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"r1", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ1"}], ",", 
                RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ1"}], ",", 
                RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss1"}], ",", 
                RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss1"}], ",", 
                RowBox[{"\[Kappa]", "->", "\[Kappa]1"}]}], "}"}], ",", 
              "\[Epsilon]1", ",", "l1"}], "]"}], ",", "r1"}], "]"}], ",", 
          "r1"}], "]"}], 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", "rhat1", ",", "rhat1"}], "]"}], "]"}]}], "+", 
       
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"potential", "[", 
            RowBox[{"r1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ1"}], ",", 
               RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ1"}], ",", 
               RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss1"}], ",", 
               RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss1"}], ",", 
               RowBox[{"\[Kappa]", "->", "\[Kappa]1"}]}], "}"}], ",", 
             "\[Epsilon]1", ",", "l1"}], "]"}], ",", "r1"}], "]"}], "/", 
         "r1"}], " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "rhat1", ",", "rhat1"}], "]"}]}], ")"}], 
         "]"}]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"r3", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ2"}], ",", 
                RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ2"}], ",", 
                RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss2"}], ",", 
                RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss2"}], ",", 
                RowBox[{"\[Kappa]", "->", "\[Kappa]2"}]}], "}"}], ",", 
              "\[Epsilon]2", ",", "l2"}], "]"}], ",", "r3"}], "]"}], ",", 
          "r3"}], "]"}], 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", "rhat3", ",", "rhat3"}], "]"}], "]"}]}], "+", 
       
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"potential", "[", 
            RowBox[{"r3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ2"}], ",", 
               RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ2"}], ",", 
               RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss2"}], ",", 
               RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss2"}], ",", 
               RowBox[{"\[Kappa]", "->", "\[Kappa]2"}]}], "}"}], ",", 
             "\[Epsilon]2", ",", "l2"}], "]"}], ",", "r3"}], "]"}], "/", 
         "r3"}], " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "rhat3", ",", "rhat3"}], "]"}]}], ")"}], 
         "]"}]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"r4", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ3"}], ",", 
                RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ3"}], ",", 
                RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss3"}], ",", 
                RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss3"}], ",", 
                RowBox[{"\[Kappa]", "->", "\[Kappa]3"}]}], "}"}], ",", 
              "\[Epsilon]3", ",", "l3"}], "]"}], ",", "r4"}], "]"}], ",", 
          "r4"}], "]"}], 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", "rhat4", ",", "rhat4"}], "]"}], "]"}]}], "+", 
       
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"potential", "[", 
            RowBox[{"r4", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]LJ", "->", "\[Sigma]LJ3"}], ",", 
               RowBox[{"\[Epsilon]PotLJ", "->", "\[Epsilon]PotLJ3"}], ",", 
               RowBox[{"\[Sigma]Gauss", "->", "\[Sigma]Gauss3"}], ",", 
               RowBox[{"\[Epsilon]PotGauss", "->", "\[Epsilon]PotGauss3"}], ",", 
               RowBox[{"\[Kappa]", "->", "\[Kappa]3"}]}], "}"}], ",", 
             "\[Epsilon]3", ",", "l3"}], "]"}], ",", "r4"}], "]"}], "/", 
         "r4"}], " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "rhat1", ",", "rhat1"}], "]"}]}], ")"}], 
         "]"}]}]}], ")"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HessianFuncPot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1xIn_", ",", "x1yIn_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2xIn_", ",", "x2yIn_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3xIn_", ",", "x3yIn_"}], "}"}], ",", "rule1_", ",", "rule2_", 
     ",", 
     RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"H", "=", 
       RowBox[{
        RowBox[{"ReleaseHold", "[", 
         RowBox[{"TriNodalHessianExpr", "/.", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rhat1", "->", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], ")"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}]}], ",", 
              RowBox[{"\[Sigma]LJ1", "->", 
               RowBox[{"(", 
                RowBox[{"\[Sigma]LJ", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{"\[Sigma]Gauss1", "->", 
               RowBox[{"(", 
                RowBox[{"\[Sigma]Gauss", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]PotLJ1", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]PotLJ", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]PotGauss1", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]PotGauss", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]1", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"\[Kappa]1", "->", "\[Kappa]"}], "/.", "rule1"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rhat2", "->", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x3xIn", ",", "x3yIn"}], "}"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"x2xIn", ",", "x2yIn"}], "}"}]}], ")"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"x3xIn", ",", "x3yIn"}], "}"}]}], "]"}]}]}], ",", 
              RowBox[{"\[Sigma]LJ2", "->", 
               RowBox[{"(", 
                RowBox[{"\[Sigma]LJ", "/.", "rule2"}], ")"}]}], ",", 
              RowBox[{"\[Sigma]Gauss2", "->", 
               RowBox[{"(", 
                RowBox[{"\[Sigma]Gauss", "/.", "rule2"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]PotLJ2", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]PotLJ", "/.", "rule2"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]PotGauss2", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]PotGauss", "/.", "rule2"}], ")"}]}], ",", 
              RowBox[{"\[Epsilon]2", "->", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "/.", "rule2"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"\[Kappa]2", "->", "\[Kappa]"}], "/.", "rule2"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"l01", "->", 
               RowBox[{"(", 
                RowBox[{"d0", "/.", "rule1"}], ")"}]}], ",", 
              RowBox[{"l02", "->", 
               RowBox[{"(", 
                RowBox[{"d0", "/.", "rule2"}], ")"}]}]}], "}"}]}], "]"}]}], 
         "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "->", 
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"r2", "->", 
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"x3xIn", ",", "x3yIn"}], "}"}]}], "]"}]}]}], "}"}]}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"scale", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", 
             RowBox[{"Max", "[", 
              RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"0.", "->", 
              RowBox[{"1", "/", "eps"}]}], "}"}]}], ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"Max", "[", 
              RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"0.", "->", 
              RowBox[{"1", "/", "eps"}]}], "}"}]}]}], "}"}]}], "}"}]}], "/.", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Indeterminate", "->", 
         RowBox[{"1", "/", "eps"}]}], ",", 
        RowBox[{"Infinity", "->", 
         RowBox[{"1", "/", "eps"}]}], ",", 
        RowBox[{"ComplexInfinity", "->", 
         RowBox[{"1", "/", "eps"}]}]}], "}"}]}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"HessianFuncPotEnd", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1xIn_", ",", "x1yIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2xIn_", ",", "x2yIn_"}], "}"}], ",", "rules_", ",", 
    RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{"EndHessianExpr", "/.", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rhat", "->", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                RowBox[{"{", 
                 RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                RowBox[{"{", 
                 RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}]}], "}"}], ",",
            "rules"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"r", "->", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}], "}"}]}]}], 
     "\n", "}"}], ",", 
    RowBox[{
     RowBox[{"scale", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Max", "[", 
             RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"0.", "->", 
             RowBox[{"1", "/", "eps"}]}], "}"}]}], ",", "0."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Max", "[", 
             RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"0.", "->", 
             RowBox[{"1", "/", "eps"}]}], "}"}]}]}], "}"}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Indeterminate", "->", 
        RowBox[{"1", "/", "eps"}]}], ",", 
       RowBox[{"Infinity", "->", 
        RowBox[{"1", "/", "eps"}]}], ",", 
       RowBox[{"ComplexInfinity", "->", 
        RowBox[{"1", "/", "eps"}]}]}], "}"}]}]}], "\n", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.964451388053403*^9, 3.964451468507805*^9}, {
  3.964451501371605*^9, 3.964451503819388*^9}, {3.9644515358387737`*^9, 
  3.9644515914289083`*^9}, {3.964451626058566*^9, 3.964451644634521*^9}, {
  3.9644517720144653`*^9, 3.964451777471912*^9}, {3.964578518133662*^9, 
  3.964578528904972*^9}, {3.97293564115372*^9, 3.972935718127739*^9}, {
  3.972938121080002*^9, 3.97293813169471*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"42592851-7393-476d-8f9f-1a76438bf86e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getPotentialJunc", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "rule1_", ",", "rule2_", ",",
      "rule3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"potential", "[", " ", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"x2", "-", "x1"}], "]"}], ",", 
         RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], "/.", 
       "rule1"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"potential", "[", " ", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"x3", "-", "x2"}], "]"}], ",", 
         RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], "/.", 
       "rule2"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"potential", "[", " ", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"x4", "-", "x2"}], "]"}], ",", 
         RowBox[{"{", "}"}], ",", "\[Epsilon]", ",", "d0"}], "]"}], "/.", 
       "rule3"}], ")"}]}], ")"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"HessianFuncPotJunc", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1xIn_", ",", "x1yIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2xIn_", ",", "x2yIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3xIn_", ",", "x3yIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x4xIn_", ",", "x4yIn_"}], "}"}], ",", "rule1_", ",", "rule2_", ",",
     "rule3_", ",", 
    RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{"JuncHessianExpr", "/.", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Sigma]LJ1", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]LJ", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{"\[Sigma]Gauss1", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]Gauss", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotLJ1", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotLJ", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotGauss1", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotGauss", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]1", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"l1", "->", "d0"}], "/.", "rule1"}], ",", 
             RowBox[{
              RowBox[{"\[Kappa]1", "->", "\[Kappa]"}], "/.", "rule1"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Sigma]LJ2", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]LJ", "/.", "rule1"}], ")"}]}], ",", 
             RowBox[{"\[Sigma]Gauss2", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]Gauss", "/.", "rule2"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotLJ2", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotLJ", "/.", "rule2"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotGauss2", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotGauss", "/.", "rule2"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]2", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "/.", "rule2"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"l2", "->", "d0"}], "/.", "rule2"}], ",", 
             RowBox[{
              RowBox[{"\[Kappa]2", "->", "\[Kappa]"}], "/.", "rule2"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Sigma]LJ3", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]LJ", "/.", "rule3"}], ")"}]}], ",", 
             RowBox[{"\[Sigma]Gauss3", "->", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]Gauss", "/.", "rule3"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotLJ3", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotLJ", "/.", "rule3"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]PotGauss3", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]PotGauss", "/.", "rule3"}], ")"}]}], ",", 
             RowBox[{"\[Epsilon]3", "->", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "/.", "rule3"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"l3", "->", "d0"}], "/.", "rule3"}], ",", 
             RowBox[{
              RowBox[{"\[Kappa]3", "->", "\[Kappa]"}], "/.", "rule3"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rhat1", "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{"rhat3", "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x3xIn", ",", "x3yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}]}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x3xIn", ",", "x3yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{"rhat4", "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x4xIn", ",", "x4yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}]}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x4xIn", ",", "x4yIn"}], "}"}], "-", 
                 RowBox[{"{", 
                  RowBox[{"x2xIn", ",", "x2yIn"}], "}"}]}], "]"}]}]}]}], 
            "}"}]}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "->", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"x1xIn", ",", "x1yIn"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"r3", "->", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"x3xIn", ",", "x3yIn"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"r4", "->", " ", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x2xIn", ",", "x2yIn"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"x4xIn", ",", "x4yIn"}], "}"}]}], "]"}]}]}], "}"}]}]}], 
     "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"scale", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Max", "[", 
             RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"0.", "->", 
             RowBox[{"1", "/", "eps"}]}], "}"}]}], ",", "0."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Max", "[", 
             RowBox[{"H", "//", "Abs"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"0.", "->", 
             RowBox[{"1", "/", "eps"}]}], "}"}]}]}], "}"}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Indeterminate", "->", 
        RowBox[{"1", "/", "eps"}]}], ",", 
       RowBox[{"Infinity", "->", 
        RowBox[{"1", "/", "eps"}]}], ",", 
       RowBox[{"ComplexInfinity", "->", 
        RowBox[{"1", "/", "eps"}]}]}], "}"}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.964451698230166*^9, 3.964451736769052*^9}, {
  3.964451897706079*^9, 3.9644518990414143`*^9}, {3.964532578729685*^9, 
  3.9645325860925503`*^9}, {3.972935765538815*^9, 3.972935833666353*^9}, {
  3.972938097464746*^9, 3.9729381161664333`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"fd9b7e1e-ec68-4ca4-bb3d-6e98b61c9926"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"heatBathHessianAcceptance", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"axIn_", ",", "ayIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"bxIn_", ",", "byIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"cxIn_", ",", "cyIn_"}], "}"}], ",", "rule1_", ",", "rule2_", ",", 
    RowBox[{"rdIn_", "?", "ListQ"}], ",", 
    RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ax", "=", "axIn"}], " ", ",", 
      RowBox[{"ay", "=", "ayIn"}], " ", ",", 
      RowBox[{"bx", "=", "bxIn"}], " ", ",", 
      RowBox[{"by", "=", "byIn"}], " ", ",", 
      RowBox[{"cx", "=", "cxIn"}], " ", ",", 
      RowBox[{"cy", "=", "cyIn"}], " ", ",", 
      RowBox[{"rd", "=", "rdIn"}]}], "}"}], ",", "\n", 
    RowBox[{"Block", "[", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Uljx", "=", 
         RowBox[{"potentialTrinodal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax", ",", "ay"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"bx", ",", "by"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", "rule2"}], 
          "]"}]}], ",", 
        RowBox[{"Uqxprime", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"bx", ",", "by"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", 
               "rule2"}], "]"}], " ", ".", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"Uljxprime", "=", 
         RowBox[{"potentialTrinodal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax", ",", "ay"}], "}"}], ",", " ", 
           RowBox[{"addVectors", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", "rule2"}], 
          "]"}]}], ",", "\n", 
        RowBox[{"Uqx", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", 
               "rule2"}], "]"}], " ", ".", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"norm", "=", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", 
                "rule2"}], "]"}], "]"}], "/", 
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"bx", ",", "by"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"cx", ",", "cy"}], "}"}], ",", "rule1", ",", 
                "rule2"}], "]"}], "]"}]}], ")"}], "]"}]}]}]}], "\n", "}"}], ",",
       "\n", 
      RowBox[{"(*", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bxIn", ",", "byIn"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"axIn", ",", "ayIn"}], "}"}]}], "]"}], ">", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d0", "*", "\[Epsilon]"}], ")"}], "/.", "rule1"}], 
           ")"}]}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bxIn", ",", "byIn"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"cxIn", ",", "cyIn"}], "}"}]}], "]"}], ">", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d0", "*", "\[Epsilon]"}], ")"}], "/.", "rule2"}], 
           ")"}]}]}], "]"}], "*)"}], 
      RowBox[{
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"norm", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Uljxprime", "-", "Uljx"}], ")"}], "-", 
                   RowBox[{"(", 
                    RowBox[{"Uqxprime", "-", "Uqx"}], ")"}]}], ")"}], "/", 
                 "kBT"}], ")"}]}]}], "+", "1"}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Indeterminate", "->", "0."}], ",", 
            RowBox[{"Infinity", "->", "0."}], ",", 
            RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Underflow", "[", "]"}], "->", "0."}], ",", 
         RowBox[{
          RowBox[{"Overflow", "[", "]"}], "->", "0."}]}], "}"}]}]}], "\n", 
     "]"}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"heatBathEndHessianAcceptance", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"axIn_", ",", "ayIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"bxIn_", ",", "byIn_"}], "}"}], ",", "rule_", ",", 
    RowBox[{"rdIn_", "?", "ListQ"}], ",", 
    RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ax", "=", "axIn"}], " ", ",", 
      RowBox[{"ay", "=", "ayIn"}], " ", ",", 
      RowBox[{"bx", "=", "bxIn"}], " ", ",", 
      RowBox[{"by", "=", "byIn"}], " ", ",", 
      RowBox[{"rd", "=", "rdIn"}]}], "}"}], ",", "\n", 
    RowBox[{"Block", "[", "\n", 
     RowBox[{
      RowBox[{"{", "\n", 
       RowBox[{
        RowBox[{"Uljx", "=", 
         RowBox[{"potential", "[", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ax", ",", "ay"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"bx", ",", "by"}], "}"}]}], "]"}], ",", "rule", ",", 
           RowBox[{"\[Epsilon]", "/.", "rule"}], ",", 
           RowBox[{"d0", "/.", "rule"}]}], "]"}]}], ",", 
        RowBox[{"Uqxprime", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPotEnd", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"bx", ",", "by"}], "}"}], ",", "rule"}], "]"}], " ", ".",
              " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"Uljxprime", "=", 
         RowBox[{"potential", "[", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ax", ",", "ay"}], "}"}], "-", 
             RowBox[{"addVectors", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}]}], "]"}],
            ",", "rule", ",", 
           RowBox[{"\[Epsilon]", "/.", "rule"}], ",", 
           RowBox[{"d0", "/.", "rule"}]}], "]"}]}], ",", "\n", 
        RowBox[{"Uqx", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPotEnd", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
               "rule"}], "]"}], " ", ".", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"norm", "=", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
                "rule"}], "]"}], "]"}], "/", 
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"bx", ",", "by"}], "}"}], ",", "rule"}], "]"}], 
              "]"}]}], ")"}], "]"}]}]}]}], "\n", "}"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax", ",", "ay"}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{"bx", ",", "by"}], "}"}]}], "]"}], ">", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Epsilon]", "*", "d0"}], "/.", "rule"}], ")"}]}], "]"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"norm", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Uljxprime", "-", "Uljx"}], ")"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Uqxprime", "-", "Uqx"}], ")"}], "/", "kBT"}]}], 
                ")"}]}]}], "+", "1"}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Indeterminate", "->", "0."}], ",", 
            RowBox[{"Infinity", "->", "0."}], ",", 
            RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Underflow", "[", "]"}], "->", "0."}], ",", 
         RowBox[{
          RowBox[{"Overflow", "[", "]"}], "->", "0."}]}], "}"}]}]}], "\n", 
     "]"}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"heatBathJuncHessianAcceptance", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"axIn_", ",", "ayIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"bxIn_", ",", "byIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"cxIn_", ",", "cyIn_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dxIn_", ",", "dyIn_"}], "}"}], ",", "rule1_", ",", "rule2_", ",",
     "rule3_", ",", 
    RowBox[{"rdIn_", "?", "ListQ"}], ",", 
    RowBox[{"scale_", ":", "1."}]}], "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ax", "=", "axIn"}], " ", ",", 
      RowBox[{"ay", "=", "ayIn"}], " ", ",", 
      RowBox[{"bx", "=", "bxIn"}], " ", ",", 
      RowBox[{"by", "=", "byIn"}], " ", ",", 
      RowBox[{"cx", "=", "cxIn"}], " ", ",", 
      RowBox[{"cy", "=", "cyIn"}], " ", ",", 
      RowBox[{"dx", "=", "dxIn"}], " ", ",", 
      RowBox[{"dy", "=", "dyIn"}], " ", ",", 
      RowBox[{"rd", "=", "rdIn"}]}], "}"}], ",", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Uljx", "=", 
         RowBox[{"getPotentialJunc", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax", ",", "ay"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"bx", ",", "by"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2", ",",
            "rule3"}], "]"}]}], ",", 
        RowBox[{"Uqxprime", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPotJunc", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"bx", ",", "by"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"cx", ",", "cy"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2", 
               ",", "rule3"}], "]"}], " ", ".", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"Uljxprime", "=", 
         RowBox[{"getPotentialJunc", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ax", ",", "ay"}], "}"}], ",", " ", 
           RowBox[{"addVectors", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2", ",",
            "rule3"}], "]"}]}], ",", "\n", 
        RowBox[{"Uqx", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "rd", "}"}], " ", ".", " ", 
             RowBox[{"HessianFuncPotJunc", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax", ",", "ay"}], "}"}], ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"cx", ",", "cy"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2", 
               ",", "rule3"}], "]"}], " ", ".", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "rd", "}"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\n", 
        RowBox[{"norm", "=", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPotJunc", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"bx", ",", "by"}], "}"}], ",", "rd"}], "]"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"cx", ",", "cy"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2",
                 ",", "rule3"}], "]"}], "]"}], "/", 
             RowBox[{"Det", "[", 
              RowBox[{"HessianFuncPotJunc", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ax", ",", "ay"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"bx", ",", "by"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"cx", ",", "cy"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy"}], "}"}], ",", "rule1", ",", "rule2",
                 ",", "rule3"}], "]"}], "]"}]}], ")"}], "]"}]}]}]}], "\n", 
       "}"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ax", ",", "ay"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"bx", ",", "by"}], "}"}]}], "]"}], ">", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]", "*", "d0"}], "/.", "rule1"}], ")"}]}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cx", ",", "cy"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"bx", ",", "by"}], "}"}]}], "]"}], ">", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]", "*", "d0"}], "/.", "rule2"}], ")"}]}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"bx", ",", "by"}], "}"}]}], "]"}], ">", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]", "*", "d0"}], "/.", "rule3"}], ")"}]}]}], 
        "]"}], "*)"}], 
      RowBox[{
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"norm", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Uljxprime", "-", "Uljx"}], ")"}], "-", 
                   RowBox[{"(", 
                    RowBox[{"Uqxprime", "-", "Uqx"}], ")"}]}], ")"}], "/", 
                 "kBT"}], ")"}]}]}], "+", "1"}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Indeterminate", "->", "0."}], ",", 
            RowBox[{"Infinity", "->", "0."}], ",", 
            RowBox[{"ComplexInfinity", "->", "0."}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Underflow", "[", "]"}], "->", "0."}], ",", 
         RowBox[{
          RowBox[{"Overflow", "[", "]"}], "->", "0."}]}], "}"}]}]}], "\n", 
     "]"}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"safeScaledInverse", "[", 
   RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"m", "===", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0.", ",", 
       RowBox[{"Dimensions", "[", "m", "]"}]}], "]"}]}], ",", 
    RowBox[{"DiagonalMatrix", "@", 
     RowBox[{"Diagonal", "@", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"eps", "/", "kBT"}], ",", 
        RowBox[{"Dimensions", "[", "m", "]"}]}], "]"}]}]}], ",", 
    RowBox[{"2.", "*", " ", 
     RowBox[{
      RowBox[{"Inverse", "[", "m", "]"}], "/", "biomechanicalRate"}]}]}], 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.964017229873084*^9, 3.964017230162427*^9}, {
   3.964017273361615*^9, 3.964017275383918*^9}, {3.964017624155398*^9, 
   3.964017650591428*^9}, 3.964017828719236*^9, {3.9640211719580173`*^9, 
   3.964021173649534*^9}, {3.964035597009789*^9, 3.9640356054252787`*^9}, 
   3.967577346140667*^9, {3.967577406538334*^9, 3.967577416761429*^9}, {
   3.967578707927157*^9, 3.9675787083105183`*^9}, {3.972105738493081*^9, 
   3.972105739288711*^9}, 3.972106132659296*^9, {3.972106229145912*^9, 
   3.9721062314966917`*^9}, {3.972938035996462*^9, 3.972938094526278*^9}, {
   3.972941093119874*^9, 3.97294110513768*^9}, {3.973010660048567*^9, 
   3.9730107297597837`*^9}, {3.9730108105286503`*^9, 3.973010840035516*^9}, {
   3.973011416530794*^9, 3.973011424299822*^9}, {3.97301212467078*^9, 
   3.973012136952169*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"ebd4f207-f9ce-49ba-b8ef-916a9e38c8ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesHessianLinear", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coords", ",", " ", "coordsNext", ",", " ", "coordsNextNext", ",", 
          " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          " ", "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineIDNextNext", ",", "distNextNext"}], "]"}]}], "\n", "}"}]}], 
      ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coords", " ", ",", "coordsNext", " ", ",", "coordsNextNext", " ", ",",
           " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"distNextNext", ",", "False"}], "]"}], ",", "dcoords"}], 
         " ", "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNextNext", ",", "False"}], "]"}]}], "]"}]}]}]}],
            "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coords", " ", ",", "coordsNext", " ", ",", "coordsNextNext", " ", ",",
           " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          " ", "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
        "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coords", " ", ",", "coordsNext", " ", ",", "coordsNextNext", " ", ",",
           " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", "angleNextNext", ",", "angleNextNextABP", ",",
            "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDNextNextABP", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleNextNextABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
        "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDABP", ",", "angleNextNext", ",", "angleABP", ",", 
           "nucleotideNextNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "IDABP", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleABP", ",", "nucleotideNextNext"}], "]"}]}], "\n", "}"}]}], ",",
       "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineID", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"delta", "=", 
           RowBox[{
            RowBox[{"deltaFuncPairwiseP2", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], "]"}], "+", 
            RowBox[{"deltaFuncPairwiseP1", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", " ", 
              RowBox[{"actinRule", "[", 
               RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
             "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"actinJunc", "[", 
            RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
             RowBox[{"angle", "+", 
              RowBox[{"startActinDeltaTheta", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", 
                RowBox[{"addVectors", "[", 
                 RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",",
              "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"actin", "[", 
            RowBox[{"IDNext", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "IDNextNext", ",", 
             RowBox[{"middleThetaMovement", "[", 
              RowBox[{"coords", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
               "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",",
            "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
            "*)"}], "\n", 
           RowBox[{"barbedEnd", "[", 
            RowBox[{
            "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
              "spineID", ",", "dist"}], "]"}]}], "\n", "}"}]}], "]"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
            "angleABP", ",", "nucleotide"}], "]"}], ",", " ", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "angleABP", ",", "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}]}], 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesHessianJunc", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", "ABPID", ",", "\n", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", "\n", 
         
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"endActinDeltaTheta", "[", 
              RowBox[{"coordsNext", ",", "coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathJuncHessianAcceptance", "[", 
         RowBox[{
         "coords", ",", "coordsNext", ",", "coordsNextNext", ",", "coordsABP",
           ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
          RowBox[{"ABPRule", "[", "ACT", "]"}], ",", "dcoords"}], "]"}], " ", 
        
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotJunc", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
                "coordsABP", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}]}], "]"}], ",",
           "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"bE", "==", 
          RowBox[{"barbedEnd", "[", 
           RowBox[{
           "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
             "spineIDNextNext", ",", "distNextNext"}], "]"}]}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", "ABPID", ",", "\n", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", "\n", 
         
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", "bE", ",", 
         RowBox[{"ABP", "[", 
          RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"endActinDeltaTheta", "[", 
              RowBox[{"coordsNext", ",", "coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathJuncHessianAcceptance", "[", 
         RowBox[{
         "coords", ",", "coordsNext", ",", "coordsNextNext", ",", "coordsABP",
           ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"distNextNext", ",", "False"}], "]"}], ",", 
          RowBox[{"ABPRule", "[", "ACT", "]"}], ",", "dcoords"}], "]"}], " ", 
        
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotJunc", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
                "coordsABP", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], " ", ",", 
                " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNextNext", ",", "False"}], "]"}], ",", 
                RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}]}], "]"}], ",",
           "dcoords"}], "]"}]}], "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pE", "==", 
          RowBox[{"pointedEnd", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
            "spineID", ",", "dist"}], "]"}]}], ",", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "ABPID", ",", 
           "angleNext", ",", "angleNextABP", ",", "nucleotideNext"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "ABPID", ",", "coordsABP", ",", "IDNextABP", ",", "angleABP", ",", 
           "ABPRule"}], "]"}]}], "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", "IDNextNext", 
           ",", "ABPID", ",", "\n", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
             "coordsABP"}], "]"}], ",", "nucleotideNext"}], "]"}], ",", "\n", 
         
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", "pE", ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsNext", ",", "coordsNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNextNext"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{"ABPID", ",", "coordsABP", ",", "IDNextABP", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"endActinDeltaTheta", "[", 
              RowBox[{"coordsNext", ",", "coordsABP", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathJuncHessianAcceptance", "[", 
         RowBox[{
         "coords", ",", "coordsNext", ",", "coordsNextNext", ",", "coordsABP",
           ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
          RowBox[{"ABPRule", "[", "ACT", "]"}], ",", "dcoords"}], "]"}], " ", 
        
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotJunc", "[", 
               RowBox[{
               "coords", ",", "coordsNext", ",", "coordsNextNext", ",", 
                "coordsABP", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", 
                RowBox[{"ABPRule", "[", "ACT", "]"}]}], "]"}]}]}]}], "]"}], ",",
           "dcoords"}], "]"}]}], "]"}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesHessianCam", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"cam", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "ID", ",", "IDNextNext", ",", 
           "angleABP", ",", "ABPRule", ",", "camDist"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"cam", "[", 
          RowBox[{"IDABP", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", "ID", ",", 
           "IDNextNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", 
             "coordsNextNext"}], "]"}], ",", "ABPRule", ",", "camDist"}], 
          "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "last", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "IDNextNextNext", ",", 
           "angleNextNext", ",", "nucleotideNextNext"}], "]"}]}], "\n", 
        "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsABP", ",", "coordsNextNext", ",", 
          RowBox[{"ABPRule", "[", 
           RowBox[{"camDist", ",", "CAM"}], "]"}], ",", 
          RowBox[{"ABPRule", "[", 
           RowBox[{"camDist", ",", "CAM"}], "]"}], ",", "dcoords"}], "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Cam"], " ", " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", "coordsNextNext", ",", 
                RowBox[{"ABPRule", "[", 
                 RowBox[{"camDist", ",", "CAM"}], "]"}], " ", ",", 
                RowBox[{"ABPRule", "[", 
                 RowBox[{"camDist", ",", "CAM"}], "]"}]}], "]"}]}]}]}], "]"}],
           ",", "dcoords"}], "]"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesHessianArp", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleABPNext", ",", "nucleotideABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", 
           RowBox[{"secondAngle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABP", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", "IDABPNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", 
             "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           RowBox[{"angleABPNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABP", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideABPNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
          RowBox[{"ABPRule", "[", "ACT", "]"}], " ", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Arp"], " ", " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"ABPRule", "[", "ACT", "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "0.", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleABPNext", ",", "nucleotideABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", "IDABPNext", ",",
            "0.", ",", "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           RowBox[{"angleABPNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABP", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideABPNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coordsABPNext", ",", "coordsABP", ",", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Arp"], " ", " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coordsABPNext", ",", "coordsABP", ",", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}], "->",
        "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", 
           RowBox[{"secondAngle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABP", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", "IDABPNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coords", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", 
             "coordsABPNext"}], "]"}], ",", "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "spineIDABPNext", ",", "distABPNext"}], "]"}]}], "\n", "}"}]}], ",",
       "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
          RowBox[{"ABPRule", "[", "ACT", "]"}], ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"distABPNext", ",", "False"}], "]"}], ",", "dcoords"}], 
         "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Arp"], " ", "  ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coords", ",", "coordsABP", ",", "coordsABPNext", ",", 
                RowBox[{"ABPRule", "[", "ACT", "]"}], " ", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distABPNext", ",", "False"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", "IDABPNextNextNext",
            ",", "angleNextNext", ",", "nucleotideABPNextNext"}], "]"}]}], 
        "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"startActinDeltaTheta", "[", 
              RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDABPNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
           "IDABPNextNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coordsABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
             "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", "IDABPNextNextNext",
            ",", 
           RowBox[{"angleNextNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coordsABPNext", ",", "coordsABPNextNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",",
            "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
          " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",",
                 " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
           "distNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"startActinDeltaTheta", "[", 
              RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDABPNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
           "IDABPNextNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{"coordsABP", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
             "coordsABPNextNext"}], "]"}], ",", "nucleotideABPNext"}], "]"}], 
         ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext", ",", "spineIDNextNext", ",", 
           "distNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
          " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"distNextNext", ",", "False"}], "]"}], ",", "dcoords"}], 
         "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",",
                 " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNextNext", ",", "False"}], "]"}]}], "]"}]}]}]}],
            "]"}], ",", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "angleABP", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "IDABPNextNext", ",", 
           "angleNext", ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", "coordsABP", ",", "IDABPNext", ",", 
           RowBox[{"angleABP", "+", 
            RowBox[{
             RowBox[{"startActinDeltaTheta", "[", 
              RowBox[{"coordsABP", ",", "coordsABPNext", ",", 
               RowBox[{"addVectors", "[", 
                RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}]}], "]"}], 
             RowBox[{"Boole", "[", 
              RowBox[{"angleABP", "!=", "0."}], "]"}]}]}], ",", "ABPRule"}], 
          "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"IDABPNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{
             RowBox[{"addVectors", "[", 
              RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
             "dcoords"}], "]"}], ",", "IDABPNextNext", ",", 
           RowBox[{"middleThetaMovement", "[", 
            RowBox[{
            "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext"}], 
            "]"}], ",", "nucleotideABPNext"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{
          "IDABPNextNext", ",", "coordsABPNextNext", ",", 
           "nucleotideABPNextNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathHessianAcceptance", "[", 
         RowBox[{
         "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",", 
          " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPot", "[", 
               RowBox[{
               "coordsABP", ",", "coordsABPNext", ",", "coordsABPNextNext", ",",
                 " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", "dcoords"}], "]"}]}], "]"}]}], "\n", 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesHessianEndsActin", "=", "\n", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{"ID", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords", ",", "dcoords"}], "]"}], ",", "IDNext", ",", 
           "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{"IDNext", ",", "coordsNext", ",", "IDNextNext", ",", 
           RowBox[{"angleNext", "+", 
            RowBox[{"endActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coords", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotideNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coordsNext", ",", "coords", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coordsNext", ",", "coords", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", " ", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{"ID", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords", ",", "dcoords"}], "]"}], ",", "IDNext", ",", 
           "nucleotide", ",", "nullPointer", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coordsNext", ",", "coords", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coordsNext", ",", "coords", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", " ", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "actinObjectRise"}], "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
           "nucleotideNext", ",", "nullPointer", ",", "actinObjectRise"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", " ", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", "secondAngle", ",", "nucleotide"}], "]"}], ",", 
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "nullPointer", ",", "angleABP", ",",
            "ABPRule"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", 
           "filamentAngle", ",", 
           RowBox[{"secondAngle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsABP", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsABP", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "Update", " ", "angle", " ", "of", " ", "first", " ", "actin"}], 
          "*)"}], "\n", 
         RowBox[{"ABP", "[", 
          RowBox[{"IDABP", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABP", ",", "dcoords"}], "]"}], ",", "nullPointer", 
           ",", "angleABP", ",", "ABPRule"}], "]"}]}], "\n", "}"}]}], ",", 
      "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsABP", ",", 
          RowBox[{"ABPRule", "[", "ARP", "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Arp"], " ", " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coords", ",", "coordsABP", ",", 
                RowBox[{"ABPRule", "[", "ARP", "]"}]}], "]"}]}]}]}], "]"}], ",",
           " ", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "nullPointer", ",", "dist"}], "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
           "nucleotideNext", ",", "nullPointer", ",", "dist"}], "]"}]}], "\n",
         "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"dist", ",", "False"}], "]"}], ",", "dcoords"}], "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "False"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ",", " ", "dcoords"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{"IDNext", ",", "coordsNext", ",", "nucleotideNext"}], 
          "]"}]}], "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "Move", " ", "position", " ", "of", " ", "middle", " ", "actin", " ",
           "and", " ", "update", " ", "angle"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{"ID", ",", "coords", ",", "IDNext", ",", 
           RowBox[{"angle", "+", 
            RowBox[{"startActinDeltaTheta", "[", 
             RowBox[{"coords", ",", "coordsNext", ",", 
              RowBox[{"addVectors", "[", 
               RowBox[{"coordsNext", ",", "dcoords"}], "]"}]}], "]"}]}], ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"cap", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsNext", ",", "dcoords"}], "]"}], ",", 
           "nucleotideNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", "  ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coords", ",", "coordsNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"actinObjectRise", ",", "False"}], "]"}], ",", "dcoords"}],
          "]"}], 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coords", ",", "coordsNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"actinObjectRise", ",", "False"}], "]"}]}], 
               "]"}]}]}]}], "]"}], ",", " ", "dcoords"}], "]"}]}], "]"}], ",",
       "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "0.", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDABPNext", ",", "coordsABPNext", ",", "nucleotideABPNext", ",", 
           "nullPointer", ",", "distABPNext"}], "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "IDABP", ",", "coordsABP", ",", "IDABPNext", ",", "0.", ",", 
           "ABPRule"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDABPNext", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coordsABPNext", ",", "dcoords"}], "]"}], ",", 
           "nucleotideABPNext", ",", "nullPointer", ",", "distABPNext"}], 
          "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"biomechanicalRate", " ", 
        RowBox[{"heatBathEndHessianAcceptance", "[", 
         RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
          RowBox[{"actinRule", "[", 
           RowBox[{"distABPNext", ",", "False"}], "]"}], ",", "dcoords"}], 
         "]"}], " ", 
        RowBox[{"grammarPDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             FractionBox["kBT", "\[Zeta]Act"], " ", 
             RowBox[{"safeScaledInverse", "@", 
              RowBox[{"HessianFuncPotEnd", "[", 
               RowBox[{"coordsABP", ",", "coordsABPNext", ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distABPNext", ",", "False"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ",", "dcoords"}], "]"}]}], "]"}]}], "\n", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesHessian", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rulesHessianLinear", ",", "rulesHessianJunc", ",", "rulesHessianCam", ",",
      "rulesHessianArp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesHessianEnds", "=", "rulesHessianEndsActin"}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.963748772786941*^9, 3.96374877472046*^9}, {
   3.964313524853567*^9, 3.96431352721548*^9}, 3.9645353956103373`*^9, {
   3.96843169529547*^9, 3.968431777062711*^9}, {3.96843190157733*^9, 
   3.968431992422858*^9}, {3.97210623507482*^9, 3.972106350928781*^9}, {
   3.972106382969729*^9, 3.9721064429097433`*^9}, {3.9725002674452887`*^9, 
   3.9725003035863647`*^9}, {3.9725007606168756`*^9, 3.972500830596013*^9}, {
   3.9725009143835783`*^9, 3.9725009195777597`*^9}, {3.97250137172051*^9, 
   3.972501431052002*^9}, {3.972503478664248*^9, 3.972503483798064*^9}, {
   3.972503996277629*^9, 3.972504029545999*^9}, {3.972504074263517*^9, 
   3.9725040751627703`*^9}, {3.9725045328614683`*^9, 3.972504541872759*^9}, {
   3.97250674749688*^9, 3.972506763451428*^9}, {3.972508429094008*^9, 
   3.9725084322928877`*^9}, {3.972508546320756*^9, 3.972508555310603*^9}, {
   3.972509103974586*^9, 3.97250910451656*^9}, {3.972511330902911*^9, 
   3.972511331113064*^9}, {3.9725120025095587`*^9, 3.972512008520521*^9}, 
   3.972513855920972*^9, {3.9730101410056353`*^9, 3.973010322874823*^9}, 
   3.9730103777403584`*^9, {3.9730104297374077`*^9, 3.973010507210422*^9}, 
   3.9730110743043633`*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"6c6171f5-4e7b-4bd6-a636-d3635c96fbff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rules", "Subsection",ExpressionUUID->"22b63461-8abb-434c-b47b-eaa747f91e68"],

Cell["\<\
In the actin network ends' interaction with the membrane. There are rules \
that check for intersection and attach actin ends to the membrane. Then, the \
actin object can elongate to apply a force onto the membrane. Meanwhiile, \
there are random deviations of the actin's angle and by chance, according to \
Brownian elastic ratchet theory, the random angle change brings the end off \
the membrane. Afterwards, another actin can polymerize onto the membrane. \
Also, when the membrane force opposite the direction of the actin attached to \
the membrane is larger than the propulsive force of actin onto membrane, the \
actin de-attaches.\
\>", "Text",ExpressionUUID->"e92c8c5b-9481-4d4d-ac6d-968f490bddd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1", " ", "means", " ", "clockwise", " ", "and", " ", "2", " ", "means", " ",
     "counterclockwise"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"tripletOrientation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1x_", ",", "p1y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p2x_", ",", "p2y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p3x_", ",", "p3y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p2y", "-", "p1y"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"p3x", "-", "p2x"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p2x", "-", "p1x"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"p3y", "-", "p2y"}], ")"}]}]}], ">", "0"}], ",", "1", ",", 
      "2"}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Formula", " ", "for", " ", "checking", " ", "if", " ", "two", " ", 
     "line", " ", "segments", " ", "intersect"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersectingLinesQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p11x_", ",", "p11y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p12x_", ",", "p12y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p21x_", ",", "p21y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p22x_", ",", "p22y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"tripletOrientation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p11x", ",", "p11y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p12x", ",", "p12y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p21x", ",", "p21y"}], "}"}]}], "]"}], "!=", 
        RowBox[{"tripletOrientation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p11x", ",", "p11y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p12x", ",", "p12y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p22x", ",", "p22y"}], "}"}]}], "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"tripletOrientation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p21x", ",", "p21y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p22x", ",", "p22y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p11x", ",", "p11y"}], "}"}]}], "]"}], "!=", 
        RowBox[{"tripletOrientation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p21x", ",", "p21y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p22x", ",", "p22y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p12x", ",", "p12y"}], "}"}]}], "]"}]}], ")"}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.964469182373719*^9, 3.964469193004302*^9}, 
   3.9644692450577106`*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"e8d7f33a-052b-4b1b-aab2-6b2484aa7c23"],

Cell["\<\
Functions to initialize the spine membrane according to a regular polygon.\
\>", "Text",ExpressionUUID->"41d6a320-c132-41b7-86cf-9c75a207e8c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateSpinePoints", "[", 
   RowBox[{"numPoints_", ",", "r_"}], "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coords", ",", "theta"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"coords", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"theta", "=", "0"}], ",", 
       RowBox[{"theta", "<", 
        RowBox[{"2", "Pi"}]}], ",", 
       RowBox[{"theta", "+=", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "numPoints"}]}]}], ",", "\n", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"coords", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r", " ", 
              RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
             RowBox[{"r", " ", 
              RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}]}], "]"}]}], 
        ";"}]}], "\n", "]"}], ";", "\n", "coords"}]}], "\n", "]"}]}]], "Input",\

 InitializationCell->True,
 CellLabel->
  "In[235]:=",ExpressionUUID->"fba69cee-866b-4aba-885d-55b732e30cb0"],

Cell["\<\
Functions to compute the area of enclosed by the spine membrane at each time \
point .\
\>", "Text",ExpressionUUID->"7df31713-e1be-422d-ac72-c1e59e1347c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getSpineArea", "[", "moleculeList_", "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spineObjects", ",", "curID", ",", "initID", ",", 
      RowBox[{"coordList", "=", 
       RowBox[{"{", "}"}]}], ",", "curSpine", ",", "area", ",", "i"}], "}"}], 
    ",", "\n", 
    RowBox[{
     RowBox[{"spineObjects", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"moleculeList", ",", 
        RowBox[{"spine", "[", "__", "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"initID", "=", 
      RowBox[{"spineObjects", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "ID"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"coordList", ",", 
       RowBox[{"spineObjects", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "POS"}], "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"curID", "=", 
      RowBox[{"spineObjects", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "NEXT"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"curSpine", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"spineObjects", ",", 
         RowBox[{"spine", "[", 
          RowBox[{"curID", ",", "__"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"curID", "!=", "initID"}], ",", "\n", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"coordList", ",", 
          RowBox[{"curSpine", "[", 
           RowBox[{"[", "POS", "]"}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"curID", "=", 
         RowBox[{"curSpine", "[", 
          RowBox[{"[", "NEXT", "]"}], "]"}]}], ";", "\n", 
        RowBox[{"curSpine", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"spineObjects", ",", 
            RowBox[{"spine", "[", 
             RowBox[{"curID", ",", "__"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
     RowBox[{"area", "=", "0"}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{
         RowBox[{"Length", "@", "coordList"}], "-", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"area", "+=", 
         RowBox[{"Det", "[", 
          RowBox[{"coordList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ";;", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";"}]}], "\n", 
      "]"}], ";", "\n", 
     RowBox[{"area", "+=", 
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"coordList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"coordList", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
     RowBox[{"area", "/=", "2"}], ";", "\n", "area"}]}], "\n", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getPolygonArea", "[", "coords_", "]"}], ":=", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"area", ",", "i"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"area", "=", "0"}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{
          RowBox[{"Length", "@", "coords"}], "-", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"area", "+=", 
          RowBox[{"Det", "[", 
           RowBox[{"coords", "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";"}]}], "\n",
        "]"}], ";", "\n", 
      RowBox[{"area", "+=", 
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"area", "/=", "2"}], ";", "\n", "area"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"membraneAreaPlotter", "[", 
   RowBox[{"sim_", ",", 
    RowBox[{"title_", ":", "\"\<Membrane Area Over Time\>\""}], ",", 
    RowBox[{"plotRange_", ":", "Automatic"}], ",", 
    RowBox[{"export_", ":", "False"}]}], "]"}], ":=", "\n", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"spineVertices", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "===", "spine"}], "&"}]}], 
           "]"}], "&"}], "/@", "sim"}], ")"}]}], ",", "i", ",", "j", ",", 
      "spineAreas", ",", "data", ",", "firstVert", ",", "spineCoordsSnapshot",
       ",", "nextVert"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"spineAreas", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "@", "spineVertices"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"spineCoordsSnapshot", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", 
        RowBox[{"firstVert", "=", 
         RowBox[{"spineVertices", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"spineCoordsSnapshot", ",", 
          RowBox[{"firstVert", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "2"}], ",", 
          RowBox[{"j", "<=", 
           RowBox[{"Length", "@", 
            RowBox[{"spineVertices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"j", "++"}], ",", "\n", 
          RowBox[{
           RowBox[{"nextVert", "=", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"spineVertices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"spine", "[", 
                RowBox[{
                 RowBox[{"firstVert", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "__"}], "]"}]}], "]"}],
              "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"spineCoordsSnapshot", ",", 
             RowBox[{"nextVert", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\n", 
           RowBox[{"firstVert", "=", "nextVert"}], ";"}]}], "\n", "]"}], ";", 
        "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"spineAreas", ",", 
          RowBox[{"getPolygonArea", "[", "spineCoordsSnapshot", "]"}]}], 
         "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
     RowBox[{"data", "=", "spineAreas"}], ";", "\n", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sim", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"data", "*", 
           SuperscriptBox["10", "12"]}]}], "}"}], "]"}], ",", 
       RowBox[{"DataRange", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Max", "[", "data", "]"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Time (s)\>\"", ",", 
          " ", "\"\<Area (\\!\\(\\*SuperscriptBox[\\(\[Mu]m\\), \
\\(2\\)]\\))\>\""}], "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", "->", "title"}], ",", 
       RowBox[{"PlotRange", "->", "plotRange"}]}], "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"membraneAreaRawPlotter", "[", 
   RowBox[{"sim_", ",", 
    RowBox[{"title_", ":", "\"\<Membrane Area Over Time\>\""}], ",", 
    RowBox[{"plotRange_", ":", "Automatic"}], ",", 
    RowBox[{"export_", ":", "False"}]}], "]"}], ":=", "\n", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"spineObjects", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "===", "spineHeadArea"}], 
             "&"}]}], "]"}], "&"}], "/@", "sim"}], ")"}]}], ",", "spineAreas",
       ",", "data"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"spineAreas", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       "spineObjects"}]}], ";", "\n", 
     RowBox[{"data", "=", "spineAreas"}], ";", "\n", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sim", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", "data"}], "}"}], 
        "]"}], ",", 
       RowBox[{"DataRange", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Max", "[", "data", "]"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Time (s)\>\"", ",", 
          " ", "\"\<Area (\\!\\(\\*SuperscriptBox[\\(\[Mu]m\\), \
\\(2\\)]\\))\>\""}], "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", "->", "title"}], ",", 
       RowBox[{"PlotRange", "->", "plotRange"}]}], "]"}]}]}], "\n", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972955281634396*^9, 3.972955283974618*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"30a0669a-0640-424c-a831-10ef53fed855"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"membraneAreaRawPlotterSet", "[", 
    RowBox[{"directory_", ",", "globString_", ",", 
     RowBox[{"dt_", ":", "0.05"}], ",", 
     RowBox[{"title_", ":", "\"\<Averaged Membrane Area Over Time\>\""}], ",", 
     RowBox[{"plotRange_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "simList", ",", "start", ",", "t", ",", "mLists", ",", "bbox", ",", 
       "timePos", ",", "files", ",", "end", ",", "lastFrame", ",", "frames", ",",
        "simulationArray", ",", "frame", ",", "groupfiles", ",", "filegroups",
        ",", "fgi", ",", "maxTime", ",", "simSubList", ",", "xs", ",", "ys", ",",
        "maxis", ",", "simNumbers", ",", "i", ",", "j", ",", "sim", ",", 
       "dim"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"simList", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"groupfiles", "=", 
       RowBox[{"FileNames", "[", "directory", "]"}]}], ";", "\n", 
      RowBox[{"groupfiles", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"groupfiles", ",", 
         RowBox[{
          RowBox[{"DirectoryName", "[", "directory", "]"}], 
          "<>", "\"\<.DS_Store\>\""}]}], "]"}]}], ";", "\n", 
      RowBox[{"filegroups", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "@", "groupfiles"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"filegroups", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"groupfiles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</\>\"", "<>", "#", 
               "<>", "\"\<.wls\>\""}], "&"}], "/@", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"FileBaseName", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"FileNames", "[", 
                 RowBox[{
                  RowBox[{"groupfiles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
                  "globString"}], "]"}]}], ",", "processFileNames"}], "]"}]}],
             ")"}]}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"maxTime", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "&"}], "/@", 
         "filegroups"}], "]"}]}], ";", "\n", 
      RowBox[{"simList", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"progressbar", "=", 
       RowBox[{
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\<|\>\"", ",", "1"}], "]"}], "<>", 
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\< \>\"", ",", 
          RowBox[{
           RowBox[{"Length", "@", "filegroups"}], "-", "1"}]}], "]"}], 
        "<>", "\"\<|\>\""}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"Dynamic", "[", "progressbar", "]"}], "]"}], ";", "\n", 
      RowBox[{"simNumbers", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "filegroups"}], "]"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"fgi", "=", "1"}], ",", 
        RowBox[{"fgi", "<=", 
         RowBox[{"Length", "@", "filegroups"}]}], ",", 
        RowBox[{"fgi", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"files", "=", 
          RowBox[{"filegroups", "[", 
           RowBox[{"[", "fgi", "]"}], "]"}]}], ";", "\n", 
         RowBox[{"simulationArray", "=", 
          RowBox[{"{", "}"}]}], ";", "\n", 
         RowBox[{"t", "=", "0"}], ";", "\n", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<=", 
            RowBox[{"Length", "@", "files"}]}], ",", 
           RowBox[{"i", "+=", "1"}], ",", "\n", 
           RowBox[{
            RowBox[{"sim", "=", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{"files", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "<=", 
               RowBox[{"Length", "@", "sim"}]}], ",", 
              RowBox[{"j", "++"}], ",", "\n", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sim", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], ">=", "t"}], ",", 
                "\n", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"simulationArray", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"sim", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"spineHeadArea", "[", "_", "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"actinObjectRise", "^", "2"}], "*", 
                    RowBox[{"10", "^", "12"}]}]}], "]"}], ";", "\n", 
                 RowBox[{"t", "+=", "dt"}], ";"}]}], "\n", "]"}]}], "\n", 
             "]"}]}]}], "\n", "]"}], ";", "\n", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"simList", ",", "simulationArray"}], "]"}], ";", "\n", 
         RowBox[{"progressbar", "=", 
          RowBox[{
           RowBox[{"StringRepeat", "[", 
            RowBox[{"\"\<|\>\"", ",", "fgi"}], "]"}], "<>", 
           RowBox[{"StringRepeat", "[", 
            RowBox[{"\"\< \>\"", ",", 
             RowBox[{
              RowBox[{"Length", "@", "filegroups"}], "-", "fgi"}]}], "]"}], 
           "<>", "\"\<|\>\""}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                "]"}], "]"}], "*", "dt"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"simList", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", 
                 RowBox[{";;", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                   "]"}]}]}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                "]"}], "]"}], "*", "dt"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"simList", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{";;", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                    "]"}]}]}], "]"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"StandardDeviation", "[", 
                RowBox[{"simList", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                    "]"}]}]}], "]"}], "]"}], "]"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                  "]"}], "-", "1"}], "]"}]}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                "]"}], "]"}], "*", "dt"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"simList", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{";;", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                    "]"}]}]}], "]"}], "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"StandardDeviation", "[", 
                RowBox[{"simList", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                    "]"}]}]}], "]"}], "]"}], "]"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], "&"}], "/@", "simList"}], 
                  "]"}], "-", "1"}], "]"}]}]}]}], "}"}], "]"}]}], "}"}], ",", 
        
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", "simList", "]"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Time (s)\>\"", ",", 
           " ", "\"\<Area (\\!\\(\\*SuperscriptBox[\\(\[Mu]m\\), \\(2\\)]\\))\
\>\""}], "}"}]}], ",", " ", 
        RowBox[{"PlotLabel", "->", "title"}], ",", 
        RowBox[{"PlotRange", "->", "plotRange"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"{", "LightRed", "}"}], ",", 
           RowBox[{"{", "LightRed", "}"}]}], "}"}]}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[240]:=",ExpressionUUID->"53b8f9e1-32aa-4f53-b5bb-2f8006d6c46d"],

Cell["\<\
Some membrane energy and force terms  from Bonilla-Quintana et al. 2020:\
\>", "Text",ExpressionUUID->"a493a91d-add4-4c1c-b91c-d33a1c94e2ca"],

Cell["For the area term, we have that the areal energy \[CapitalOmega] \
equals", "Text",ExpressionUUID->"137c3e94-d848-4cb6-83ab-383969e7ae07"],

Cell["\<\
\[CapitalOmega]=1/2 \\!\\( 
\\*UnderoverscriptBox[\\(\[Sum]\\), \\(i = 1\\), \\(n\\)]\\( 
\\*SubsuperscriptBox[\\(x\\), \\(1\\), \\(i\\)]\\ 
\\*SubsuperscriptBox[\\(x\\), \\(2\\), \\(i + 1\\)]\\)\\)-\\!\\( 
\\*SubsuperscriptBox[\\(x\\), \\(2\\), \\(i\\)]\\ 
\\*SubsuperscriptBox[\\(x\\), \\(1\\), \\(i + 1\\)]\\)\
\>", "Text",ExpressionUUID->"e6f9f3b1-90b3-4bb3-8c97-c76de00f0f16"],

Cell["\<\
from vector cross products and find that the derivative of the areal energy \
equals\
\>", "Text",ExpressionUUID->"82c2c741-cb9a-4bda-9f88-f4f5f2ce6456"],

Cell["\<\
\[PartialD]\[CapitalOmega]/\[PartialD]\\!\\(\\*SubsuperscriptBox[\\(x\\), \
\\(1\\), \\(i\\)]\\)=1/2 (\\!\\( 
\\*SubsuperscriptBox[\\(x\\), \\(2\\), \\(i + 1\\)] - 
\\*SubsuperscriptBox[\\(x\\), \\(2\\), \\(i - 1\\)]\\)),\[PartialD]\
\[CapitalOmega]/\[PartialD]\\!\\(\\*SubsuperscriptBox[\\(x\\), \\(2\\), \
\\(i\\)]\\)=1/2 (-\\!\\(\\*SubsuperscriptBox[\\(x\\), \\(1\\), \\(i + \
1\\)]\\)+\\!\\(\\*SubsuperscriptBox[\\(x\\), \\(1\\), \\(i - 1\\)]\\)) .\
\>", "Text",ExpressionUUID->"bdc53652-abdf-4256-add3-9e27d26983dc"],

Cell["The surface energy term, S, derivative equals", "Text",ExpressionUUID->"a2273339-8bb1-44a0-9c5d-f670b97176cc"],

Cell["\<\
\[PartialD]S/\[PartialD]Subscript[x, 1,2]=(\\!\\( 
\\*SubsuperscriptBox[\\(x\\), \\(1, 2\\), \\(i\\)] - 
\\*SubsuperscriptBox[\\(x\\), \\(1, 2\\), \\(i - 1\\)]\\))/v^i+(\\!\\( 
\\*SubsuperscriptBox[\\(x\\), \\(1, 2\\), \\(i\\)] - 
\\*SubsuperscriptBox[\\(x\\), \\(1, 2\\), \\(i + 1\\)]\\))/v^(i+1),where \
variable v is distance between point and next point .\
\>", "Text",ExpressionUUID->"f7f39396-15f8-4fdf-a1b9-9d113e75ffc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"areaEnergyTerm", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], 
   RowBox[{"(", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p2", "-", "p1"}], ",", 
       RowBox[{"p3", "-", "p2"}]}], "}"}], "]"}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"areaDEnergyTerm", "[", 
    RowBox[{
     RowBox[{"p1_", "?", "VectorQ"}], ",", 
     RowBox[{"p2_", "?", "VectorQ"}], ",", 
     RowBox[{"p3_", "?", "VectorQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}], 
    RowBox[{"(", 
     RowBox[{"J", ".", 
      RowBox[{"(", 
       RowBox[{"p3", "+", "p1"}], ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfaceEnergyTerm", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"p1", "-", "p2"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"p3", "-", "p2"}], "]"}]}], ")"}]}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "between", " ", "two", " ", "neighboring", " ", 
    "vertices"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", "\n", 
   RowBox[{"Norm", "[", 
    RowBox[{"p2", "-", "p1"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Norm", "'"}], "[", "x_", "]"}], ":=", 
   RowBox[{"x", "/", 
    RowBox[{"Norm", "[", "x", "]"}]}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Helfrich", " ", "energy", " ", "computed", " ", "with", " ", "the", " ", 
    "neighboring", " ", "points", " ", "onto", " ", "the", " ", "point", " ", 
    "itself"}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Some", " ", "terms", " ", "to", " ", "compute", " ", "Helfrich", " ", 
    "energy"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", "\n", 
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p2", "-", "p1"}], ")"}], "/", 
       RowBox[{"v", "[", 
        RowBox[{"p2", ",", "p1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p3", "-", "p2"}], ")"}], "/", 
       RowBox[{"v", "[", 
        RowBox[{"p3", ",", "p2"}], "]"}]}]}], ")"}], "]"}], "^", "2"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], "+", 
      RowBox[{"v", "[", 
       RowBox[{"p2", ",", "p3"}], "]"}]}], ")"}], "/", "2"}]}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"Curvature", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"g", "[", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "]"}], "/", 
    RowBox[{"z", "[", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}]}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Helfrich", " ", "energy", " ", "computed", " ", "with", " ", "the", " ", 
    "neighboring", " ", "points", " ", "onto", " ", "the", " ", "point", " ", 
    "itself"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"HelfrichEnergy", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", 
      RowBox[{"Curvature", "[", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ")"}], "^", "2"}], "*", 
   
   RowBox[{"z", "[", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972992164457999*^9, 3.972992186233794*^9}, {
   3.9729930552763033`*^9, 3.972993079700569*^9}, 3.972993217420898*^9, {
   3.972993297231267*^9, 3.97299329816155*^9}, {3.972993446041048*^9, 
   3.972993446182687*^9}, {3.972993710625782*^9, 3.972993734006446*^9}, {
   3.972993771110092*^9, 3.9729938091927977`*^9}, {3.972993861512641*^9, 
   3.972993861929304*^9}, {3.972994973296988*^9, 3.9729949751970167`*^9}, {
   3.972995019389824*^9, 3.972995027634966*^9}, {3.972996260857643*^9, 
   3.9729962611452503`*^9}, {3.9729980346720753`*^9, 3.972998045945262*^9}, {
   3.972998091050695*^9, 3.972998113197042*^9}, {3.972998151588241*^9, 
   3.972998151766058*^9}, {3.972998722432866*^9, 3.972998722579082*^9}, {
   3.974695600538416*^9, 3.9746957864421864`*^9}, {3.9746960267092323`*^9, 
   3.974696044539565*^9}, {3.974696282948084*^9, 3.974696288870813*^9}, {
   3.9746963843144083`*^9, 3.974696412088064*^9}, {3.974696476393469*^9, 
   3.9746965468630323`*^9}, {3.974696587522234*^9, 3.974696594234767*^9}, {
   3.9746966372577*^9, 3.974696646787704*^9}, {3.974696712074916*^9, 
   3.9746967122442513`*^9}, 3.9746970435755157`*^9, {3.974721761878704*^9, 
   3.9747217946257153`*^9}, {3.974721952175495*^9, 3.97472198329493*^9}, {
   3.9747220842359962`*^9, 3.974722140544482*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"27a1a7d5-93a4-4715-bd7e-5abf3113b06b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"membraneForceExpr", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", "kappa", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HelfrichEnergy", "[", 
           RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "+", 
          RowBox[{"HelfrichEnergy", "[", 
           RowBox[{"p0", ",", "p1", ",", "p2"}], "]"}], "+", 
          RowBox[{"HelfrichEnergy", "[", 
           RowBox[{"p2", ",", "p3", ",", "p4"}], "]"}]}], ")"}]}], 
       ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"loadForceExpr", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox["\[PartialD]", "p2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "kappa", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"HelfrichEnergy", "[", 
          RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "+", 
         RowBox[{"HelfrichEnergy", "[", 
          RowBox[{"p0", ",", "p1", ",", "p2"}], "]"}], "+", 
         RowBox[{"HelfrichEnergy", "[", 
          RowBox[{"p2", ",", "p3", ",", "p4"}], "]"}]}], ")"}]}], ")"}]}]}]}],
   ";"}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.963668427070038*^9, 3.963668430807067*^9}, {
   3.963809415439639*^9, 3.963809415793356*^9}, {3.972991871826469*^9, 
   3.9729919472684383`*^9}, {3.972992024958653*^9, 3.972992032211545*^9}, {
   3.972992158366293*^9, 3.972992159247033*^9}, {3.972992348943849*^9, 
   3.972992352819586*^9}, 3.972992397518303*^9, {3.972992456935767*^9, 
   3.972992503474464*^9}, {3.972992707304923*^9, 3.9729927606217012`*^9}, 
   3.972993725794117*^9, {3.972998747573934*^9, 3.9729987639740334`*^9}, 
   3.972998852859952*^9, {3.974695893052478*^9, 3.9746959602510138`*^9}, {
   3.974696680227654*^9, 3.974696716825225*^9}, {3.974696804211442*^9, 
   3.974696809755292*^9}, {3.974696854247594*^9, 3.9746968551923313`*^9}, 
   3.974697094467978*^9, {3.974698320392518*^9, 3.974698330428768*^9}, 
   3.974698440516821*^9, {3.974783188947546*^9, 3.9747832088031483`*^9}, {
   3.9756109336058273`*^9, 3.975610952150181*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"55c81c2a-14fa-404b-ae6c-86f31be1ce09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compute", " ", "the", " ", "sum", " ", "of", " ", "the", " ", "three", " ",
     "force", " ", "terms", " ", "contributing", " ", "to", " ", "membrane", " ",
     "shape"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"membraneDelta", "[", 
     RowBox[{
     "p0In_", ",", "p1In_", ",", "p2In_", ",", "p3In_", ",", "p4In_"}], "]"}],
     ":=", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Zeta]In", "/", 
       RowBox[{"(", "membraneRate", ")"}]}], "*", 
      RowBox[{"(", "membraneForceExpr", ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p0", "->", "p0In"}], ",", 
       RowBox[{"p1", "->", "p1In"}], ",", 
       RowBox[{"p2", "->", "p2In"}], ",", 
       RowBox[{"p3", "->", "p3In"}], ",", 
       RowBox[{"p4", "->", "p4In"}]}], "}"}]}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"loadForce", "[", 
     RowBox[{
     "p0In_", ",", "p1In_", ",", "p2In_", ",", "p3In_", ",", "p4In_"}], "]"}],
     ":=", "\n", 
    RowBox[{
     RowBox[{"(", "loadForceExpr", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p0", "->", "p0In"}], ",", 
       RowBox[{"p1", "->", "p1In"}], ",", 
       RowBox[{"p2", "->", "p2In"}], ",", 
       RowBox[{"p3", "->", "p3In"}], ",", 
       RowBox[{"p4", "->", "p4In"}]}], "}"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.972937816870657*^9, {3.972937976225977*^9, 3.972938011646858*^9}, {
   3.9746969082685738`*^9, 3.974696934223043*^9}, {3.974696969893588*^9, 
   3.9746970105836697`*^9}, {3.974697176840581*^9, 3.9746971799195967`*^9}, {
   3.974697506083323*^9, 3.974697508890462*^9}, {3.974783214076252*^9, 
   3.974783246387064*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"4f89d259-20d7-469b-957c-59b95fe74e39"],

Cell["The Helfrich energy, defined as", "Text",ExpressionUUID->"9995a441-46c1-4e01-b3cd-634527c89b0f"],

Cell["\<\
||(dT/(d \\!\\(\\*OverscriptBox[\\(\[Omega]\\), \\(_\\)]\\)))||,where \
\\!\\(\\*OverscriptBox[\\(\[Omega]\\), \\(_\\)]\\)is arc length,\
\>", "Text",ExpressionUUID->"e4933478-9ecd-4b1b-9b44-135c6c79cb7d"],

Cell["\<\
takes all points starting from two points preceding the point of interest and \
ending at two points after it . The form of the energy shows below where p0 \
is the starting point, p4 the ending point, and p2 the point of interest .\
\>", "Text",ExpressionUUID->"01dcefdd-935c-4ef8-b855-d299bf12be6b"],

Cell["\<\
The following two functions get the intersection point of two lines given a, \
b corresponding to point 1 and c, d corresponding to point 2\
\>", "Text",ExpressionUUID->"7d919b2a-f384-4c01-a0d2-e342f8396663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineIntersectionPoint", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3_", ",", "y3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x4_", ",", "y4_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "r", ",", "q", ",", "s", ",", "denom", ",", "t"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "define", " ", "origin", " ", "and", " ", "direction", " ", "vectors"}], 
     "*)"}], 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1"}], "}"}]}], ";", "\n", 
     RowBox[{"r", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"direction", " ", "of", " ", "line", " ", "1"}], "*)"}], 
     RowBox[{"q", "=", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "y3"}], "}"}]}], ";", "\n", 
     RowBox[{"s", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x4", "-", "x3"}], ",", 
        RowBox[{"y4", "-", "y3"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"direction", " ", "of", " ", "line", " ", "2"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"2", "D", " ", 
       RowBox[{"\[OpenCurlyDoubleQuote]", 
        RowBox[{"cross", " ", "product"}], "\[CloseCurlyDoubleQuote]"}], " ", 
       "scalar"}], "*)"}], 
     RowBox[{"denom", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", 
        RowBox[{"s", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", 
        RowBox[{"s", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"denom", "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "lines", " ", "are", " ", "parallel", " ", "or", " ", "colinear"}], 
        "*)"}], "Null", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "parameter", " ", "for", " ", "intersection", " ", "along", " ", 
          "p"}], "+", 
         RowBox[{"t", " ", "r"}]}], "*)"}], 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"s", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"s", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "/", "denom"}]}], ";",
         "\n", 
        RowBox[{"p", "+", 
         RowBox[{"t", " ", "r"}]}]}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[255]:=",ExpressionUUID->"dcdbcd0c-c04c-4f12-8344-25769378b21f"],

Cell["\<\
Intersection functions in the cell below function to check whether a rotation \
of an actin attached to the membrane detaches. If it stays attached, a new \
intersection point calculates as a function of extending the actin rod and of \
membrane forces.\
\>", "Text",ExpressionUUID->"06785914-cc15-4c97-88e7-9a95e923dda1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaFuncWF", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rix_", ",", "riy_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"rjx_", ",", "rjy_"}], "}"}], ",", "rules_", ",", "L_"}], "]"}], 
  ":=", "\n", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Zeta]In"}], "/", "membraneRate"}], ")"}], " ", 
   RowBox[{"gradP2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rix", ",", "riy"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"rjx", ",", "rjy"}], "}"}], ",", "rules", ",", 
     RowBox[{"d0", "/.", "rules"}], ",", 
     RowBox[{"\[Epsilon]", "/.", "rules"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.972938025532627*^9, 3.9729380289753447`*^9}, 
   3.972942404501561*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"bf5e3dc2-17af-46b4-a836-994a1b1182b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lineIntersectionWithNeighboringSpinesQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1p_", ",", "s2p_", ",", "s3p_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aP_", ",", "a_"}], "}"}], ",", "ang_"}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"a", "-", "aP"}], "]"}]}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intersectingLinesQ", "[", 
        RowBox[{"s1p", ",", "s2p", ",", "aP", ",", "a"}], "]"}], ")"}], "||", 
      "\n", 
      RowBox[{"(", 
       RowBox[{"intersectingLinesQ", "[", 
        RowBox[{"s2p", ",", "s3p", ",", "aP", ",", "a"}], "]"}], ")"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[257]:=",ExpressionUUID->"3f96141f-b548-4512-bb06-8cbf702095cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lineIntersectionWithNeighboringSpinesPrev", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s0p_", ",", "s1p_", ",", "s2p_", ",", "s3p_", ",", "s4p_"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aP_", ",", "a_"}], "}"}], ",", "ang_"}], "]"}], ":=", "\n", 
   RowBox[{"lineIntersectionPoint", "[", 
    RowBox[{"s1p", ",", "s2p", ",", "aP", ",", "a"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lineIntersectionWithNeighboringSpinesNext", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s0p_", ",", "s1p_", ",", "s2p_", ",", "s3p_", ",", "s4p_"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aP_", ",", "a_"}], "}"}], ",", "ang_"}], "]"}], ":=", "\n", 
    RowBox[{"lineIntersectionPoint", "[", 
     RowBox[{"s2p", ",", "s3p", ",", "aP", ",", "a"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eucDistVector", "[", 
     RowBox[{"v1_", ",", "v2_"}], "]"}], ":=", "\n", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v1", "-", "v2"}], ")"}], "^", "2"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaArea5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c0x_", ",", "c0y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1x_", ",", "c1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2x_", ",", "c2y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3x_", ",", "c3y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4x_", ",", "c4y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc2x_", ",", "newc2y_"}], "}"}]}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A1", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2x", ",", "c2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c4x", ",", "c4y"}], "}"}]}], "}"}], "]"}]}], ",", 
       RowBox[{"A2", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc2x", ",", "newc2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c4x", ",", "c4y"}], "}"}]}], "}"}], "]"}]}]}], "}"}], ",",
      "\n", 
     RowBox[{"A2", "-", "A1"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaArea4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c0x_", ",", "c0y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1x_", ",", "c1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2x_", ",", "c2y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3x_", ",", "c3y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc1x_", ",", "newc1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc2x_", ",", "newc2y_"}], "}"}]}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A1", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2x", ",", "c2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}]}], "}"}], "]"}]}], ",", 
       RowBox[{"A2", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc1x", ",", "newc1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc2x", ",", "newc2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}]}], "}"}], "]"}]}]}], "}"}], ",",
      "\n", 
     RowBox[{"A2", "-", "A1"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaArea3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c0x_", ",", "c0y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1x_", ",", "c1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2x_", ",", "c2y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc1x_", ",", "newc1y_"}], "}"}]}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A1", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2x", ",", "c2y"}], "}"}]}], "}"}], "]"}]}], ",", 
       RowBox[{"A2", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc1x", ",", "newc1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2x", ",", "c2y"}], "}"}]}], "}"}], "]"}]}]}], "}"}], ",",
      "\n", 
     RowBox[{"A2", "-", "A1"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaAttArea", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c1x_", ",", "c1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3x_", ",", "c3y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc2x_", ",", "newc2y_"}], "}"}]}], "]"}], ":=", "\n", 
   RowBox[{"getPolygonArea", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"newc2x", ",", "newc2y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c3x", ",", "c3y"}], "}"}]}], "}"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaAreaIntMovement", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c0x_", ",", "c0y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1x_", ",", "c1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2x_", ",", "c2y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3x_", ",", "c3y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc1x_", ",", "newc1y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newc2x_", ",", "newc2y_"}], "}"}]}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A1", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1x", ",", "c1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2x", ",", "c2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}]}], "}"}], "]"}]}], ",", 
       RowBox[{"A2", "=", 
        RowBox[{"getPolygonArea", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c0x", ",", "c0y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc1x", ",", "newc1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"newc2x", ",", "newc2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c3x", ",", "c3y"}], "}"}]}], "}"}], "]"}]}]}], "}"}], ",",
      "\n", 
     RowBox[{"A2", "-", "A1"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"pointLineDistance", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ax_", ",", "Ay_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Bx_", ",", "By_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Cx_", ",", "Cy_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dx_", ",", "dy_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "A", ",", "B", ",", "C", ",", "dir", ",", "AB", ",", "t", ",", 
       "tClamped", ",", "D", ",", "displacement", ",", "distance"}], "}"}], ",", 
     RowBox[{
      RowBox[{"A", "=", 
       RowBox[{"{", 
        RowBox[{"Ax", ",", "Ay"}], "}"}]}], ";", "\n", 
      RowBox[{"B", "=", 
       RowBox[{"{", 
        RowBox[{"Bx", ",", "By"}], "}"}]}], ";", "\n", 
      RowBox[{"C", "=", 
       RowBox[{"{", 
        RowBox[{"Cx", ",", "Cy"}], "}"}]}], ";", "\n", 
      RowBox[{"dir", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"dx", ",", "dy"}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Ensure", " ", "direction", " ", "is", " ", "unit", " ", "vector"}], 
       "*)"}], 
      RowBox[{"AB", "=", 
       RowBox[{"B", "-", "A"}]}], ";", "\n", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"C", "-", "A"}], ",", "AB"}], "]"}], "/", 
        RowBox[{"Dot", "[", 
         RowBox[{"AB", ",", "AB"}], "]"}]}]}], ";", "\n", 
      RowBox[{"tClamped", "=", 
       RowBox[{"Clip", "[", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Clamp", " ", "t", " ", 
        RowBox[{"to", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}], "*)"}], 
      RowBox[{"D", "=", 
       RowBox[{"A", "+", 
        RowBox[{"tClamped", " ", "AB"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Closest", " ", "point", " ", "ON", " ", "SEGMENT"}], "*)"}], 
      RowBox[{"displacement", "=", 
       RowBox[{"D", "-", "C"}]}], ";", "\n", 
      RowBox[{"distance", "=", 
       RowBox[{"displacement", " ", ".", " ", "dir"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Signed", " ", "distance", " ", "in", " ", "given", " ", "direction"}],
        "*)"}], 
      RowBox[{"Abs", "@", "distance"}]}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PointInInfiniteWidthRectangleQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"px_", ",", "py_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "p", ",", "ab", ",", "ap", ",", "abLength", ",", 
       "abUnit", ",", "projLength"}], "}"}], ",", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}]}], ";", "\n", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}]}], ";", "\n", 
      RowBox[{"p", "=", 
       RowBox[{"{", 
        RowBox[{"px", ",", "py"}], "}"}]}], ";", "\n", 
      RowBox[{"ab", "=", 
       RowBox[{"b", "-", "a"}]}], ";", "\n", 
      RowBox[{"abLength", "=", 
       RowBox[{"Norm", "[", "ab", "]"}]}], ";", "\n", 
      RowBox[{"abUnit", "=", 
       RowBox[{"ab", "/", "abLength"}]}], ";", "\n", 
      RowBox[{"ap", "=", 
       RowBox[{"p", "-", "a"}]}], ";", "\n", 
      RowBox[{"projLength", "=", 
       RowBox[{"ap", " ", ".", " ", "abUnit"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "if", " ", "projection", " ", "lies", " ", "within", " ",
         "segment"}], "*)"}], 
      RowBox[{"0", "<=", "projLength", "<=", "abLength"}]}]}], "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CounterClockwiseQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "det", "}"}], ",", 
     RowBox[{
      RowBox[{"det", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"y3", "-", "y1"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y2", "-", "y1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"x3", "-", "x1"}], ")"}]}]}]}], ";", "\n", 
      RowBox[{"det", ">", "0"}]}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"changeGridMatch", "[", 
   RowBox[{"originalGridID_", ",", "newCoords_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"hostGridSpot", "[", "newCoords", "]"}], "===", 
       "originalGridID"}], ",", "1.", ",", "nullPointer"}], "]"}]}], 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.9644666646815*^9, 3.96446678503164*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"0dfeb787-2396-46a8-9352-30b40b9eb7a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rulesSpineBRPoly", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Elongate", " ", "Actin", " ", "Filament", " ", "Ends", " ", 
       "According", " ", "to", " ", "Brownian", " ", "Ratchet"}], "*)"}], 
     "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID1", ",", "coords1", ",", "spineIDNext"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineIDNext", ",", "coords2", ",", "centralID3"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s3", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "centralID5"}], "]"}]}],
          ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}]}], "\n", "}"}], "->", 
       RowBox[{"{", "\n", 
        RowBox[{"s1", ",", "s2", ",", "s3", ",", "s0", ",", "s4", ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"distNext", "+", 
              RowBox[{
               RowBox[{"actinMonomerRise", "/", "membraneRate"}], " ", 
               RowBox[{"(", 
                RowBox[{"kPlusBarbedT", " ", "numActin"}], ")"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2.2"}], "*", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "9"}]}], " ", 
                   RowBox[{"loadForce", "[", 
                    RowBox[{
                    "coords0", ",", "coords1", ",", "coords2", ",", "coords3",
                     ",", "coords4"}], "]"}]}], ")"}], "/", "kBT"}], 
                "]"}]}]}], ",", "overgrowthL"}], "]"}]}], "]"}]}], "\n", 
        "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"distNext", "<=", "overgrowthL"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID1", ",", "coords1", ",", "spineIDNext"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineIDNext", ",", "coords2", ",", "centralID3"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s3", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "centralID5"}], 
           "]"}]}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "s2", ",", "s3", ",", "s0", ",", "s4", ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"dist", "+", 
              RowBox[{
               RowBox[{"actinMonomerRise", "/", "membraneRate"}], " ", 
               RowBox[{"(", 
                RowBox[{"kPlusPointedT", " ", "numActin"}], ")"}], " ", 
               "numActin", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2.2"}], "*", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "9"}]}], " ", 
                   RowBox[{"loadForce", "[", 
                    RowBox[{
                    "coords0", ",", "coords1", ",", "coords2", ",", "coords3",
                     ",", "coords4"}], "]"}]}], ")"}], "/", "kBT"}], 
                "]"}]}]}], ",", "overgrowthL"}], "]"}]}], "]"}]}], "\n", 
        "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"dist", "<=", "overgrowthL"}], "]"}]}], "]"}]}], "}"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndMerge", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Merge", " ", "attachments", " ", "created", " ", "with", " ", "small", 
       " ", "distance", " ", "to", " ", "membrane"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"aN", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "nucleotideNext"}], "]"}]}], ",", 
         RowBox[{"actinATPCount", "[", "numATPActin", "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numADPActin", "]"}], ",", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNextNext", ",", "nucleotide", ",", 
           "spineID", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"dist", "+", "actinObjectRise"}], ",", "overgrowthL"}], 
            "]"}]}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numATPActin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{"nucleotideNext", "==", "ATP"}], "]"}]}]}], "]"}], ",", 
         "\n", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numADPActin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "ADP"}], "||", 
              RowBox[{"nucleotideNext", "==", "ADPPlusPi"}], "||", 
              RowBox[{"nucleotideNext", "==", "cofilin"}]}], "]"}]}]}], "]"}],
          ",", "\n", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{"nucleotideNext", "==", "cofilin"}], "]"}]}]}], "]"}]}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"coords", "-", "coordsNext"}], "]"}], "<", 
           RowBox[{"(", 
            RowBox[{"overgrowthL", "-", "actinObjectRise"}], ")"}]}], "&&", 
          RowBox[{"spineID", "!=", "nullPointer"}]}], "]"}]}], "]"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNextNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",",
            "spineIDNextNext", ",", "distNextNext"}], "]"}], ",", 
         RowBox[{"actinATPCount", "[", "numATPActin", "]"}], ",", 
         RowBox[{"actinADPCount", "[", "numADPActin", "]"}], ",", 
         RowBox[{"cofilinCount", "[", "numCofilin", "]"}]}], "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNextNext", ",", "nucleotideNextNext", ",", 
           "spineIDNextNext", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"distNextNext", "+", "actinObjectRise"}], ",", 
             "overgrowthL"}], "]"}]}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numATPActin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{"nucleotideNext", "==", "ATP"}], "]"}]}]}], "]"}], ",", 
         "\n", 
         RowBox[{"actinADPCount", "[", 
          RowBox[{"numADPActin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{"nucleotideNext", "==", "ADP"}], "||", 
              RowBox[{"nucleotideNext", "==", "ADPPlusPi"}], "||", 
              RowBox[{"nucleotideNext", "==", "cofilin"}]}], "]"}]}]}], "]"}],
          ",", "\n", 
         RowBox[{"cofilinCount", "[", 
          RowBox[{"numCofilin", "+", 
           RowBox[{"nCG", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{"nucleotideNext", "==", "cofilin"}], "]"}]}]}], "]"}]}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"coordsNext", "-", "coordsNextNext"}], "]"}], "<", 
           RowBox[{"(", 
            RowBox[{"overgrowthL", "-", "actinObjectRise"}], ")"}]}], "&&", 
          RowBox[{"spineIDNextNext", "!=", "nullPointer"}]}], "]"}]}], 
       "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesMemForce", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{"Apply", " ", "Membrane", " ", "Force"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID1", ",", "coords1", ",", "spineIDNext"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineIDNext", ",", "coords2", ",", "centralID3"}], 
           "]"}]}], ",", "\n", 
         RowBox[{"s3", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "centralID5"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s1", ",", "s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"spineIDNext", ",", 
           RowBox[{
            RowBox[{"membraneDelta", "[", 
             RowBox[{
             "coords0", ",", "coords1", ",", "coords2", ",", "coords3", ",", 
              "coords4"}], "]"}], "+", "coords2"}], ",", "centralID3"}], 
          "]"}], "\n", ",", "s3", ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea3", "[", 
            RowBox[{"coords1", ",", "coords2", ",", "coords3", ",", 
             RowBox[{
              RowBox[{"membraneDelta", "[", 
               RowBox[{
               "coords0", ",", "coords1", ",", "coords2", ",", "coords3", ",",
                 "coords4"}], "]"}], "+", "coords2"}]}], "]"}]}], "]"}]}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Rule", " ", "for", " ", "applying", " ", "working", " ", "force", " ",
         "onto", " ", "a", " ", "membrane", " ", "vertex", " ", "and", " ", 
        "attached", " ", "actin", " ", "object"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}], ",",
          "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}], ",",
          "\n", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "adjID4b"}], "]"}]}], ",",
          "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "centralID1", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"aN", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
             "nucleotideNext"}], "]"}]}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"aN", ",", "s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords1"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coordsNext", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID3"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords3", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords3"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coordsNext", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID4"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea4", "[", 
            RowBox[{
            "coords0", ",", "coords1", ",", "coords3", ",", "coords4", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords1", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords1"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coordsNext", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"dist", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords3", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords3"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coordsNext", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"dist", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}]}], "]"}]}], "]"}], ",", "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{"ID", ",", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
            "coords1", ",", "coords3", ",", "coords", ",", "coordsNext"}], 
            "]"}], ",", "IDNext", ",", "nucleotide", ",", "centralID1", ",", 
           "dist"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}], ",",
          "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}], ",",
          "\n", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "adjID4b"}], "]"}]}], ",",
          "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "centralID1", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"aN", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDABP", ",", 
            "angleNext", ",", "angleABP", ",", "nucleotideNext"}], "]"}]}], ",",
          "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"aN", ",", "s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords1"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coordsNext", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID3"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords3", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords3"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coordsNext", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"dist", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID4"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea4", "[", 
            RowBox[{
            "coords0", ",", "coords1", ",", "coords3", ",", "coords4", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords1", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords1"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coordsNext", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"dist", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords3", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords", "-", "coords3"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coordsNext", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"dist", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}]}], "]"}]}], "]"}], ",", "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{"ID", ",", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
            "coords1", ",", "coords3", ",", "coords", ",", "coordsNext"}], 
            "]"}], ",", "IDNext", ",", "nucleotide", ",", "centralID1", ",", 
           "dist"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}], ",",
          "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}], ",",
          "\n", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "adjID4b"}], "]"}]}], ",",
          "\n", 
         RowBox[{"aP", "==", 
          RowBox[{"actin", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
            "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "centralID1", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID3"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords3", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID4"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea4", "[", 
            RowBox[{
            "coords0", ",", "coords1", ",", "coords3", ",", "coords4", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords1", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords3", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}]}], "]"}]}], "]"}], ",", "\n", "aP", ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
            "coords1", ",", "coords3", ",", "coords", ",", "coordsNext"}], 
            "]"}], ",", "nucleotideNext", ",", "centralID1", ",", " ", 
           "distNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}], ",",
          "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}], ",",
          "\n", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "adjID4b"}], "]"}]}], ",",
          "\n", 
         RowBox[{"aP", "==", 
          RowBox[{"actinJunc", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "IDABP", ",", "angle", ",",
             "angleABP", ",", "nucleotide"}], "]"}]}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "centralID1", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID3"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords3", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID4"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea4", "[", 
            RowBox[{
            "coords0", ",", "coords1", ",", "coords3", ",", "coords4", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords1", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords3", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}]}], "]"}]}], "]"}], ",", "\n", "aP", ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
            "coords1", ",", "coords3", ",", "coords", ",", "coordsNext"}], 
            "]"}], ",", "nucleotideNext", ",", "centralID1", ",", " ", 
           "distNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID0", ",", "coords0", ",", "centralID1"}], "]"}]}],
          ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}], ",",
          "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "centralID4"}], "]"}], ",",
          "\n", 
         RowBox[{"s4", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID4", ",", "coords4", ",", "adjID4b"}], "]"}]}], ",",
          "\n", 
         RowBox[{"aP", "==", 
          RowBox[{"ABP", "[", 
           RowBox[{
           "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}],
            "]"}]}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "centralID1", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", "area", "]"}]}], "\n", "}"}], "->", 
       "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s4", ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID3"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", 
           RowBox[{"addVectors", "[", 
            RowBox[{"coords3", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                 "0"}], "]"}], 
              RowBox[{"deltaFuncWF", "[", 
               RowBox[{"coords", ",", 
                RowBox[{"lineIntersectionPoint", "[", 
                 RowBox[{
                 "coords1", ",", "coords3", ",", "coords", ",", 
                  "coordsNext"}], "]"}], ",", " ", 
                RowBox[{"actinRule", "[", 
                 RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
            "]"}], ",", "centralID4"}], "]"}], ",", "\n", 
         RowBox[{"spineHeadArea", "[", 
          RowBox[{"area", "+", 
           RowBox[{"deltaArea4", "[", 
            RowBox[{
            "coords0", ",", "coords1", ",", "coords3", ",", "coords4", ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords1", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords1"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"addVectors", "[", 
              RowBox[{"coords3", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"coordsNext", "-", "coords3"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"coords1", "-", "coords3"}], "]"}]}]}], ")"}], ",",
                   "0"}], "]"}], 
                RowBox[{"deltaFuncWF", "[", 
                 RowBox[{"coords", ",", 
                  RowBox[{"lineIntersectionPoint", "[", 
                   RowBox[{
                   "coords1", ",", "coords3", ",", "coords", ",", 
                    "coordsNext"}], "]"}], ",", " ", 
                  RowBox[{"actinRule", "[", 
                   RowBox[{"distNext", ",", "True"}], "]"}], ",", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"coords", "-", "coordsNext"}], "]"}]}], "]"}]}]}], 
              "]"}]}], "]"}]}], "]"}], ",", "\n", "aP", ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{"IDNext", ",", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
            "coords1", ",", "coords3", ",", "coords", ",", "coordsNext"}], 
            "]"}], ",", "nucleotideNext", ",", "centralID1", ",", " ", 
           "distNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", "membraneRate", "]"}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesVertexCA", "=", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID1", ",", "coords1", ",", "centralID3"}], "]"}]}],
          ",", "\n", 
         RowBox[{"s3", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"centralID3", ",", "coords3", ",", "adjID3b"}], "]"}]}], ",", 
         RowBox[{"newID", "[", "id", "]"}]}], "}"}], "\n", "->", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"newID", "[", 
          RowBox[{"id", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID1", ",", "coords1", ",", "id"}], "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"id", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"coords1", "+", "coords3"}], ")"}], "/", "2"}], ",", 
           "centralID3", ",", 
           RowBox[{"hostGridSpot", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"coords1", "+", "coords3"}], ")"}], "/", "2"}], "]"}]}],
           "]"}], ",", "\n", 
         RowBox[{"spine", "[", 
          RowBox[{"centralID3", ",", "coords3", ",", "adjID3b"}], "]"}]}], 
        "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"coords1", "-", "coords3"}], "]"}], ">", "upperBound"}], 
         "]"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s0", "==", 
           RowBox[{"spine", "[", 
            RowBox[{
            "adjID1a", ",", "coords0", ",", "centralID1", ",", "grid0"}], 
            "]"}]}], ",", "\n", 
          RowBox[{"s1", "==", 
           RowBox[{"spine", "[", 
            RowBox[{
            "centralID1", ",", "coords1", ",", "centralID3", ",", "grid1"}], 
            "]"}]}], ",", "\n", 
          RowBox[{"s3", "==", 
           RowBox[{"spine", "[", 
            RowBox[{
            "centralID3", ",", "coords3", ",", "adjID3b", ",", "grid3"}], 
            "]"}]}]}], "}"}], "->", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"spine", "[", 
           RowBox[{
           "adjID1a", ",", "coords0", ",", "centralID3", ",", "grid0"}], 
           "]"}], ",", "\n", 
          RowBox[{"spine", "[", 
           RowBox[{
           "centralID3", ",", "coords3", ",", "adjID3b", ",", "grid3"}], 
           "]"}]}], "\n", "}"}]}], ",", "\n", 
       RowBox[{"with", "[", 
        RowBox[{"membraneRate", " ", 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"coords0", "-", "coords1"}], "]"}], "<", "lowerBound"}], 
           "||", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"coords1", "-", "coords3"}], "]"}], "<", 
            "lowerBound"}]}], "]"}]}], "]"}]}], "*)"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesEndInterp", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Rule", " ", "for", " ", "interpolating", " ", "actin", " ", "from", " ",
        "a", " ", "membrane", " ", "vertex", " ", "with", " ", "a", " ", 
       "barbed", " ", "actin"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"newID", "[", "NID", "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "NID", ",", "angle", ",", "nucleotide"}], 
          "]"}], ",", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"NID", ",", 
           RowBox[{
            RowBox[{"actinObjectRise", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coordsNext", "-", "coords"}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}], "+", 
            "coords"}], ",", "IDNext", ",", "0.0", ",", "ATP"}], "]"}], ",", 
         "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", 
           RowBox[{"overgrowthL", "-", "actinObjectRise"}]}], "]"}], ",", 
         "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"distNext", ">=", "overgrowthL"}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"coords", "-", "coordsNext"}], "]"}], ">=", 
          RowBox[{"1.25", "actinObjectRise"}]}], "&&", 
         RowBox[{"numActin", ">", "nCG"}]}], "]"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", "distNext"}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"newID", "[", "NID", "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"ABP", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "NID", ",", "angle", ",", "ABPRule"}], 
          "]"}], ",", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"NID", ",", 
           RowBox[{
            RowBox[{"actinObjectRise", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coordsNext", "-", "coords"}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}], "+", 
            "coords"}], ",", "IDNext", ",", "0.0", ",", "ATP"}], "]"}], ",", 
         "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", 
           "spineIDNext", ",", 
           RowBox[{"overgrowthL", "-", "actinObjectRise"}]}], "]"}], ",", 
         "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"distNext", ">=", "overgrowthL"}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"coords", "-", "coordsNext"}], "]"}], ">=", 
          RowBox[{"1.25", "actinObjectRise"}]}], "&&", 
         RowBox[{"numActin", ">", "nCG"}]}], "]"}], "]"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Rule", " ", "for", " ", "interpolating", " ", "actin", " ", "from", " ",
         "a", " ", "membrane", " ", "vertex", " ", "with", " ", "a", " ", 
        "pointed", " ", "actin"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"newID", "[", "NID", "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "NID", ",", "nucleotide", ",", "spineID", 
           ",", 
           RowBox[{"overgrowthL", "-", "actinObjectRise"}]}], "]"}], ",", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"NID", ",", 
           RowBox[{
            RowBox[{"actinObjectRise", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords", "-", "coordsNext"}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}], "+", 
            "coordsNext"}], ",", "IDNext", ",", "0.0", ",", "ATP"}], "]"}], ",",
          "\n", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}], ",", "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"dist", ">=", "overgrowthL"}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"coords", "-", "coordsNext"}], "]"}], ">=", 
          RowBox[{"1.25", "actinObjectRise"}]}], "&&", 
         RowBox[{"numActin", ">", "nCG"}]}], "]"}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID", ",", "dist"}], "]"}], ",", "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDABP", ",", 
           "angleNext", ",", "angleABP", ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"actinATPCount", "[", "numActin", "]"}], ",", "\n", 
         RowBox[{"newID", "[", "NID", "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "NID", ",", "nucleotide", ",", "spineID", 
           ",", 
           RowBox[{"overgrowthL", "-", "actinObjectRise"}]}], "]"}], ",", 
         RowBox[{"newID", "[", 
          RowBox[{"NID", "+", "1"}], "]"}], ",", "\n", 
         RowBox[{"actin", "[", 
          RowBox[{"NID", ",", 
           RowBox[{
            RowBox[{"actinObjectRise", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coords", "-", "coordsNext"}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]}]}], "+", 
            "coordsNext"}], ",", "IDNext", ",", "0.0", ",", "ATP"}], "]"}], ",",
          "\n", 
         RowBox[{"actinJunc", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "IDABP", ",", 
           "angleNext", ",", "angleABP", ",", "nucleotideNext"}], "]"}], ",", 
         "\n", 
         RowBox[{"actinATPCount", "[", 
          RowBox[{"numActin", "-", "nCG"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"dist", ">=", "overgrowthL"}], "&&", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"coords", "-", "coordsNext"}], "]"}], ">", 
          RowBox[{"1.25", "actinObjectRise"}]}], "&&", 
         RowBox[{"numActin", ">", "nCG"}]}], "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesReconnect", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Checking", " ", "cross"}], "-", 
       RowBox[{"over", " ", "between", " ", "membrane", " ", "edges"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID0", ",", "coords0", ",", "spineID1"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID1", ",", "coords1", ",", "spineID2"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID2", ",", "coords2", ",", "spineID3"}], "]"}]}], ",",
          "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", "spineID0",
            ",", "distNext"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s1", ",", "s2", ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", "spineID1",
            ",", "distNext"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"intersectingLinesQ", "[", 
          RowBox[{"coords1", ",", "coords2", ",", "coords", ",", 
           RowBox[{
            RowBox[{"overgrowthL", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"coordsNext", "-", "coords"}], ")"}], 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]]}], "+", 
            "coords"}]}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID0", ",", "coords0", ",", "spineID1"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID1", ",", "coords1", ",", "spineID2"}], "]"}]}], ",",
          "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", "spineID1",
            ",", "distNext"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s1", ",", "\n", 
         RowBox[{"barbedEnd", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "nucleotideNext", ",", "spineID0",
            ",", "distNext"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "angle", ",", 
           "nucleotide"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"intersectingLinesQ", "[", 
          RowBox[{"coords0", ",", "coords1", ",", "coords", ",", 
           RowBox[{
            RowBox[{"overgrowthL", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"coordsNext", "-", "coords"}], ")"}], 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]]}], "+", 
            "coords"}]}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID0", ",", "coords0", ",", "spineID1"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID1", ",", "coords1", ",", "spineID2"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s2", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID2", ",", "coords2", ",", "spineID3"}], "]"}]}], ",",
          "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID0", ",", "dist"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s1", ",", "s2", ",", "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID1", ",", "dist"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"intersectingLinesQ", "[", 
          RowBox[{"coords1", ",", "coords2", ",", "coordsNext", ",", 
           RowBox[{
            RowBox[{"overgrowthL", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"coords", "-", "coordsNext"}], ")"}], 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]]}], "+", 
            "coordsNext"}]}], "]"}], "]"}]}], "]"}], ",", "\n", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"s0", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID0", ",", "coords0", ",", "spineID1"}], "]"}]}], ",",
          "\n", 
         RowBox[{"s1", "==", 
          RowBox[{"spine", "[", 
           RowBox[{"spineID1", ",", "coords1", ",", "spineID2"}], "]"}]}], ",",
          "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID1", ",", "dist"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "\n", "}"}], "->", "\n", 
       RowBox[{"{", "\n", 
        RowBox[{"s0", ",", "s1", ",", "\n", 
         RowBox[{"pointedEnd", "[", 
          RowBox[{
          "ID", ",", "coords", ",", "IDNext", ",", "nucleotide", ",", 
           "spineID0", ",", "dist"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"actin", "[", 
          RowBox[{
          "IDNext", ",", "coordsNext", ",", "IDNextNext", ",", "angleNext", ",",
            "nucleotideNext"}], "]"}]}], "\n", "}"}]}], ",", "\n", 
      RowBox[{"with", "[", 
       RowBox[{"membraneRate", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{"intersectingLinesQ", "[", 
          RowBox[{"coords0", ",", "coords1", ",", "coordsNext", ",", 
           RowBox[{
            RowBox[{"overgrowthL", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"coords", "-", "coordsNext"}], ")"}], 
              RowBox[{"Norm", "[", 
               RowBox[{"coordsNext", "-", "coords"}], "]"}]]}], "+", 
            "coordsNext"}]}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"rulesSpine", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rulesSpineBRPoly", ",", "rulesEndMerge", ",", "rulesMemForce", ",", 
     "rulesVertexCA", ",", "rulesEndInterp", ",", "rulesReconnect"}], "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.963733369230034*^9, 3.963733385816728*^9}, {
   3.963733494928286*^9, 3.963733551886937*^9}, {3.9638105249022837`*^9, 
   3.963810537507722*^9}, {3.964137047637858*^9, 3.964137054520459*^9}, {
   3.964464995918182*^9, 3.964465001757389*^9}, {3.9644656197662992`*^9, 
   3.9644656358792753`*^9}, {3.9644657491658907`*^9, 
   3.9644657932056017`*^9}, {3.9644658288345623`*^9, 3.964466192318421*^9}, {
   3.964466254133461*^9, 3.964466356596596*^9}, 3.964466457275028*^9, {
   3.964466547728863*^9, 3.964466610124928*^9}, {3.964466640183416*^9, 
   3.964466647991341*^9}, {3.964466796914215*^9, 3.964466804021185*^9}, {
   3.9644669793531227`*^9, 3.964467034746203*^9}, {3.964467081354927*^9, 
   3.9644672175561247`*^9}, {3.964467260800952*^9, 3.964467287646872*^9}, {
   3.964467479907703*^9, 3.9644674810832577`*^9}, {3.964468853912019*^9, 
   3.964468886997615*^9}, {3.964469267497265*^9, 3.964469297883711*^9}, {
   3.9644693406261177`*^9, 3.964469352731182*^9}, 3.964470271046649*^9, {
   3.96447082756308*^9, 3.964470871558313*^9}, {3.964471386002942*^9, 
   3.964471400103684*^9}, {3.964471434019289*^9, 3.9644714361576138`*^9}, 
   3.96447221751231*^9, {3.9644746564597683`*^9, 3.964474679563628*^9}, {
   3.9644763870678387`*^9, 3.964476434244676*^9}, {3.964476497779913*^9, 
   3.964476660200192*^9}, {3.9644767621411657`*^9, 3.9644767870999823`*^9}, {
   3.964476921590804*^9, 3.964476922491518*^9}, {3.964498081514629*^9, 
   3.964498102961523*^9}, {3.964501917438664*^9, 3.9645019407613707`*^9}, {
   3.964501977107134*^9, 3.964501990573936*^9}, {3.964502719465107*^9, 
   3.964502756600954*^9}, {3.964502810193317*^9, 3.9645029722794333`*^9}, {
   3.9645030095350437`*^9, 3.96450302142935*^9}, {3.9645033607164*^9, 
   3.964503366282065*^9}, {3.9645599697826138`*^9, 3.9645599872389803`*^9}, {
   3.9645646369731827`*^9, 3.964564649051135*^9}, {3.9646101169399023`*^9, 
   3.964610117290926*^9}, {3.964890500056727*^9, 3.964890550534129*^9}, {
   3.964890634066908*^9, 3.964890674086985*^9}, {3.964890708962862*^9, 
   3.9648907094949493`*^9}, {3.964890790925603*^9, 3.964890865905074*^9}, {
   3.96489389825882*^9, 3.964893899246172*^9}, {3.964970391078141*^9, 
   3.9649703911509657`*^9}, {3.964994158446856*^9, 3.9649941620405703`*^9}, {
   3.964994928885998*^9, 3.964994992282449*^9}, {3.964995053324791*^9, 
   3.964995097891706*^9}, {3.96499524656712*^9, 3.9649952852559633`*^9}, {
   3.9649953513581657`*^9, 3.9649953568679943`*^9}, 3.9650539801750383`*^9, {
   3.9650540862772408`*^9, 3.96505411529278*^9}, {3.965054156424078*^9, 
   3.965054220962042*^9}, {3.9650542599758244`*^9, 3.965054333304673*^9}, {
   3.965054398117296*^9, 3.965054408772037*^9}, {3.9650550055408983`*^9, 
   3.965055008435629*^9}, {3.965382535958671*^9, 3.965382546056678*^9}, {
   3.965383013892666*^9, 3.965383032033943*^9}, {3.965383633330741*^9, 
   3.965383634064548*^9}, {3.965383713081851*^9, 3.965383823384989*^9}, {
   3.9653841460831423`*^9, 3.965384227288175*^9}, {3.965385021336931*^9, 
   3.965385048974238*^9}, {3.965385404937299*^9, 3.965385405566064*^9}, {
   3.965385448695619*^9, 3.965385449229039*^9}, {3.965385497390039*^9, 
   3.965385524789979*^9}, 3.965386379779303*^9, 3.965386410573201*^9, {
   3.965386689395857*^9, 3.965386701703368*^9}, {3.965386838721382*^9, 
   3.9653868451640453`*^9}, {3.965386876178341*^9, 3.965386896442265*^9}, {
   3.965387029896962*^9, 3.965387080541396*^9}, {3.965387179744238*^9, 
   3.965387221893046*^9}, {3.965389886090308*^9, 3.965389886734812*^9}, {
   3.9653899227874413`*^9, 3.965389932665505*^9}, {3.96539011213717*^9, 
   3.965390123967115*^9}, {3.96539023042766*^9, 3.9653902618157578`*^9}, {
   3.965492112733038*^9, 3.965492134552994*^9}, {3.965576340309947*^9, 
   3.965576345905052*^9}, {3.965829698891819*^9, 3.965829723963262*^9}, {
   3.966105472037465*^9, 3.966105634363768*^9}, {3.966105688063653*^9, 
   3.966105885110714*^9}, {3.966105924881012*^9, 3.966105927193831*^9}, {
   3.966105992416008*^9, 3.966105992590795*^9}, {3.9661063697212763`*^9, 
   3.966106384437361*^9}, {3.9661064433369093`*^9, 3.966106471358388*^9}, {
   3.96610652351334*^9, 3.966106525747995*^9}, {3.9661065697636957`*^9, 
   3.966106575804953*^9}, {3.966106632536591*^9, 3.966106676542341*^9}, {
   3.966106719069993*^9, 3.966106840648631*^9}, {3.968432003956132*^9, 
   3.9684322937105494`*^9}, {3.9698131431930113`*^9, 3.969813143810379*^9}, {
   3.969813434972978*^9, 3.969813435160469*^9}, {3.970155068980711*^9, 
   3.970155075123631*^9}, {3.972095186725296*^9, 3.972095189931209*^9}, {
   3.972095731987096*^9, 3.972095739317519*^9}, {3.972372556852888*^9, 
   3.972372572821294*^9}, {3.972509709349415*^9, 3.9725097133882847`*^9}, {
   3.972510300749107*^9, 3.972510300889073*^9}, {3.9729371985440702`*^9, 
   3.9729372167055597`*^9}, {3.972937496690147*^9, 3.972937507428678*^9}, 
   3.972938944398755*^9, {3.9729585366058893`*^9, 3.972958539066709*^9}, {
   3.972980790982203*^9, 3.972980810618217*^9}, {3.973012274687971*^9, 
   3.973012279629615*^9}, {3.973040437655262*^9, 3.973040444523959*^9}, {
   3.9732245279558277`*^9, 3.973224529739081*^9}, {3.973879229507854*^9, 
   3.973879323995742*^9}, {3.973879356542624*^9, 3.973879389791409*^9}, {
   3.9738843658161182`*^9, 3.973884400955586*^9}, {3.9738845979207897`*^9, 
   3.9738846057831984`*^9}, {3.974697143003763*^9, 3.974697162345522*^9}, {
   3.9746972095260363`*^9, 3.974697213589313*^9}, {3.9747832583626823`*^9, 
   3.9747833496596603`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"182bcd33-f635-4dcb-af06-add62fd666c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reduced Test", "Subsection",ExpressionUUID->"37386b1d-a807-4637-8002-90e9b1466379"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelDo", "[", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"factor", "=", "10."}], ";", "\[IndentingNewLine]", 
     RowBox[{"power", "=", "1."}], ";", "\n", 
     RowBox[{"meshSize", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"spineHeadRadius", "/", "meshSpacing"}]}], "]"}]}], ";", "\n", 
     RowBox[{"spineCoords", "=", 
      RowBox[{"generateSpinePoints", "[", 
       RowBox[{"meshSize", ",", "spineHeadRadius"}], "]"}]}], ";", "\n", 
     RowBox[{"parameter", "=", "NOR"}], ";", "\n", 
     RowBox[{"currSynthRate", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"speciesToMol", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{"parameter", "===", "Arp"}], "]"}], "arpBasalRate"}], "+", 
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{"parameter", "===", "Cam"}], "]"}], "camBasalRate"}], "+", 
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{"parameter", "===", "Cof"}], "]"}], "cofilinBasalRate"}], 
          "+", 
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{"parameter", "===", "Aip1"}], "]"}], "aip1BasalRate"}], "+", 
          RowBox[{"Boole", "[", 
           RowBox[{"parameter", "===", "NOR"}], "]"}]}], ")"}]}], "]"}]}], ";",
      "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"parameter", "===", "STUBMIXEDCam"}], ",", "\n", 
       RowBox[{
        RowBox[{"currSynthRateArp", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"speciesToMol", 
           RowBox[{"(", "arpBasalRate", ")"}]}], "]"}]}], ";", "\n", 
        RowBox[{"currSynthRateCam", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"speciesToMol", 
           RowBox[{"(", "camBasalRate", ")"}]}], "]"}]}], ";", "\n", 
        RowBox[{"synthRatesArp", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"(", 
               RowBox[{"currSynthRateArp", "/", 
                RowBox[{"factor", "^", "power"}]}], ")"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"currSynthRateArp", "*", 
               RowBox[{"factor", "^", "power"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateArp", "*", 
                  RowBox[{"factor", "^", "power"}]}], "]"}], "-", 
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateArp", "/", 
                  RowBox[{"factor", "^", "power"}]}], "]"}]}], ")"}], "/", 
              "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"synthRatesCam", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"(", 
               RowBox[{"currSynthRateCam", "/", "factor"}], ")"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"currSynthRateCam", "*", "factor"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateCam", "*", "factor"}], "]"}], "-", 
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateCam", "/", "factor"}], "]"}]}], ")"}], 
              "/", "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"rateArp", "=", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"synthRatesArp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], "]"}], 
            ")"}]}], "/", "speciesToMol"}]}], ";", "\n", 
        RowBox[{"rateCam", "=", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"synthRatesCam", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], "]"}], 
            ")"}]}], "/", "speciesToMol"}]}], ";"}], ",", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"parameter", "===", "STUBMIXEDCof"}], ",", "\n", 
          RowBox[{
           RowBox[{"currSynthRateArp", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"speciesToMol", 
              RowBox[{"(", "arpBasalRate", ")"}]}], "]"}]}], ";", "\n", 
           RowBox[{"currSynthRateCof", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"speciesToMol", 
              RowBox[{"(", "cofilinBasalRate", ")"}]}], "]"}]}], ";", "\n", 
           RowBox[{"synthRatesArp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"(", 
                  RowBox[{"currSynthRateArp", "/", 
                   RowBox[{"factor", "^", "power"}]}], ")"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateArp", "*", 
                  RowBox[{"factor", "^", "power"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateArp", "*", 
                    RowBox[{"factor", "^", "power"}]}], "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateArp", "/", 
                    RowBox[{"factor", "^", "power"}]}], "]"}]}], ")"}], "/", 
                 "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{"synthRatesCof", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"(", 
                  RowBox[{"currSynthRateCof", "/", "factor"}], ")"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"currSynthRateCof", "*", "factor"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateCof", "*", "factor"}], "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateCof", "/", "factor"}], "]"}]}], 
                  ")"}], "/", "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{"rateArp", "=", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"synthRatesArp", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], "]"}],
                ")"}]}], "/", "speciesToMol"}]}], ";", "\n", 
           RowBox[{"rateCof", "=", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"synthRatesCof", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], "]"}],
                ")"}]}], "/", "speciesToMol"}]}], ";"}], ",", "\n", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"parameter", "===", "STUBMIXEDAip1"}], ",", "\n", 
             RowBox[{
              RowBox[{"currSynthRateArp", "=", 
               RowBox[{"Simplify", "[", 
                RowBox[{"speciesToMol", 
                 RowBox[{"(", "arpBasalRate", ")"}]}], "]"}]}], ";", "\n", 
              RowBox[{"currSynthRateAip1", "=", 
               RowBox[{"Simplify", "[", 
                RowBox[{"speciesToMol", 
                 RowBox[{"(", "aip1BasalRate", ")"}]}], "]"}]}], ";", "\n", 
              RowBox[{"synthRatesArp", "=", 
               RowBox[{"Table", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"(", 
                    RowBox[{"currSynthRateArp", "/", 
                    RowBox[{"factor", "^", "power"}]}], ")"}], "]"}], ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateArp", "*", 
                    RowBox[{"factor", "^", "power"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateArp", "*", 
                    RowBox[{"factor", "^", "power"}]}], "]"}], "-", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateArp", "/", 
                    RowBox[{"factor", "^", "power"}]}], "]"}]}], ")"}], "/", 
                    "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
              RowBox[{"synthRatesAip1", "=", 
               RowBox[{"Reverse", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"(", 
                    RowBox[{"currSynthRateAip1", "/", "factor"}], ")"}], 
                    "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateAip1", "*", "factor"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateAip1", "*", "factor"}], "]"}], "-", 
                    
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRateAip1", "/", "factor"}], "]"}]}], 
                    ")"}], "/", "19."}]}], "}"}]}], "]"}]}]}], ";", "\n", 
              RowBox[{"rateArp", "=", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"synthRatesArp", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], 
                   "]"}], ")"}]}], "/", "speciesToMol"}]}], ";", "\n", 
              RowBox[{"rateAip1", "=", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"synthRatesAip1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], 
                   "]"}], ")"}]}], "/", "speciesToMol"}]}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"synthRates", "=", 
               RowBox[{"Table", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"(", 
                    RowBox[{"currSynthRate", "/", "factor"}], ")"}], "]"}], ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRate", "*", "factor"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRate", "*", "factor"}], "]"}], "-", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"currSynthRate", "/", "factor"}], "]"}]}], ")"}], 
                    "/", "19."}]}], "}"}]}], "]"}]}], ";", "\n", 
              RowBox[{"rate", "=", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"synthRates", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "20"}], "]"}], "+", "1"}], "]"}], 
                   "]"}], ")"}]}], "/", "speciesToMol"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n",
       "]"}], ";", "\n", "\n", 
     RowBox[{"<<", "Plenum.m"}], ";", "\n", "\n", "\n", 
     RowBox[{"modelSpine", "=", " ", 
      RowBox[{
       RowBox[{"Grammar", "[", 
        RowBox[{"rules", " ", "->", 
         RowBox[{"Join", "[", 
          RowBox[{
          "rulesBarb", ",", "rulesPoint", ",", "rulesMolVanilla", ",", 
           "rulesFilNuc", ",", "rulesPiRelease", ",", "rulesCap", ",", 
           "rulesBranch", ",", "rulesBundling", ",", "rulesSpine", ",", 
           "rulesAnisotropic", ",", "rulesEndRadial", ",", "rulesHessian", ",",
            "rulesHessianEnds", ",", "rulesBending", ",", "rulesEndBending", ",",
            "rulesCof"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"actinRate", "->", 
          RowBox[{"(", "actinSynthRate", ")"}]}], ",", 
         RowBox[{"arpRate", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateArp", "+", "arpInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"parameter", "===", "STUBMIXEDCam"}], "||", 
               RowBox[{"parameter", "===", "STUBMIXEDCof"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rate", "+", "arpInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "Arp"}], "]"}]}], "+", 
            RowBox[{"arpSynthRate", " ", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"parameter", "=!=", "Arp"}], ")"}], "&&", 
               RowBox[{"parameter", "=!=", "STUBMIXEDCam"}], "&&", 
               RowBox[{"parameter", "=!=", "STUBMIXEDCof"}]}], "]"}]}]}], 
           ")"}]}], ",", 
         RowBox[{"cofRate", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateCof", "+", "cofilinInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "STUBMIXEDCof"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rate", "+", "cofilinInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "Cof"}], "]"}]}], "+", 
            RowBox[{"cofilinSynthRate", " ", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{"parameter", "===", "Cof"}], ")"}]}], "&&", 
               RowBox[{"parameter", "=!=", "STUBMIXEDCof"}]}], "]"}]}]}], 
           ")"}]}], ",", "\n", "\t", 
         RowBox[{"camRate", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateCam", "+", "camInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "STUBMIXEDCam"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rate", "+", "camInfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "Cam"}], "]"}]}], "+", 
            RowBox[{"camSynthRate", " ", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{"parameter", "===", "Cam"}], ")"}]}], "&&", 
               RowBox[{"parameter", "=!=", "STUBMIXEDCam"}]}], "]"}]}]}], 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"aip1Rate", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateAip1", "+", "aip1InfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "STUBMIXEDAip1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rate", "+", "aip1InfluxRate"}], ")"}], " ", 
             RowBox[{"Boole", "[", 
              RowBox[{"parameter", "===", "Aip1"}], "]"}]}], "+", 
            RowBox[{"aip1SynthRate", " ", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{"parameter", "===", "Aip1"}], ")"}]}], "&&", 
               RowBox[{"parameter", "=!=", "STUBMIXEDAip1"}]}], "]"}]}]}], 
           ")"}]}]}], "}"}]}]}], ";", "\n", "\n", 
     RowBox[{"reducedSpineic", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{
         RowBox[{"Length", "[", "spineCoords", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"reducedSpineic", ",", 
          RowBox[{"spine", "[", 
           RowBox[{"i", ",", 
            RowBox[{"newPos", "[", 
             RowBox[{
              RowBox[{"spineCoords", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
              RowBox[{"360", " ", 
               RowBox[{"Degree", "/", "meshSize"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"i", "-", "3"}], ",", 
               RowBox[{"Length", "[", "spineCoords", "]"}]}], "]"}], "+", 
             "2"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "==", 
               RowBox[{
                RowBox[{"Length", "@", "spineCoords"}], "+", "1"}]}], ",", 
              "2", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}]}], "]"}]}], "]"}], "*)"}], 
       "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"reducedSpineic", ",", 
           RowBox[{"spine", "[", 
            RowBox[{"i", ",", 
             RowBox[{"spineCoords", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "==", 
                RowBox[{
                 RowBox[{"Length", "@", "spineCoords"}], "+", "1"}]}], ",", 
               "2", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}]}], "]"}]}], "]"}], ";"}], 
        "\n", ";"}]}], "]"}], ";", "\n", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"reducedSpineic", ",", 
       RowBox[{"spineIDMax", "[", 
        RowBox[{
         RowBox[{"Length", "@", "spineCoords"}], "+", "3"}], "]"}]}], "]"}], ";",
      "\n", "\n", "\n", 
     RowBox[{"reducedSpineic", "=", 
      RowBox[{
       RowBox[{"Join", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{"newID", "[", "1000", "]"}], ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "counter", " ", "for", " ", "new", " ", "ids", " ", "to", " ", 
               "be", " ", "generated"}], " ", "*)"}], "\n", 
             RowBox[{"pointedEnd", "[", 
              RowBox[{"0.", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "actinObjectRise"}], "/", "2."}], ",", 
                 "middleRadiusCam"}], "}"}], ",", "1.", ",", "ATP", ",", 
               "nullPointer", ",", "actinObjectRise"}], "]"}], ",", "\n", 
             RowBox[{"barbedEnd", "[", 
              RowBox[{"1.", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"actinObjectRise", "/", "2."}], ",", 
                 "middleRadiusCam"}], "}"}], ",", "ATP", ",", "nullPointer", ",",
                "actinObjectRise"}], "]"}], ",", 
             RowBox[{"pointedEnd", "[", 
              RowBox[{"2.", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "actinObjectRise"}], "/", "2."}], ",", 
                 RowBox[{"-", "middleRadiusCam"}]}], "}"}], ",", "3.", ",", 
               "ATP", ",", "nullPointer", ",", "actinObjectRise"}], "]"}], ",",
              "\n", 
             RowBox[{"barbedEnd", "[", 
              RowBox[{"3.", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"actinObjectRise", "/", "2."}], ",", 
                 RowBox[{"-", "middleRadiusCam"}]}], "}"}], ",", "ATP", ",", 
               "nullPointer", ",", "actinObjectRise"}], "]"}], ",", "\n", 
             RowBox[{"pointedEnd", "[", 
              RowBox[{"4.", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", 
                 RowBox[{
                  RowBox[{"-", "actinObjectRise"}], "/", "2."}]}], "}"}], ",",
                "5.", ",", "ATP", ",", "nullPointer", ",", 
               "actinObjectRise"}], "]"}], ",", "\n", 
             RowBox[{"barbedEnd", "[", 
              RowBox[{"5.", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", 
                 RowBox[{"actinObjectRise", "/", "2."}]}], "}"}], ",", "ATP", 
               ",", "nullPointer", ",", "actinObjectRise"}], "]"}], ",", 
             RowBox[{"pointedEnd", "[", 
              RowBox[{"6.", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", 
                 RowBox[{"actinObjectRise", "/", "2."}]}], "}"}], ",", "7.", ",",
                "ATP", ",", "nullPointer", ",", "actinObjectRise"}], "]"}], ",",
              "\n", 
             RowBox[{"barbedEnd", "[", 
              RowBox[{"7.", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", 
                 RowBox[{
                  RowBox[{"-", "actinObjectRise"}], "/", "2."}]}], "}"}], ",",
                "ATP", ",", "nullPointer", ",", "actinObjectRise"}], "]"}], ",",
              "\n", 
             RowBox[{"arpCount", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rateArp", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                    RowBox[{"parameter", "===", "STUBMIXEDCof"}], "||", 
                    RowBox[{"parameter", "===", "STUBMIXEDCam"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", "rate", ")"}], " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "Arp"}], "]"}]}], "+", 
                 RowBox[{"arpBasalRate", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"parameter", "=!=", "Arp"}], ")"}], "&&", 
                    RowBox[{"parameter", "=!=", "STUBMIXEDCof"}], "&&", 
                    RowBox[{"parameter", "=!=", "STUBMIXEDCam"}]}], "]"}]}]}],
                 ")"}], "/", "arpDegRate"}], "]"}], ",", " ", "\n", 
             RowBox[{"actinATPCount", "[", 
              RowBox[{"actinBasalRate", "/", "actinDegRate"}], "]"}], ",", 
             "\n", 
             RowBox[{"actinADPCount", "[", "initActinADPNum", "]"}], ",", 
             "\n", 
             RowBox[{"cofilinCount", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rateCof", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "STUBMIXEDCof"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", "rate", ")"}], " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "Cof"}], "]"}]}], "+", 
                 RowBox[{"cofilinBasalRate", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"parameter", "=!=", "Cof"}], ")"}], "&&", 
                    RowBox[{"parameter", "=!=", "STUBMIXEDCof"}]}], "]"}]}]}],
                 ")"}], "/", "cofilinDegRate"}], "]"}], ",", "\n", 
             RowBox[{"spineHeadArea", "[", "area", "]"}], ",", "\n", 
             RowBox[{"aip1Count", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rateAip1", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "STUBMIXEDAip1"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", "rate", ")"}], " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "Aip1"}], "]"}]}], "+", 
                 RowBox[{"aip1BasalRate", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"parameter", "=!=", "Aip1"}], ")"}], "&&", 
                    RowBox[{"parameter", "=!=", "STUBMIXEDAip1"}]}], 
                   "]"}]}]}], ")"}], "/", "aip1DegRate"}], "]"}], ",", "\n", 
             RowBox[{"camCount", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rateCam", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "STUBMIXEDCam"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", "rate", ")"}], " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"parameter", "===", "Cam"}], "]"}]}], "+", 
                 RowBox[{"camBasalRate", " ", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"parameter", "=!=", "Cam"}], ")"}], "&&", 
                    RowBox[{"parameter", "=!=", "STUBMIXEDCam"}]}], "]"}]}]}],
                 ")"}], "/", "camDegRate"}], "]"}]}], "\n", "}"}], ")"}], "//",
           "N"}], ",", "reducedSpineic"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"area", "->", 
          RowBox[{"getPolygonArea", "[", "spineCoords", "]"}]}], "//", "N"}], 
        "}"}]}]}], ";", " ", "\n", "\n", 
     RowBox[{"simdir", "=", 
      RowBox[{"\"\<~/_\>\"", "<>", 
       RowBox[{"ToString", "[", "type", "]"}], "<>", "\"\<_1-22-26\>\"", "<>", 
       RowBox[{"ToString", "[", "parameter", "]"}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", "it", "]"}], "<>", "\"\</\>\""}]}], ";", "\n", 
     RowBox[{"CreateDirectory", "[", "simdir", "]"}], ";", "\n", 
     RowBox[{"SetDirectory", "[", "simdir", "]"}], ";", "\n", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"simdir", "<>", "\"\<simSpine0.wls\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "reducedSpineic"}], "}"}]}], "]"}], ";", "\n", 
     RowBox[{"transformedRate", "=", 
      RowBox[{"N", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rate", "*", "speciesToMol"}], "//", "FullSimplify"}], 
        ")"}]}]}], ";", "\n", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"simdir", "<>", "\"\<param.wls\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{
        "transformedRate", ",", "nCG", ",", "biomechanicalRate", ",", 
         "membraneRate"}], "}"}]}], "]"}], ";", "\n", 
     RowBox[{"SeedRandom", "[", 
      RowBox[{"Hash", "[", 
       RowBox[{"it", ",", "\"\<SHA3-224\>\""}], "]"}], "]"}], ";", "\n", 
     RowBox[{"Clear", "[", "sims", "]"}], ";", "\n", 
     RowBox[{"Clear", "[", "frames", "]"}], ";", "\n", 
     RowBox[{"files", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FileBaseName", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"FileNames", "[", 
          RowBox[{"simdir", "<>", "\"\</simSpine*\>\""}], "]"}]}], ",", 
        "processFileNames"}], "]"}]}], ";", "\n", 
     RowBox[{"files", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"simdir", "<>", "#", "<>", "\"\<.wls\>\""}], "&"}], "/@", 
       "files"}]}], ";", "\n", 
     RowBox[{"simSpine", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"files", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"lastSavedIt", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"processFileNames", "[", 
         RowBox[{"FileBaseName", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "//", 
        "ToExpression"}], ")"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"lastSavedIt", "+", "1"}]}], ",", 
       RowBox[{"j", "<=", "80."}], ",", 
       RowBox[{"j", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"simSpineCheck", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"simSpineCheck", "===", 
           RowBox[{"{", "}"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"lastTime", "=", 
            RowBox[{"simSpine", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
           RowBox[{"ic", "=", 
            RowBox[{"simSpine", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
           RowBox[{"Clear", "[", "simSpine", "]"}], ";", "\n", 
           RowBox[{"executeGrammar", "[", 
            RowBox[{"modelSpine", ",", "ic", ",", "10000000", ",", "True", ",", 
             RowBox[{"maxTotalSimulationTime", "->", ".025"}]}], "]"}], ";", 
           "\n", 
           RowBox[{"simSpineCheck", "=", 
            RowBox[{"getSimulationStruct", "[", "]"}]}], ";"}]}], "\n", "]"}],
         ";", "\n", 
        RowBox[{"simSpine", "=", "simSpineCheck"}], ";", "\n", 
        RowBox[{"Clear", "[", "simSpineCheck", "]"}], ";", "\n", 
        RowBox[{
         RowBox[{"simSpine", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+=", "lastTime"}], ";", "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"simdir", "<>", "\"\</simSpine\>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<.wls\>\""}], ",", 
          "simSpine"}], "]"}], ";"}]}], "\n", "]"}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"it", ",", "1", ",", "5"}], "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.974697395888915*^9, 3.974697415414155*^9}, {
   3.974697448949606*^9, 3.974697470116341*^9}, {3.974697519381009*^9, 
   3.974697519535636*^9}, {3.97469768106161*^9, 3.974697705166211*^9}, {
   3.9746981812447157`*^9, 3.97469818129982*^9}, {3.974698521215839*^9, 
   3.974698521410324*^9}, {3.974698672708611*^9, 3.974698678497396*^9}, 
   3.9746990769884367`*^9, {3.974729525789434*^9, 3.974729525901691*^9}, {
   3.974741763969873*^9, 3.974741765451972*^9}, {3.9747418256244926`*^9, 
   3.974741859503393*^9}, {3.9747839583759127`*^9, 3.974783958711982*^9}, 
   3.974784097411187*^9, {3.975516663886677*^9, 3.9755166701486473`*^9}, {
   3.975516804773142*^9, 3.975516805162341*^9}, {3.975517153374427*^9, 
   3.975517176246105*^9}, {3.975754359231238*^9, 3.975754378707924*^9}, {
   3.976559802844779*^9, 3.9765598043008633`*^9}, {3.976845049478979*^9, 
   3.976845049786936*^9}, {3.976845278306489*^9, 3.9768453554152308`*^9}, {
   3.976845626691709*^9, 3.9768456363890667`*^9}, {3.976846066330267*^9, 
   3.976846066438397*^9}, {3.976877073245679*^9, 3.976877147616102*^9}, {
   3.97687744420083*^9, 3.9768775236794977`*^9}, {3.976877835629148*^9, 
   3.9768778556021957`*^9}, {3.976985900278802*^9, 3.976985914798319*^9}, {
   3.97698630337924*^9, 3.976986306076034*^9}, {3.97698683047099*^9, 
   3.9769868386829042`*^9}, {3.977254594426984*^9, 3.977254625780795*^9}, {
   3.977254700681012*^9, 3.977254722212385*^9}, {3.977256144354951*^9, 
   3.977256161906417*^9}, 3.977861103423099*^9, 3.9778615708062162`*^9, {
   3.978097677571829*^9, 
   3.978097677756742*^9}},ExpressionUUID->"213d59f1-3bbc-42dd-967a-\
c04a69ba2d55"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561628782187`*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"994b0010-f4d7-4581-9e64-593eba0f3399"],

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.97725616290065*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"95f9b2b7-ecb1-473d-ac42-02b4c57b63cf"],

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561629079847`*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"b8099b09-f658-4bdf-b793-11c04a4be94f"],

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.97725616293329*^9},
 CellLabel->
  "kernel 4 (Local)",ExpressionUUID->"8073d715-750c-4064-86d6-54ffb8a41efd"],

Cell[BoxData["\<\"Plenum: version 24\"\>"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256162938305*^9},
 CellLabel->
  "kernel 5 (Local)",ExpressionUUID->"9c2e897e-95ae-4201-bf50-34889834f17f"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory", "eexist", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/matthewhur/_STUB_1-12-26NOR/1/\\\\\\\
\"\\\"}]\\) already exists.\"", None, 25982, 4638, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256163020842*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"5eaea2ae-90d9-4aaf-8e13-7e985c6c7525"],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory", "eexist", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/matthewhur/_STUB_1-12-26NOR/2/\\\\\\\
\"\\\"}]\\) already exists.\"", None, 25982, 4639, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256163050609*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"6c05d1a1-84df-43aa-8f0f-1bbc06499778"],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory", "eexist", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/matthewhur/_STUB_1-12-26NOR/3/\\\\\\\
\"\\\"}]\\) already exists.\"", None, 25982, 4640, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256163106204*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"a084a4a9-87df-4160-89c1-18ceb721db89"],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory", "eexist", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/matthewhur/_STUB_1-12-26NOR/4/\\\\\\\
\"\\\"}]\\) already exists.\"", None, 25982, 4641, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561631300364`*^9},
 CellLabel->
  "kernel 4 (Local)",ExpressionUUID->"2356f13b-b7f3-4e6e-b90c-a34b3cd59467"],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory", "eexist", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/matthewhur/_STUB_1-12-26NOR/5/\\\\\\\
\"\\\"}]\\) already exists.\"", None, 25982, 4642, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561631561832`*^9},
 CellLabel->
  "kernel 5 (Local)",ExpressionUUID->"1075fcc6-0a4f-4e7d-a9c8-28cfd7b065b3"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", SuperscriptBox[\\\"2.718281828459045`\\\
\", \\\"1.7714039594370532`*^6\\\"]]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"", None, 25982, 4643, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166704091*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"98c7128d-a316-4b9d-bd12-3d1ce157e986"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0.00015819984978705472`\\\", \\\"}\\\"}]\\) lies outside the range of \
data in the interpolating function. Extrapolation will be used.\"", None, 
   25982, 4644, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166729127*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"9ddc2196-6832-45c7-8984-daf735a760dd"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0.00011441413560143291`\\\", \\\"}\\\"}]\\) lies outside the range of \
data in the interpolating function. Extrapolation will be used.\"", None, 
   25982, 4645, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166751274*^9},
 CellLabel->
  "kernel 4 (Local)",ExpressionUUID->"3137e68c-dd78-405c-9cd4-d446787cf9cc"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", SuperscriptBox[\\\"2.718281828459045`\\\
\", \\\"2.152686405193505`*^6\\\"]]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"", None, 25982, 4646, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166788072*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"342f2320-33e1-4450-aacd-152eb375d10f"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", SuperscriptBox[\\\"2.718281828459045`\\\
\", \\\"5.779166387030531`*^6\\\"]]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"", None, 25982, 4647, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166822023*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"cd435c38-7154-41b8-ac6b-a80994e7face"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0.00003318200698920538`\\\", \\\"}\\\"}]\\) lies outside the range of \
data in the interpolating function. Extrapolation will be used.\"", None, 
   25982, 4648, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166909037*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"4f62aba3-0ebb-43e8-acba-e3c038aa5d71"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", SuperscriptBox[\\\"2.718281828459045`\\\
\", \\\"6.147447986014373`*^6\\\"]]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"", None, 25982, 4649, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166944972*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"8af9b3aa-8f37-487b-8f3b-40f1333c5bd2"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", SuperscriptBox[\\\"2.718281828459045`\\\
\", \\\"1.3869160545172102`*^6\\\"]]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"", None, 25982, 4650, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256166969638*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"45c00c08-d43c-45ac-8aaf-037a461abbfe"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*RowBox[{\\\"\\\\\\\"`1` is too small to \
represent as a normalized machine number; precision may be \
lost.\\\\\\\"\\\"}]\\) will be suppressed during this calculation.\"", 2, 
   25982, 4651, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 ShowCellLabel->True,
 CellChangeTimes->{3.977255825884625*^9, 3.977256167142959*^9},
 CellLabel->
  "During evaluation of \
In[25982]:=",ExpressionUUID->"d112ba38-4045-4eea-b682-53d61955ef66"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 25982, 4652, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561671829243`*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"a3f842ce-b297-4339-a564-96198f1d9ba5"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 25982, 4653, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256167422768*^9},
 CellLabel->
  "kernel 5 (Local)",ExpressionUUID->"e446f239-dce6-46dc-aa58-2919fd7ec643"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0.00020172343482998398`\\\", \\\"}\\\"}]\\) lies outside the range of \
data in the interpolating function. Extrapolation will be used.\"", None, 
   25982, 4654, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256167691724*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"b8e3bb2f-bc89-4b4b-858c-ddf68d49da2f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 25982, 4655, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.97725616776206*^9},
 CellLabel->
  "kernel 2 (Local)",ExpressionUUID->"e084d007-c4c8-4ab5-85c4-f9c3f8b564f8"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0.00011156955061913127`\\\", \\\"}\\\"}]\\) lies outside the range of \
data in the interpolating function. Extrapolation will be used.\"", None, 
   25982, 4656, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772561678769217`*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"b15eef3d-2a53-4a6f-b8ac-04f01d5d7f7c"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 25982, 4657, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256168115649*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"69e16558-51cd-44fa-8080-27684bd20632"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*RowBox[{\\\"\\\\\\\"Input value `1` lies \
outside the range of data in the interpolating function. Extrapolation will \
be used.\\\\\\\"\\\"}]\\) will be suppressed during this calculation.\"", 2, 
   25982, 4658, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 ShowCellLabel->True,
 CellChangeTimes->{3.977255825884625*^9, 3.977256168290098*^9},
 CellLabel->
  "During evaluation of \
In[25982]:=",ExpressionUUID->"5f85c562-9850-4305-aa5f-a42ff5b7278f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 25982, 4659, 22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256168675934*^9},
 CellLabel->
  "kernel 4 (Local)",ExpressionUUID->"19230235-87ea-493c-9275-2f8a108e3a2e"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*RowBox[{\\\"\\\\\\\"Further output of `1` \
will be suppressed during this calculation.\\\\\\\"\\\"}]\\) will be \
suppressed during this calculation.\"", 2, 25982, 4660, 22543763936431266947, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 ShowCellLabel->True,
 CellChangeTimes->{3.977255825884625*^9, 3.9772561688720016`*^9},
 CellLabel->
  "During evaluation of \
In[25982]:=",ExpressionUUID->"989a4336-166d-41ef-bbcd-75b5b1ffca53"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SqrtBox[\\\"0.`\\\"]]\\) encountered.\"", None, 25982, 4661, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256270446836*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"29c22403-b8b1-4afe-a30a-caa2b6991a8d"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", None, 25982, 4662, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256270563406*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"cb8cf4c8-ea82-449d-9292-a116b7717b53"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", None, 25982, 4663, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772562706137533`*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"6bad14eb-eb70-4949-acef-54f813af5122"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SqrtBox[\\\"0.`\\\"]]\\) encountered.\"", None, 25982, 4664, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256270650033*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"5cf8674c-08bb-42e6-a8fa-952da3e8c392"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", None, 25982, 4665, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256270685063*^9},
 CellLabel->
  "kernel 3 (Local)",ExpressionUUID->"1231c3f5-ed19-420c-8047-3434a9bf50c2"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SqrtBox[\\\"0.`\\\"]]\\) encountered.\"", None, 25982, 4666, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256283843298*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"520e872c-e1dc-4067-bfda-e12fed194ebb"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SqrtBox[\\\"0.`\\\"]]\\) encountered.\"", None, 25982, 4667, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.977256283888974*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"f91f9cb0-1c8c-4f55-a3f7-04954e3b5a5a"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SqrtBox[\\\"0.`\\\"]]\\) encountered.\"", None, 25982, 4668, 
   22543763936431266947, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9772562839283543`*^9},
 CellLabel->
  "kernel 1 (Local)",ExpressionUUID->"0ac5fdd2-e0ad-4bdd-8eaf-4aca16924167"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.974748604625*^9, 3.974748810047984*^9, 3.974748874890212*^9, 
   3.974749031063176*^9, 3.974749231786664*^9, 3.974749360589019*^9, 
   3.974749585204687*^9, 3.9747507568264627`*^9, 3.974751147269115*^9, 
   3.9747514764156237`*^9, 3.974751728550356*^9, 3.9747520946414137`*^9, 
   3.974752363340042*^9, 3.974752476998214*^9, 3.974752881374983*^9, 
   3.97475492161053*^9, 3.974783560664462*^9, 3.9747837318222513`*^9, 
   3.974783813655409*^9, 3.9747839084027*^9, 3.9747848718906403`*^9, 
   3.974785049062998*^9, 3.974785119678195*^9, 3.974785282545526*^9, 
   3.974785570757051*^9, 3.974786869518998*^9, 3.974788984774335*^9, 
   3.974789995991724*^9, 3.9747911767661343`*^9, 3.97480922302715*^9, 
   3.975517312710655*^9, 3.975517564822124*^9, 3.975518306437262*^9, 
   3.976845075059299*^9, 3.976845411106818*^9, 3.976845624748328*^9, 
   3.9768459468788443`*^9, 3.9768463271302223`*^9, 3.9769859120245247`*^9, 
   3.976985990188958*^9, 3.97698609174492*^9, 3.9769862288842983`*^9, 
   3.9769864717056*^9, 3.976986536321888*^9, 3.976986735644032*^9, 
   3.97698698083461*^9, 3.976988165690075*^9, 3.977254699060482*^9, {
   3.977254803155361*^9, 3.977254828437751*^9}, 3.9772555086970253`*^9, 
   3.97725577547678*^9, 3.977256069248452*^9, 3.97725631459267*^9},
 CellLabel->
  "Out[25982]=",ExpressionUUID->"602d0ad1-a92b-4909-8406-40233ec975ed"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1512, 842},
WindowMargins->{{1, Automatic}, {Automatic, 9}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5458c562-d902-4447-9e2e-d89160652e29"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 186, 4, 96, "Title",ExpressionUUID->"df9d2e5b-91cf-4c95-8f23-006826a48b82",
 InitializationCell->True],
Cell[765, 28, 282, 4, 55, "Text",ExpressionUUID->"faff42c4-6b76-4cf3-b03a-047b8dc88021"],
Cell[CellGroupData[{
Cell[1072, 36, 163, 3, 66, "Section",ExpressionUUID->"827094a6-9a51-4e2b-8d54-19d578713f4b"],
Cell[CellGroupData[{
Cell[1260, 43, 157, 3, 45, "Input",ExpressionUUID->"2ece16d7-f557-4c7a-8dfc-88a259604591",
 InitializationCell->True],
Cell[1420, 48, 14795, 208, 23, "Print",ExpressionUUID->"bfeac787-c98c-4c1e-90e5-4654418ce647"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16264, 262, 94, 0, 66, "Section",ExpressionUUID->"39f688c3-3980-4383-8dce-b5cafb78176a"],
Cell[CellGroupData[{
Cell[16383, 266, 99, 0, 53, "Subsection",ExpressionUUID->"9ecf14fa-26ac-42e1-92e6-38a03808a542"],
Cell[16485, 268, 14195, 201, 106, "Input",ExpressionUUID->"ccd589dc-6fff-4f2e-a5df-8e7946336d0c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30717, 474, 92, 0, 53, "Subsection",ExpressionUUID->"bc5abab2-31ea-4155-89b5-2a66a0569a67"],
Cell[30812, 476, 430, 11, 65, "Input",ExpressionUUID->"30f89d95-4507-4cfa-8126-b772fc953727",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[31279, 492, 94, 0, 53, "Subsection",ExpressionUUID->"0a483fc6-e16a-4d70-9375-f6b558536599"],
Cell[31376, 494, 177, 3, 33, "Text",ExpressionUUID->"a132808a-bf4e-4453-96c4-c95b9430ff50"],
Cell[31556, 499, 697, 18, 167, "Input",ExpressionUUID->"ec6b5acb-f86a-4eca-980d-1726ddc1674c",
 InitializationCell->True],
Cell[32256, 519, 145, 2, 33, "Text",ExpressionUUID->"fe03d3a7-52fa-4170-acad-734cb39d9240"],
Cell[32404, 523, 578, 15, 106, "Input",ExpressionUUID->"5ef4ef4c-e5a5-496d-9782-56ffae3dabaf",
 InitializationCell->True],
Cell[32985, 540, 240, 4, 33, "Text",ExpressionUUID->"bbe8257d-4ce9-476b-b657-8edf84ba1949"],
Cell[33228, 546, 178, 3, 33, "Text",ExpressionUUID->"434ca94e-74f4-48ca-bd57-20c754b59c0a"],
Cell[33409, 551, 5743, 128, 192, "Input",ExpressionUUID->"89a4c3a4-6589-40a4-83c2-6294682ee132",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39177, 683, 873, 20, 31, "Input",ExpressionUUID->"80ed76c5-eb72-4813-a9f1-1979f170e2d8"],
Cell[40053, 705, 2906, 81, 49, "Output",ExpressionUUID->"09b30257-22c2-4b19-b8d1-2b8b7bff577c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42996, 791, 765, 18, 29, "Input",ExpressionUUID->"0c06226a-d132-4936-87cb-f0b18fc79e50"],
Cell[43764, 811, 11829, 240, 212, "Output",ExpressionUUID->"2b9ce19e-1358-431d-aa43-11348ad3b226"]
}, Open  ]],
Cell[55608, 1054, 1310, 27, 71, "Input",ExpressionUUID->"ac30b482-ecc4-40ae-bad6-705e22de2d02",
 InitializationCell->True],
Cell[56921, 1083, 19869, 416, 1114, "Input",ExpressionUUID->"f0a4503a-d864-4dad-9f4e-14dc7069d338",
 InitializationCell->True],
Cell[76793, 1501, 19136, 397, 641, "Code",ExpressionUUID->"2f6988a2-23a6-43b6-a0a1-b724894b1d10"],
Cell[95932, 1900, 23743, 639, 1672, "Code",ExpressionUUID->"c813d8f2-37d3-4038-a767-7e0ba959282c"],
Cell[119678, 2541, 17889, 415, 1069, "Code",ExpressionUUID->"46831002-015e-40d0-9450-98f8001e2306"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137604, 2961, 143, 1, 53, "Subsection",ExpressionUUID->"67670957-1bc7-48c0-a998-3624763610a2"],
Cell[137750, 2964, 535, 8, 77, "Text",ExpressionUUID->"69fecaa9-d58b-45fd-bbd2-5e2f2055c04c"],
Cell[138288, 2974, 1558, 40, 29, "Input",ExpressionUUID->"3c7e35b1-0cf2-4691-bf44-544aca683d8b"],
Cell[139849, 3016, 2506, 72, 111, "Input",ExpressionUUID->"b169a13a-aece-4e4e-b156-e31c93dde0c0"],
Cell[CellGroupData[{
Cell[142380, 3092, 2204, 59, 151, "Input",ExpressionUUID->"881ed65f-8578-44de-b185-caec33a17935"],
Cell[144587, 3153, 28422, 586, 223, "Output",ExpressionUUID->"0cc19f5c-f70c-42a4-b318-62ae1054c0e5"],
Cell[CellGroupData[{
Cell[173034, 3743, 854, 15, 23, "Print",ExpressionUUID->"8d9cbe8b-d441-4c3b-8607-70dc25191634"],
Cell[173891, 3760, 1592, 31, 63, "Print",ExpressionUUID->"c38af81f-388d-4d91-9ef3-1d70ebb8af94"]
}, Open  ]]
}, Open  ]],
Cell[175510, 3795, 402, 10, 29, "Input",ExpressionUUID->"74d6121e-efc8-4678-bb68-edc284e96472"],
Cell[CellGroupData[{
Cell[175937, 3809, 1004, 32, 29, "Input",ExpressionUUID->"cf7d0b37-db69-493f-8d9a-cb59e756aeca"],
Cell[176944, 3843, 162, 3, 33, "Output",ExpressionUUID->"02a5fa1a-6b12-45c2-8998-9b273ba6de97"]
}, Open  ]],
Cell[177121, 3849, 1054, 33, 29, "Input",ExpressionUUID->"0906d191-d901-40eb-8929-dd7b9db1dc69"],
Cell[178178, 3884, 1058, 30, 29, "Input",ExpressionUUID->"6263a5de-f633-48bc-a0e1-682ca6da531e"],
Cell[179239, 3916, 383, 11, 29, "Input",ExpressionUUID->"ec81395d-06af-492f-ae66-193d65284711"],
Cell[CellGroupData[{
Cell[179647, 3931, 2389, 71, 131, "Input",ExpressionUUID->"a4234906-6205-4742-bf53-7d069dfb321a"],
Cell[182039, 4004, 21661, 455, 220, "Output",ExpressionUUID->"02569956-fd06-4be0-8b85-983aab13904d"],
Cell[203703, 4461, 482, 10, 23, "Print",ExpressionUUID->"4ad72b0e-9133-4d8b-8e94-1081428450a0"],
Cell[204188, 4473, 605, 13, 26, "Message",ExpressionUUID->"04fbc391-3e64-4ac7-a4fb-8ff8081bc201"],
Cell[204796, 4488, 1211, 26, 60, "Print",ExpressionUUID->"5b251ae6-fd34-4dcc-9375-703e2742334d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206044, 4519, 2214, 61, 131, "Input",ExpressionUUID->"b48aae83-d258-47af-a068-553b80b772ef"],
Cell[208261, 4582, 27304, 570, 229, "Output",ExpressionUUID->"532b01ce-566c-48ea-92d5-934f6eaf7dc1"],
Cell[235568, 5154, 414, 9, 23, "Print",ExpressionUUID->"e34f3b59-280c-4b22-bc0e-a4e44ee7938c"],
Cell[235985, 5165, 607, 13, 26, "Message",ExpressionUUID->"440bf0ec-7c08-4f5e-abf6-d34051f695e5"],
Cell[236595, 5180, 1143, 25, 60, "Print",ExpressionUUID->"17fcf79b-a161-44bb-9fbf-c0bc981f0969"]
}, Open  ]],
Cell[237753, 5208, 1826, 59, 70, "Input",ExpressionUUID->"a01f252c-b893-4d45-be7d-ff22382f8f57"],
Cell[239582, 5269, 1067, 32, 29, "Input",ExpressionUUID->"814fca9d-1621-4343-8733-9127aaa8f213"],
Cell[CellGroupData[{
Cell[240674, 5305, 1224, 35, 90, "Input",ExpressionUUID->"5cc6f013-b246-4df5-ba46-14ba29dc2540"],
Cell[241901, 5342, 612, 13, 26, "Message",ExpressionUUID->"6050a6b6-66f7-406d-a1c9-40d6612848f4"],
Cell[242516, 5357, 612, 13, 26, "Message",ExpressionUUID->"8d4c20d5-5163-4dd7-a034-aebe17160c03"],
Cell[243131, 5372, 612, 13, 26, "Message",ExpressionUUID->"edeacc50-af27-4e0f-9c91-a7d8315b3d58"],
Cell[243746, 5387, 581, 13, 26, "Message",ExpressionUUID->"de68c543-3627-40e8-a3fc-65614a32cb9d"],
Cell[244330, 5402, 21813, 457, 224, "Output",ExpressionUUID->"c45d9cc5-159a-49ca-91ed-5f92c71f59f6"],
Cell[266146, 5861, 501, 11, 23, "Print",ExpressionUUID->"a878770a-e408-4dc4-b986-6651d605e733"],
Cell[266650, 5874, 676, 14, 26, "Message",ExpressionUUID->"3ca688ec-e93a-4d26-91b8-26158c6c1b5a"],
Cell[267329, 5890, 1250, 27, 60, "Print",ExpressionUUID->"ab046562-7890-4fc5-b4b0-9f16dcf08f17"]
}, Open  ]],
Cell[268594, 5920, 152, 3, 29, "Input",ExpressionUUID->"d09efced-26fd-4345-aeeb-3bb606cf0f1d"],
Cell[CellGroupData[{
Cell[268771, 5927, 2275, 63, 131, "Input",ExpressionUUID->"a0c53df5-3489-4f41-8cf7-ad5e8707306c"],
Cell[271049, 5992, 42493, 817, 232, "Output",ExpressionUUID->"98c4bdbf-bbd8-4a09-97bc-4b3d577e91e2"],
Cell[313545, 6811, 483, 11, 23, "Print",ExpressionUUID->"f999af07-c59d-4b7d-92a8-cc335d7603c9"],
Cell[314031, 6824, 655, 14, 26, "Message",ExpressionUUID->"7b0d9ba7-d842-4925-912c-216afede096f"],
Cell[314689, 6840, 1229, 27, 60, "Print",ExpressionUUID->"58a23469-9d5f-4895-83fd-0da4b66963d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315955, 6872, 3776, 116, 213, "Input",ExpressionUUID->"95caf223-cb66-440c-bd6c-ace8f7964bdd"],
Cell[319734, 6990, 21610, 452, 224, "Output",ExpressionUUID->"f79feec5-3e1d-4e31-b3cf-ba017a20ecfa"],
Cell[341347, 7444, 416, 9, 23, "Print",ExpressionUUID->"7cec5cf5-41ef-41e3-9359-c69e99e8b6b1"],
Cell[341766, 7455, 604, 13, 26, "Message",ExpressionUUID->"20349eb2-9cd8-4be6-a506-6d09ffc9e03d"],
Cell[342373, 7470, 1143, 25, 63, "Print",ExpressionUUID->"e151f8fe-c29b-421e-b4ce-fc16e3fb2d46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343553, 7500, 219, 4, 29, "Input",ExpressionUUID->"f09b232e-0de0-4cb2-9caf-b90ed4d1ef4d"],
Cell[343775, 7506, 199, 3, 33, "Output",ExpressionUUID->"c4b36a38-d047-41f5-a9b5-e55ffe6d1134"]
}, Open  ]],
Cell[343989, 7512, 3389, 92, 213, "Input",ExpressionUUID->"806c3999-487b-4f7b-8daa-abf4ec0b050d"],
Cell[CellGroupData[{
Cell[347403, 7608, 2991, 83, 213, "Input",ExpressionUUID->"249aaeb2-7cca-4145-8f62-caacf4667c49"],
Cell[350397, 7693, 22927, 477, 219, "Output",ExpressionUUID->"5086c8bf-8a0b-4fc0-9f88-0e91d78c9151"],
Cell[373327, 8172, 731, 14, 24, "Print",ExpressionUUID->"431f71d3-f949-4617-9ef4-107e6e6b2469"],
Cell[374061, 8188, 917, 18, 26, "Message",ExpressionUUID->"bdae03d9-badd-4979-81b7-0f267f5ab0eb"],
Cell[374981, 8208, 1464, 30, 67, "Print",ExpressionUUID->"5d54e85e-5d4c-4549-9250-9ee768a3495a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[376494, 8244, 96, 0, 53, "Subsection",ExpressionUUID->"c1a652e7-bc9c-4825-ac19-d1e317fca4de"],
Cell[376593, 8246, 5094, 85, 106, "Input",ExpressionUUID->"1b9d58cc-9d35-45c0-82db-02a3a7284646",
 InitializationCell->True],
Cell[381690, 8333, 196, 3, 33, "Text",ExpressionUUID->"e6c29882-0830-4fc9-8c8d-898c3d4d9318"],
Cell[381889, 8338, 1456, 34, 147, "Input",ExpressionUUID->"1716a032-7599-4e9f-82ed-40a42e45beb1",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383394, 8378, 103, 0, 66, "Section",ExpressionUUID->"4e6cf27f-383e-46ee-8bf4-acb469a9d1ff"],
Cell[CellGroupData[{
Cell[383522, 8382, 87, 0, 53, "Subsection",ExpressionUUID->"7587dd65-dad9-47e8-9178-ffcae41f195a"],
Cell[383612, 8384, 406, 10, 186, "Text",ExpressionUUID->"dfc9f736-7559-41b6-80db-55c04327a1a8"],
Cell[384021, 8396, 35917, 844, 1359, "Input",ExpressionUUID->"119fabd1-2ec4-482f-bbd0-f398361ffce5",
 InitializationCell->True],
Cell[419941, 9242, 1768, 43, 127, "Input",ExpressionUUID->"6eb0391b-e890-46fb-afc5-e81bb71d2b17",
 InitializationCell->True],
Cell[421712, 9287, 11403, 279, 569, "Input",ExpressionUUID->"fffa00eb-b458-4b6d-9cf9-72ba6ea4a28c",
 InitializationCell->True],
Cell[433118, 9568, 31339, 794, 2455, "Input",ExpressionUUID->"caa49df6-bcaa-4320-a4f2-67b10a7183f6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[464494, 10367, 85, 0, 53, "Subsection",ExpressionUUID->"ea6f0e35-a244-4e1d-8766-cf2f7b667492"],
Cell[464582, 10369, 11475, 287, 413, "Input",ExpressionUUID->"38cba5e7-f0fd-475c-be6f-e99547dad72e",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[476106, 10662, 88, 0, 66, "Section",ExpressionUUID->"d128777f-5c63-4454-91fd-009185e12042"],
Cell[476197, 10664, 475, 7, 55, "Text",ExpressionUUID->"e25afe7b-1d43-47ed-be55-64f5c57d3ccb"],
Cell[476675, 10673, 19982, 477, 1638, "Input",ExpressionUUID->"2cf740e6-2a31-43bd-871a-0cda3fc48a91",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[496694, 11155, 91, 0, 66, "Section",ExpressionUUID->"acdbb75d-90f1-4d7d-bb3a-3f67f8305b18"],
Cell[496788, 11157, 6889, 188, 453, "Input",ExpressionUUID->"470d4443-1f7e-496c-ba72-a0c44756b662",
 InitializationCell->True],
Cell[503680, 11347, 68653, 1570, 6704, "Input",ExpressionUUID->"9666f068-bdf9-4030-a53c-28f957db758c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[572370, 12922, 91, 0, 66, "Section",ExpressionUUID->"18b0aa7e-5bfc-48bc-b787-d8ea185d07d3"],
Cell[572464, 12924, 60760, 1335, 5315, "Input",ExpressionUUID->"a3918d5f-561b-4c76-ad41-da055754576a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[633261, 14264, 89, 0, 66, "Section",ExpressionUUID->"ef62b9dd-c0b5-4c90-854f-67837ae46014"],
Cell[633353, 14266, 7972, 185, 698, "Input",ExpressionUUID->"bf5d21a1-d1d5-454b-a511-c8601341de0e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[641362, 14456, 211, 4, 66, "Section",ExpressionUUID->"7b30f901-caee-4ba7-ba92-70d0a80d5dc8"],
Cell[641576, 14462, 54437, 1184, 4743, "Input",ExpressionUUID->"068e1d77-45ae-4e6e-b77b-fb294ec715b3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[696050, 15651, 169, 3, 66, "Section",ExpressionUUID->"b64f170b-b73d-4469-ad9f-f16b3f5b7e32"],
Cell[696222, 15656, 5840, 138, 724, "Input",ExpressionUUID->"5d92dd8e-596b-4ccf-bb1d-d7e4c5973a07",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[702099, 15799, 97, 0, 66, "Section",ExpressionUUID->"1609e4d4-0290-421e-bfc5-ad012eba05c5"],
Cell[702199, 15801, 140, 2, 33, "Text",ExpressionUUID->"7c508ecb-3dc3-4f13-946e-2bf78ef30044"],
Cell[CellGroupData[{
Cell[702364, 15807, 114, 0, 53, "Subsection",ExpressionUUID->"114635a6-4cc7-4157-93ba-4928978be41b"],
Cell[702481, 15809, 5675, 150, 658, "Input",ExpressionUUID->"682611f6-6ee2-460f-92aa-e38d4155df41",
 InitializationCell->True],
Cell[708159, 15961, 6327, 186, 371, "Code",ExpressionUUID->"d9362596-878e-4f8a-a4c4-04f6c31e0170"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[714535, 16153, 88, 0, 66, "Section",ExpressionUUID->"6df491bb-4639-4d6a-9bf6-f6d0dbed3d80"],
Cell[CellGroupData[{
Cell[714648, 16157, 82, 0, 53, "Subsection",ExpressionUUID->"77159853-3af5-4ea3-8570-d7b774c97f81"],
Cell[714733, 16159, 184, 3, 33, "Text",ExpressionUUID->"33f37b69-a305-4cd4-a021-a8200e2647c8"],
Cell[714920, 16164, 29742, 680, 2455, "Input",ExpressionUUID->"09c0a18c-7088-4b7b-af18-bcc6550514c2",
 InitializationCell->True],
Cell[744665, 16846, 261, 4, 33, "Text",ExpressionUUID->"8bde53e9-3693-481c-9c9d-7ac6129ebccc"],
Cell[744929, 16852, 268, 4, 33, "Text",ExpressionUUID->"a485e30c-203e-48db-aa94-b7b5259f92d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[745234, 16861, 104, 0, 53, "Subsection",ExpressionUUID->"5abce886-44e0-4627-92be-9a96b370f091"],
Cell[CellGroupData[{
Cell[745363, 16865, 85, 0, 43, "Subsubsection",ExpressionUUID->"eab54c0c-90c9-49d4-8b9d-c140b16ead33"],
Cell[745451, 16867, 359, 5, 55, "Text",ExpressionUUID->"af4349a7-1afb-4edd-8177-67049ea58702"],
Cell[745813, 16874, 224, 3, 33, "Text",ExpressionUUID->"9fcf206d-5ec8-49d2-a58c-aec1668d3cd0"],
Cell[746040, 16879, 2205, 67, 147, "Input",ExpressionUUID->"52d1d23e-e4ca-4b1b-922d-14a6ae3a5ebc",
 InitializationCell->True],
Cell[748248, 16948, 3440, 100, 270, "Input",ExpressionUUID->"ba4339d0-e8c4-4019-bbfb-3a34636df7d4",
 InitializationCell->True],
Cell[751691, 17050, 6194, 173, 617, "Input",ExpressionUUID->"dc7d3835-7738-4bd9-87c2-17c5abadb034",
 InitializationCell->True],
Cell[757888, 17225, 3202, 92, 239, "Code",ExpressionUUID->"e9d1bd4a-a1b8-4700-b09c-3b44d2d7f75a"],
Cell[761093, 17319, 84339, 1921, 7112, "Input",ExpressionUUID->"8061e8e2-b8bf-4af0-bcfc-ececc2683cc9",
 InitializationCell->True],
Cell[845435, 19242, 8039, 254, 392, "Input",ExpressionUUID->"d051d0fa-326f-4854-8b98-6a821d996e48",
 InitializationCell->True],
Cell[853477, 19498, 100429, 2265, 7950, "Input",ExpressionUUID->"87b1275e-ee9b-46aa-b37b-39edf1158af6",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[953955, 21769, 98, 0, 53, "Subsection",ExpressionUUID->"5f8843f4-21ba-4b97-a58b-8c8a7fd1426e"],
Cell[CellGroupData[{
Cell[954078, 21773, 85, 0, 43, "Subsubsection",ExpressionUUID->"6fa471dc-f78e-4856-8e38-54c5ed8a2cc1"],
Cell[954166, 21775, 1010, 17, 208, "Text",ExpressionUUID->"60ddf256-6ae5-4400-b94c-22497bbbfd5d"],
Cell[955179, 21794, 1239, 38, 86, "Input",ExpressionUUID->"32c4fa41-f363-48c3-868e-3bdeda3603c6",
 InitializationCell->True],
Cell[956421, 21834, 18933, 484, 658, "Input",ExpressionUUID->"42592851-7393-476d-8f9f-1a76438bf86e",
 InitializationCell->True],
Cell[975357, 22320, 8751, 225, 126, "Code",ExpressionUUID->"fd9b7e1e-ec68-4ca4-bb3d-6e98b61c9926"],
Cell[984111, 22547, 21483, 565, 711, "Code",ExpressionUUID->"ebd4f207-f9ce-49ba-b8ef-916a9e38c8ae"],
Cell[1005597, 23114, 96805, 2211, 8517, "Input",ExpressionUUID->"6c6171f5-4e7b-4bd6-a636-d3635c96fbff",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1102451, 25331, 82, 0, 53, "Subsection",ExpressionUUID->"22b63461-8abb-434c-b47b-eaa747f91e68"],
Cell[1102536, 25333, 720, 10, 77, "Text",ExpressionUUID->"e92c8c5b-9481-4d4d-ac6d-968f490bddd0"],
Cell[1103259, 25345, 3092, 89, 147, "Input",ExpressionUUID->"e8d7f33a-052b-4b1b-aab2-6b2484aa7c23",
 InitializationCell->True],
Cell[1106354, 25436, 153, 2, 33, "Text",ExpressionUUID->"41d6a320-c132-41b7-86cf-9c75a207e8c8"],
Cell[1106510, 25440, 1128, 33, 188, "Input",ExpressionUUID->"fba69cee-866b-4aba-885d-55b732e30cb0",
 InitializationCell->True],
Cell[1107641, 25475, 165, 3, 33, "Text",ExpressionUUID->"7df31713-e1be-422d-ac72-c1e59e1347c4"],
Cell[1107809, 25480, 9832, 265, 1137, "Input",ExpressionUUID->"30a0669a-0640-424c-a831-10ef53fed855",
 InitializationCell->True],
Cell[1117644, 25747, 11212, 279, 635, "Code",ExpressionUUID->"53b8f9e1-32aa-4f53-b5bb-2f8006d6c46d"],
Cell[1128859, 26028, 151, 2, 33, "Text",ExpressionUUID->"a493a91d-add4-4c1c-b91c-d33a1c94e2ca"],
Cell[1129013, 26032, 144, 1, 33, "Text",ExpressionUUID->"137c3e94-d848-4cb6-83ab-383969e7ae07"],
Cell[1129160, 26035, 391, 7, 143, "Text",ExpressionUUID->"e6f9f3b1-90b3-4bb3-8c97-c76de00f0f16"],
Cell[1129554, 26044, 163, 3, 33, "Text",ExpressionUUID->"82c2c741-cb9a-4bda-9f88-f4f5f2ce6456"],
Cell[1129720, 26049, 531, 8, 77, "Text",ExpressionUUID->"bdc53652-abdf-4256-add3-9e27d26983dc"],
Cell[1130254, 26059, 116, 0, 33, "Text",ExpressionUUID->"a2273339-8bb1-44a0-9c5d-f670b97176cc"],
Cell[1130373, 26061, 438, 7, 121, "Text",ExpressionUUID->"f7f39396-15f8-4fdf-a1b9-9d113e75ffc0"],
Cell[1130814, 26070, 5371, 148, 453, "Input",ExpressionUUID->"27a1a7d5-93a4-4715-bd7e-5abf3113b06b",
 InitializationCell->True],
Cell[1136188, 26220, 2266, 51, 90, "Code",ExpressionUUID->"55c81c2a-14fa-404b-ae6c-86f31be1ce09",
 InitializationCell->True],
Cell[1138457, 26273, 1789, 47, 147, "Input",ExpressionUUID->"4f89d259-20d7-469b-957c-59b95fe74e39",
 InitializationCell->True],
Cell[1140249, 26322, 102, 0, 33, "Text",ExpressionUUID->"9995a441-46c1-4e01-b3cd-634527c89b0f"],
Cell[1140354, 26324, 215, 3, 33, "Text",ExpressionUUID->"e4933478-9ecd-4b1b-9b44-135c6c79cb7d"],
Cell[1140572, 26329, 311, 4, 33, "Text",ExpressionUUID->"01dcefdd-935c-4ef8-b855-d299bf12be6b"],
Cell[1140886, 26335, 218, 3, 33, "Text",ExpressionUUID->"7d919b2a-f384-4c01-a0d2-e342f8396663"],
Cell[1141107, 26340, 3374, 100, 127, "Input",ExpressionUUID->"dcdbcd0c-c04c-4f12-8344-25769378b21f",
 InitializationCell->True],
Cell[1144484, 26442, 332, 5, 55, "Text",ExpressionUUID->"06785914-cc15-4c97-88e7-9a95e923dda1"],
Cell[1144819, 26449, 856, 25, 65, "Input",ExpressionUUID->"bf5e3dc2-17af-46b4-a836-994a1b1182b2",
 InitializationCell->True],
Cell[1145678, 26476, 909, 26, 106, "Input",ExpressionUUID->"3f96141f-b548-4512-bb06-8cbf702095cf",
 InitializationCell->True],
Cell[1146590, 26504, 13130, 387, 1031, "Code",ExpressionUUID->"0dfeb787-2396-46a8-9352-30b40b9eb7a6"],
Cell[1159723, 26893, 70917, 1611, 6734, "Input",ExpressionUUID->"182bcd33-f635-4dcb-af06-add62fd666c4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1230677, 28509, 89, 0, 53, "Subsection",ExpressionUUID->"37386b1d-a807-4637-8002-90e9b1466379"],
Cell[CellGroupData[{
Cell[1230791, 28513, 32138, 733, 2333, "Input",ExpressionUUID->"213d59f1-3bbc-42dd-967a-c04a69ba2d55",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1262954, 29250, 208, 4, 36, "Print",ExpressionUUID->"994b0010-f4d7-4581-9e64-593eba0f3399"],
Cell[1263165, 29256, 205, 4, 36, "Print",ExpressionUUID->"95f9b2b7-ecb1-473d-ac42-02b4c57b63cf"],
Cell[1263373, 29262, 208, 4, 36, "Print",ExpressionUUID->"b8099b09-f658-4bdf-b793-11c04a4be94f"],
Cell[1263584, 29268, 205, 4, 36, "Print",ExpressionUUID->"8073d715-750c-4064-86d6-54ffb8a41efd"],
Cell[1263792, 29274, 206, 4, 36, "Print",ExpressionUUID->"9c2e897e-95ae-4201-bf50-34889834f17f"]
}, Open  ]],
Cell[1264013, 29281, 442, 11, 34, "Message",ExpressionUUID->"5eaea2ae-90d9-4aaf-8e13-7e985c6c7525"],
Cell[1264458, 29294, 442, 11, 34, "Message",ExpressionUUID->"6c05d1a1-84df-43aa-8f0f-1bbc06499778"],
Cell[1264903, 29307, 442, 11, 34, "Message",ExpressionUUID->"a084a4a9-87df-4160-89c1-18ceb721db89"],
Cell[1265348, 29320, 444, 11, 34, "Message",ExpressionUUID->"2356f13b-b7f3-4e6e-b90c-a34b3cd59467"],
Cell[1265795, 29333, 444, 11, 34, "Message",ExpressionUUID->"1075fcc6-0a4f-4e7d-a9c8-28cfd7b065b3"],
Cell[1266242, 29346, 527, 12, 54, "Message",ExpressionUUID->"98c7128d-a316-4b9d-bd12-3d1ce157e986"],
Cell[1266772, 29360, 527, 12, 35, "Message",ExpressionUUID->"9ddc2196-6832-45c7-8984-daf735a760dd"],
Cell[1267302, 29374, 527, 12, 35, "Message",ExpressionUUID->"3137e68c-dd78-405c-9cd4-d446787cf9cc"],
Cell[1267832, 29388, 526, 12, 54, "Message",ExpressionUUID->"342f2320-33e1-4450-aacd-152eb375d10f"],
Cell[1268361, 29402, 526, 12, 54, "Message",ExpressionUUID->"cd435c38-7154-41b8-ac6b-a80994e7face"],
Cell[1268890, 29416, 527, 12, 35, "Message",ExpressionUUID->"4f62aba3-0ebb-43e8-acba-e3c038aa5d71"],
Cell[1269420, 29430, 526, 12, 54, "Message",ExpressionUUID->"8af9b3aa-8f37-487b-8f3b-40f1333c5bd2"],
Cell[1269949, 29444, 527, 12, 54, "Message",ExpressionUUID->"45c00c08-d43c-45ac-8aaf-037a461abbfe"],
Cell[1270479, 29458, 557, 13, 39, "Message",ExpressionUUID->"d112ba38-4045-4eea-b682-53d61955ef66"],
Cell[1271039, 29473, 490, 11, 35, "Message",ExpressionUUID->"a3f842ce-b297-4339-a564-96198f1d9ba5"],
Cell[1271532, 29486, 488, 11, 35, "Message",ExpressionUUID->"e446f239-dce6-46dc-aa58-2919fd7ec643"],
Cell[1272023, 29499, 527, 12, 35, "Message",ExpressionUUID->"b8e3bb2f-bc89-4b4b-858c-ddf68d49da2f"],
Cell[1272553, 29513, 487, 11, 35, "Message",ExpressionUUID->"e084d007-c4c8-4ab5-85c4-f9c3f8b564f8"],
Cell[1273043, 29526, 529, 12, 35, "Message",ExpressionUUID->"b15eef3d-2a53-4a6f-b8ac-04f01d5d7f7c"],
Cell[1273575, 29540, 488, 11, 35, "Message",ExpressionUUID->"69e16558-51cd-44fa-8080-27684bd20632"],
Cell[1274066, 29553, 578, 13, 39, "Message",ExpressionUUID->"5f85c562-9850-4305-aa5f-a42ff5b7278f"],
Cell[1274647, 29568, 488, 11, 35, "Message",ExpressionUUID->"19230235-87ea-493c-9275-2f8a108e3a2e"],
Cell[1275138, 29581, 540, 13, 39, "Message",ExpressionUUID->"989a4336-166d-41ef-bbcd-75b5b1ffca53"],
Cell[1275681, 29596, 420, 11, 53, "Message",ExpressionUUID->"29c22403-b8b1-4afe-a30a-caa2b6991a8d"],
Cell[1276104, 29609, 442, 11, 35, "Message",ExpressionUUID->"cb8cf4c8-ea82-449d-9292-a116b7717b53"],
Cell[1276549, 29622, 444, 11, 35, "Message",ExpressionUUID->"6bad14eb-eb70-4949-acef-54f813af5122"],
Cell[1276996, 29635, 420, 11, 53, "Message",ExpressionUUID->"5cf8674c-08bb-42e6-a8fa-952da3e8c392"],
Cell[1277419, 29648, 442, 11, 35, "Message",ExpressionUUID->"1231c3f5-ed19-420c-8047-3434a9bf50c2"],
Cell[1277864, 29661, 420, 11, 53, "Message",ExpressionUUID->"520e872c-e1dc-4067-bfda-e12fed194ebb"],
Cell[1278287, 29674, 420, 11, 53, "Message",ExpressionUUID->"f91f9cb0-1c8c-4f55-a3f7-04954e3b5a5a"],
Cell[1278710, 29687, 422, 11, 53, "Message",ExpressionUUID->"0ac5fdd2-e0ad-4bdd-8eaf-4aca16924167"],
Cell[1279135, 29700, 1410, 21, 33, "Output",ExpressionUUID->"602d0ad1-a92b-4909-8406-40233ec975ed"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

